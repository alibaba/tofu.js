{"version":3,"file":"index.js","sources":["../src/utils/Raf.js","../src/utils/Utils.js","../src/animation/Animate.js","../src/math/BezierEasing.js","../src/utils/Tween.js","../src/animation/Transition.js","../src/animation/PathMotion.js","../src/animation/AnimateRunner.js","../src/animation/TimelineAnimations.js","../src/patch/Object3D.js","../src/utils/Smooth.js","../src/utils/Orienter.js","../src/postprocessing/Pass.js","../src/shader/CopyShader.js","../src/shader/ConvolutionShader.js","../src/postprocessing/BloomPass.js","../src/postprocessing/ClearMaskPass.js","../src/shader/FilmShader.js","../src/postprocessing/FilmPass.js","../src/shader/DigitalGlitch.js","../src/postprocessing/GlitchPass.js","../src/postprocessing/MaskPass.js","../src/shader/MattingShader.js","../src/shader/EdgeBlur.js","../src/postprocessing/MattingPass.js","../src/postprocessing/RenderPass.js","../src/postprocessing/ShaderPass.js","../src/shader/FocusShader.js","../src/core/ARGlue.js","../src/core/EffectComposer.js","../node_modules/three.interaction/src/utils/Utils.js","../node_modules/three.interaction/src/patch/EventDispatcher.js","../node_modules/three.interaction/src/patch/Object3D.js","../node_modules/three.interaction/src/interaction/InteractionData.js","../node_modules/three.interaction/src/interaction/InteractionEvent.js","../node_modules/three.interaction/src/interaction/InteractionTrackingData.js","../node_modules/three.interaction/src/interaction/InteractionManager.js","../src/core/LayerCompositor.js","../src/core/ViewConfig.js","../src/core/EffectPack.js","../src/core/Viewer.js","../src/core/layer/Layer.js","../src/core/layer/ARLayer.js","../src/core/layer/XRLayer.js","../src/extras/primers/Primer.js","../src/shader/YUVShader.js","../src/shader/YCbCrShader.js","../src/extras/primers/CameraPrimer.js","../src/extras/primers/TexturePrimer.js","../src/extras/panorama/AnchorBase.js","../src/extras/panorama/AnchorRippling.js","../src/extras/panorama/SphereWorld.js","../src/extras/panorama/CylinderWorld.js","../src/utils/GLTFLoader.js","../src/extras/GltfMagic.js"],"sourcesContent":["(function() {\n  let lastTime = 0;\n  const vendors = [ 'ms', 'moz', 'webkit', 'o' ];\n  for (let x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n    window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\n    window.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame'] ||\n            window[vendors[x] + 'CancelRequestAnimationFrame'];\n  }\n\n  if (!window.requestAnimationFrame) {\n    window.requestAnimationFrame = function(callback) {\n      const currTime = new Date().getTime();\n      const timeToCall = Math.max(0, 16 - (currTime - lastTime));\n      const id = window.setTimeout(function() {\n        callback(currTime + timeToCall);\n      }, timeToCall);\n      lastTime = currTime + timeToCall;\n      return id;\n    };\n  }\n\n  if (!window.cancelAnimationFrame) {\n    window.cancelAnimationFrame = function(id) {\n      clearTimeout(id);\n    };\n  }\n\n  window.RAF = window.requestAnimationFrame;\n  window.CAF = window.cancelAnimationFrame;\n})();\n","/**\n * 返回数据类型\n * @param {*} val 需要判定的类型\n * @return {String} 数据类型\n */\nfunction _rt(val) {\n  return Object.prototype.toString.call(val);\n}\n\n/**\n * Utils 常用工具箱\n *\n * @namespace Utils\n */\nconst Utils = {\n  /**\n   * 简单拷贝纯数据的JSON对象\n   *\n   * @static\n   * @memberof Utils\n   * @param {JSON} json 待拷贝的纯数据JSON\n   * @return {JSON} 拷贝后的纯数据JSON\n   */\n  copyJSON(json) {\n    return JSON.parse(JSON.stringify(json));\n  },\n\n  /**\n   * 将角度转化成弧度\n   *\n   * @static\n   * @memberof Utils\n   * @param {Number} degree 角度数\n   * @return {Number} 弧度数\n   */\n  DTR(degree) {\n    return degree * Math.PI / 180;\n  },\n\n  /**\n   * 将弧度转化成角度\n   *\n   * @static\n   * @memberof Utils\n   * @param {Number} radius 弧度数\n   * @return {Number} 角度数\n   */\n  RTD(radius) {\n    return radius * 180 / Math.PI;\n  },\n\n  /**\n   * 判断变量是否为数组类型\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Array} variable 待判断的变量\n   * @return {Boolean} 判断的结果\n   */\n  isArray: (function() {\n    const ks = _rt([]);\n    return function(variable) {\n      return _rt(variable) === ks;\n    };\n  })(),\n\n  /**\n   * 判断变量是否为对象类型\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Object} variable 待判断的变量\n   * @return {Boolean} 判断的结果\n   */\n  isObject: (function() {\n    const ks = _rt({});\n    return function(variable) {\n      return _rt(variable) === ks;\n    };\n  })(),\n\n  /**\n   * 判断变量是否为字符串类型\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {String} variable 待判断的变量\n   * @return {Boolean} 判断的结果\n   */\n  isString: (function() {\n    const ks = _rt('s');\n    return function(variable) {\n      return _rt(variable) === ks;\n    };\n  })(),\n\n  /**\n   * 判断变量是否为数字类型\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Number} variable 待判断的变量\n   * @return {Boolean} 判断的结果\n   */\n  isNumber: (function() {\n    const ks = _rt(1);\n    return function(variable) {\n      return _rt(variable) === ks;\n    };\n  })(),\n\n  /**\n   * 判断变量是否为函数类型\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Function} variable 待判断的变量\n   * @return {Boolean} 判断的结果\n   */\n  isFunction: (function() {\n    const ks = _rt(function() {});\n    return function(variable) {\n      return _rt(variable) === ks;\n    };\n  })(),\n\n\n  /**\n   * 判断变量是否为undefined\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Function} variable 待判断的变量\n   * @return {Boolean} 判断的结果\n   */\n  isUndefined(variable) {\n    return typeof variable === 'undefined';\n  },\n\n  /**\n   * 判断变量是否为布尔型\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Function} variable 待判断的变量\n   * @return {Boolean} 判断的结果\n   */\n  isBoolean: (function() {\n    const ks = _rt(true);\n    return function(variable) {\n      return _rt(variable) === ks;\n    };\n  })(),\n\n  /**\n   * 强化的随机数，可以随机产生给定区间内的数字、随机输出数字内的项\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Array | Number} min 当只传入一个变量时变量应该为数字，否则为所给定区间较小的数字\n   * @param {Number} max 所给定区间较大的数字\n   * @return {ArrayItem | Number} 返回数组中大一项或者给定区间内的数字\n   */\n  random(min, max) {\n    if (this.isArray(min)) return min[~~(Math.random() * min.length)];\n    if (!this.isNumber(max)) {\n      max = min || 1;\n      min = 0;\n    }\n    return min + Math.random() * (max - min);\n  },\n\n  /**\n   * 阿基米德求模\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Number} n 当前值\n   * @param {Number} m 模\n   * @return {Number} 映射到模长内的值\n   */\n  euclideanModulo(n, m) {\n    return ((n % m) + m) % m;\n  },\n\n  /**\n   * 边界值域镜像\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Number} n 当前值\n   * @param {Number} min 值域下边界\n   * @param {Number} max 值域上边界\n   * @return {Number} 值域内反射到的值\n   */\n  codomainBounce(n, min, max) {\n    if (n < min) return 2 * min - n;\n    if (n > max) return 2 * max - n;\n    return n;\n  },\n\n  /**\n   * 数字区间闭合，避免超出区间\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Number} x 待闭合到值\n   * @param {Number} a 闭合区间左边界\n   * @param {Number} b 闭合区间右边界\n   * @return {Number} 闭合后的值\n   */\n  clamp(x, a, b) {\n    return (x < a) ? a : ((x > b) ? b : x);\n  },\n\n  /**\n   * 线性插值\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Number} x 输入的值\n   * @param {Number} min 输入值的下区间\n   * @param {Number} max 输入值的上区间\n   * @return {Number} 返回的值在区间[0,1]内\n   */\n  linear(x, min, max) {\n    if (x <= min) return 0;\n    if (x >= max) return 1;\n    x = (x - min) / (max - min);\n    return x;\n  },\n\n  /**\n   * 平滑插值\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Number} x 输入的值\n   * @param {Number} min 输入值的下区间\n   * @param {Number} max 输入值的上区间\n   * @return {Number} 返回的值在区间[0,1]内\n   */\n  smoothstep(x, min, max) {\n    if (x <= min) return 0;\n    if (x >= max) return 1;\n    x = (x - min) / (max - min);\n    return x * x * (3 - 2 * x);\n  },\n\n  /**\n   * 更平滑的插值\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Number} x 输入的值\n   * @param {Number} min 输入值的下区间\n   * @param {Number} max 输入值的上区间\n   * @return {Number} 返回的值在区间[0,1]内\n   */\n  smootherstep(x, min, max) {\n    if (x <= min) return 0;\n    if (x >= max) return 1;\n    x = (x - min) / (max - min);\n    return x * x * x * (x * (x * 6 - 15) + 10);\n  },\n};\n\nexport default Utils;\n","import { EventDispatcher } from 'three';\nimport Utils from '../utils/Utils';\n\n/**\n * an animate class, root class\n * @private\n */\nclass Animate extends EventDispatcher {\n  /**\n   * config your animation\n   * @param {Object} options animate config\n   * @private\n   */\n  constructor(options) {\n    super();\n    this.object = options.object || {};\n    this.duration = options.duration || 300;\n    this.living = true;\n    this.resident = options.resident || false;\n\n    this.infinite = options.infinite || false;\n    this.alternate = options.alternate || false;\n    this.repeats = options.repeats || 0;\n    this.delay = options.delay || 0;\n    this.wait = options.wait || 0;\n    this.timeScale = Utils.isNumber(options.timeScale) ?\n      options.timeScale :\n      1;\n\n    if (options.onComplete) {\n      this.on('complete', options.onComplete.bind(this));\n    }\n    if (options.onUpdate) {\n      this.on('update', options.onUpdate.bind(this));\n    }\n\n    this.init();\n\n    this.paused = false;\n  }\n\n  /**\n   * init animate state\n   * @private\n   */\n  init() {\n    this.direction = 1;\n    this.progress = 0;\n    this.repeatsCut = this.repeats;\n    this.delayCut = this.delay;\n    this.waitCut = this.wait;\n  }\n\n  /**\n   * update the timeline and get pose\n   *\n   * @private\n   * @param {Number} snippet time snippet\n   * @return {Object} pose state\n   */\n  update(snippet) {\n    const snippetCache = this.direction * this.timeScale * snippet;\n    if (this.waitCut > 0) {\n      this.waitCut -= Math.abs(snippetCache);\n      return;\n    }\n    if (this.paused || !this.living || this.delayCut > 0) {\n      if (this.delayCut > 0) this.delayCut -= Math.abs(snippetCache);\n      return;\n    }\n\n    this.progress += snippetCache;\n    let isEnd = false;\n    const progressCache = this.progress;\n\n    if (this.spill()) {\n      if (this.repeatsCut > 0 || this.infinite) {\n        if (this.repeatsCut > 0) --this.repeatsCut;\n        this.delayCut = this.delay;\n        if (this.alternate) {\n          this.direction *= -1;\n          this.progress = Utils.codomainBounce(this.progress, 0, this.duration);\n        } else {\n          this.direction = 1;\n          this.progress = Utils.euclideanModulo(this.progress, this.duration);\n        }\n      } else {\n        isEnd = true;\n      }\n    }\n\n    let pose;\n    if (!isEnd) {\n      pose = this.nextPose();\n      this.emit('update', pose, this.progress / this.duration);\n    } else {\n      if (!this.resident) this.living = false;\n      this.progress = Utils.clamp(progressCache, 0, this.duration);\n      pose = this.nextPose();\n      this.emit('complete', pose, Math.abs(progressCache - this.progress));\n    }\n    return pose;\n  }\n\n  /**\n   * check progress was spill\n   *\n   * @private\n   * @return {Boolean} whether spill or not\n   */\n  spill() {\n    const bSpill = this.progress <= 0 && this.direction === -1;\n    const tSpill = this.progress >= this.duration && this.direction === 1;\n    return bSpill || tSpill;\n  }\n\n  /**\n   * get next pose, should be overwrite by sub-class\n   * @private\n   */\n  nextPose() {\n    console.warn('should be overwrite');\n  }\n\n  /**\n   * linear interpolation\n   * @private\n   * @param {number} p0 start value\n   * @param {number} p1 end value\n   * @param {number} t  time rate\n   * @return {Number} interpolation value\n   */\n  linear(p0, p1, t) {\n    return (p1 - p0) * t + p0;\n  }\n\n  /**\n   * pause this animate\n   */\n  pause() {\n    this.paused = true;\n  }\n\n  /**\n   * restore this animate play\n   */\n  restart() {\n    this.paused = false;\n  }\n\n  /**\n   * stop this animate at last frame, will trigger `complete` event\n   */\n  stop() {\n    this.repeats = 0;\n    this.infinite = false;\n    this.progress = this.duration;\n  }\n\n  /**\n   * set this queue's timeScale\n   * @param {Number} speed set timescale\n   */\n  setSpeed(speed) {\n    this.timeScale = speed;\n  }\n\n  /**\n   * cancle this animate, will not trigger `complete` event\n   */\n  cancle() {\n    this.living = false;\n  }\n}\n\nexport default Animate;\n","/**\n * https://github.com/gre/bezier-easing\n * BezierEasing - use bezier curve for transition easing function\n * by Gaëtan Renaudeau 2014 - 2015 – MIT License\n */\n\nconst NEWTON_ITERATIONS = 4;\nconst NEWTON_MIN_SLOPE = 0.001;\nconst SUBDIVISION_PRECISION = 0.0000001;\nconst SUBDIVISION_MAX_ITERATIONS = 10;\n\n\nconst kSplineTableSize = 11;\nconst kSampleStepSize = 1.0 / (kSplineTableSize - 1.0);\n\nconst float32ArraySupported = typeof Float32Array === 'function';\n\n/* eslint new-cap: 0 */\n\n/**\n * 公因式A\n *\n * @param {number} aA1 控制分量\n * @param {number} aA2 控制分量\n * @return {number} 整个公式中的A公因式的值\n */\nfunction A(aA1, aA2) {\n  return 1.0 - 3.0 * aA2 + 3.0 * aA1;\n}\n\n/**\n * 公因式B\n *\n * @param {number} aA1 控制分量1\n * @param {number} aA2 控制分量2\n * @return {number} 整个公式中的B公因式的值\n */\nfunction B(aA1, aA2) {\n  return 3.0 * aA2 - 6.0 * aA1;\n}\n\n/**\n * 公因式C\n *\n * @param {number} aA1 控制分量1\n * @param {number} aA2 控制分量2\n * @return {number} 整个公式中的C公因式的值\n */\nfunction C(aA1) {\n  return 3.0 * aA1;\n}\n\n/**\n * 获取aT处的值\n *\n * @param {number} aT 三次贝塞尔曲线的t自变量\n * @param {number} aA1 控制分量1\n * @param {number} aA2 控制分量2\n * @return {number} 三次贝塞尔公式的因变量\n */\nfunction calcBezier(aT, aA1, aA2) {\n  return ((A(aA1, aA2) * aT + B(aA1, aA2)) * aT + C(aA1)) * aT;\n}\n\n/**\n * 获取aT处的斜率\n * @param {number} aT 三次贝塞尔曲线的t自变量\n * @param {number} aA1 控制分量1\n * @param {number} aA2 控制分量2\n * @return {number} 三次贝塞尔公式的导数\n */\nfunction getSlope(aT, aA1, aA2) {\n  return 3.0 * A(aA1, aA2) * aT * aT + 2.0 * B(aA1, aA2) * aT + C(aA1);\n}\n\n/**\n *\n * @param {number} aX x\n * @param {number} aA a\n * @param {number} aB b\n * @param {number} mX1 min x\n * @param {number} mX2 max x\n * @return {number} 二分法猜测t的值\n */\nfunction binarySubdivide(aX, aA, aB, mX1, mX2) {\n  let currentX;\n  let currentT;\n  let i = 0;\n  do {\n    currentT = aA + (aB - aA) / 2.0;\n    currentX = calcBezier(currentT, mX1, mX2) - aX;\n    if (currentX > 0.0) {\n      aB = currentT;\n    } else {\n      aA = currentT;\n    }\n  } while (\n    Math.abs(currentX) > SUBDIVISION_PRECISION\n    &&\n    ++i < SUBDIVISION_MAX_ITERATIONS\n  );\n  return currentT;\n}\n\n/**\n * 牛顿迭代算法，进一步的获取精确的T值\n * @param {number} aX x\n * @param {number} aGuessT guess t\n * @param {number} mX1 min x\n * @param {number} mX2 max x\n * @return {number} 获取更精确的T值\n */\nfunction newtonRaphsonIterate(aX, aGuessT, mX1, mX2) {\n  for (let i = 0; i < NEWTON_ITERATIONS; ++i) {\n    const currentSlope = getSlope(aGuessT, mX1, mX2);\n    if (currentSlope === 0.0) {\n      return aGuessT;\n    }\n    const currentX = calcBezier(aGuessT, mX1, mX2) - aX;\n    aGuessT -= currentX / currentSlope;\n  }\n  return aGuessT;\n}\n\n/**\n * cubic-bezier曲线的两个控制点，默认起始点为 0，结束点为 1\n *\n * @class\n * @param {number} mX1 控制点1的x分量\n * @param {number} mY1 控制点1的y分量\n * @param {number} mX2 控制点2的x分量\n * @param {number} mY2 控制点2的y分量\n */\nfunction BezierEasing(mX1, mY1, mX2, mY2) {\n  if (!(mX1 >= 0 && mX1 <= 1 && mX2 >= 0 && mX2 <= 1)) {\n    throw new Error('bezier x values must be in [0, 1] range');\n  }\n  this.mX1 = mX1;\n  this.mY1 = mY1;\n  this.mX2 = mX2;\n  this.mY2 = mY2;\n  this.sampleValues = float32ArraySupported ?\n    new Float32Array(kSplineTableSize) :\n    new Array(kSplineTableSize);\n\n  this._preCompute();\n}\n\nBezierEasing.prototype._preCompute = function() {\n  // Precompute samples table\n  if (this.mX1 !== this.mY1 || this.mX2 !== this.mY2) {\n    for (let i = 0; i < kSplineTableSize; ++i) {\n      this.sampleValues[i] = calcBezier(\n        i * kSampleStepSize,\n        this.mX1,\n        this.mX2\n      );\n    }\n  }\n};\n\nBezierEasing.prototype._getTForX = function(aX) {\n  let intervalStart = 0.0;\n  let currentSample = 1;\n  const lastSample = kSplineTableSize - 1;\n\n  for (\n    ;\n    currentSample !== lastSample && this.sampleValues[currentSample] <= aX;\n    ++currentSample\n  ) {\n    intervalStart += kSampleStepSize;\n  }\n  --currentSample;\n\n  // Interpolate to provide an initial guess for t\n  const dist = (aX - this.sampleValues[currentSample]) /\n  (this.sampleValues[currentSample + 1] - this.sampleValues[currentSample]);\n  const guessForT = intervalStart + dist * kSampleStepSize;\n\n  const initialSlope = getSlope(guessForT, this.mX1, this.mX2);\n  if (initialSlope >= NEWTON_MIN_SLOPE) {\n    return newtonRaphsonIterate(aX, guessForT, this.mX1, this.mX2);\n  } else if (initialSlope === 0.0) {\n    return guessForT;\n  }\n  return binarySubdivide(\n    aX,\n    intervalStart,\n    intervalStart + kSampleStepSize,\n    this.mX1,\n    this.mX2\n  );\n};\n\n/**\n * 通过x轴近似获取y的值\n *\n * @param {number} x x轴的偏移量\n * @return {number} 与输入值x对应的y值\n */\nBezierEasing.prototype.get = function(x) {\n  if (this.mX1 === this.mY1 && this.mX2 === this.mY2) return x;\n  if (x === 0) {\n    return 0;\n  }\n  if (x === 1) {\n    return 1;\n  }\n  return calcBezier(this._getTForX(x), this.mY1, this.mY2);\n};\n\nexport { BezierEasing };\n\n","import { BezierEasing } from '../math/BezierEasing';\n/* eslint no-cond-assign: \"off\" */\n/* eslint new-cap: 0 */\n/* eslint max-len: 0 */\n\n\n/**\n * Tween 缓动时间运动函数集合\n *\n * ```js\n * dispay.animate({\n *   from: {x: 100},\n *   to: {x: 200},\n *   ease: JC.Tween.Ease.In, // 配置要调用的运动函数\n * })\n * ```\n * @namespace Tween\n */\n\nconst Tween = {\n\n  Linear: {\n\n    None(k) {\n      return k;\n    },\n\n  },\n\n  Ease: {\n\n    In: (function() {\n      const bezier = new BezierEasing(0.42, 0, 1, 1);\n      return function(k) {\n        return bezier.get(k);\n      };\n    })(),\n\n    Out: (function() {\n      const bezier = new BezierEasing(0, 0, 0.58, 1);\n      return function(k) {\n        return bezier.get(k);\n      };\n    })(),\n\n    InOut: (function() {\n      const bezier = new BezierEasing(0.42, 0, 0.58, 1);\n      return function(k) {\n        return bezier.get(k);\n      };\n    })(),\n\n    Bezier(x1, y1, x2, y2) {\n      const bezier = new BezierEasing(x1, y1, x2, y2);\n      return function(k) {\n        return bezier.get(k);\n      };\n    },\n\n  },\n\n  Elastic: {\n\n    In(k) {\n      if (k === 0) {\n        return 0;\n      }\n      if (k === 1) {\n        return 1;\n      }\n      return -Math.pow(2, 10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI);\n    },\n\n    Out(k) {\n      if (k === 0) {\n        return 0;\n      }\n      if (k === 1) {\n        return 1;\n      }\n      return Math.pow(2, -10 * k) * Math.sin((k - 0.1) * 5 * Math.PI) + 1;\n    },\n\n    InOut(k) {\n      if (k === 0) {\n        return 0;\n      }\n      if (k === 1) {\n        return 1;\n      }\n      k *= 2;\n      if (k < 1) {\n        return -0.5 * Math.pow(2, 10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI);\n      }\n      return 0.5 * Math.pow(2, -10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI) + 1;\n    },\n\n  },\n\n  Back: {\n\n    In(k) {\n      const s = 1.70158;\n      return k * k * ((s + 1) * k - s);\n    },\n\n    Out(k) {\n      const s = 1.70158;\n      return --k * k * ((s + 1) * k + s) + 1;\n    },\n\n    InOut(k) {\n      const s = 1.70158 * 1.525;\n      if ((k *= 2) < 1) {\n        return 0.5 * (k * k * ((s + 1) * k - s));\n      }\n      return 0.5 * ((k -= 2) * k * ((s + 1) * k + s) + 2);\n    },\n\n  },\n\n  Bounce: {\n\n    In(k) {\n      return 1 - Tween.Bounce.Out(1 - k);\n    },\n\n    Out(k) {\n      if (k < (1 / 2.75)) {\n        return 7.5625 * k * k;\n      } else if (k < (2 / 2.75)) {\n        return 7.5625 * (k -= (1.5 / 2.75)) * k + 0.75;\n      } else if (k < (2.5 / 2.75)) {\n        return 7.5625 * (k -= (2.25 / 2.75)) * k + 0.9375;\n      }\n      return 7.5625 * (k -= (2.625 / 2.75)) * k + 0.984375;\n\n    },\n\n    InOut(k) {\n      if (k < 0.5) {\n        return Tween.Bounce.In(k * 2) * 0.5;\n      }\n      return Tween.Bounce.Out(k * 2 - 1) * 0.5 + 0.5;\n    },\n  },\n};\n\nexport default Tween;\n","import Animate from './Animate';\nimport Tween from '../utils/Tween';\nimport Utils from '../utils/Utils';\n\n/* eslint guard-for-in: \"off\" */\n\n/**\n * transition class\n * @private\n */\nclass Transition extends Animate {\n  constructor(options) {\n    super(options);\n\n    // collect from pose, when from was not complete\n    options.from = options.from || {};\n    for (const i in options.to) {\n      if (Utils.isUndefined(options.from[i])) options.from[i] = this.object.props(i);\n    }\n\n    /**\n     * timing function\n     */\n    this.ease = options.ease || Tween.Ease.InOut;\n\n    /**\n     * from pose\n     */\n    this.from = options.from;\n\n    /**\n     * to pose\n     */\n    this.to = options.to;\n  }\n\n  /**\n   * calculate next frame pose\n   * @private\n   * @return {object} pose state\n   */\n  nextPose() {\n    const pose = {};\n    const t = this.ease(this.progress / this.duration);\n    for (const i in this.to) {\n      pose[i] = this.linear(this.from[i], this.to[i], t);\n      this.object.props(i, pose[i]);\n    }\n    return pose;\n  }\n}\n\nexport default Transition;\n","import { Curve } from 'three';\nimport Animate from './Animate';\nimport Utils from '../utils/Utils';\nimport Tween from '../utils/Tween';\n\n/**\n * PathMotion class\n * @private\n */\nclass PathMotion extends Animate {\n  constructor(options) {\n    super(options);\n    if (!options.path || !(options.path instanceof Curve)) {\n      console.warn('path is not instanceof Curve');\n    }\n\n    /**\n     * path, extend curve\n     */\n    this.path = options.path;\n\n    /**\n     * timing function\n     */\n    this.ease = options.ease || Tween.Ease.InOut;\n\n    /**\n     * use lengthMode or not\n     */\n    this.lengthMode = Utils.isBoolean(options.lengthMode) ?\n      options.lengthMode :\n      false;\n\n    /**\n     * progress need clamp with [0, 1]\n     */\n    this.needClamp = Utils.isBoolean(options.needClamp) ?\n      options.needClamp :\n      true;\n\n    /**\n     * object need attach tangent\n     */\n    this.attachTangent = Utils.isBoolean(options.attachTangent) ?\n      options.attachTangent :\n      false;\n  }\n\n  /**\n   * caculation next pose\n   * @return {Vector3} position\n   */\n  nextPose() {\n    let t = this.ease(this.progress / this.duration);\n    if (this.needClamp) {\n      t = Utils.clamp(t, 0, 1);\n    }\n    const position = this.lengthMode ?\n      this.path.getPointAt(t) :\n      this.path.getPoint(t);\n\n    this.object.position.copy(position);\n    if (this.attachTangent) {\n      const direction = this.lengthMode ?\n        this.path.getTangentAt(t) :\n        this.path.getTangent(t);\n      this.object.lookAt(position.add(direction));\n    }\n    return position;\n  }\n}\n\nexport default PathMotion;\n","import Animate from './Animate';\nimport Transition from './Transition';\n// import Utils from '../utils/Utils';\nimport PathMotion from './PathMotion';\n\n/**\n * AnimateRunner, composer any animation type\n *\n * @private\n */\nclass AnimateRunner extends Animate {\n  /**\n   * config a runner animation\n   * @param {object} [options] runners config\n   */\n  constructor(options) {\n    super(options);\n    this.runners = options.runners;\n    this.cursor = 0;\n    this.queues = [];\n    this.alternate = false;\n\n    this.length = this.runners.length;\n\n    // TODO: Is it necessary to exist ?\n    // this.propsMap = [];\n    // this.prepare();\n  }\n\n  // prepare() {\n  //   let i = 0;\n  //   let j = 0;\n  //   for (i = 0; i < this.runners.length; i++) {\n  //     const runner = this.runners[i];\n  //     if (Utils.isUndefined(runner.to)) continue;\n  //     const keys = Object.keys(runner.to);\n  //     for (j = 0; j < keys.length; j++) {\n  //       const prop = keys[j];\n  //       if (this.propsMap.indexOf(prop) === -1) this.propsMap.push(prop);\n  //     }\n  //   }\n  //   for (i = 0; i < this.runners.length; i++) {\n  //     const runner = this.runners[i];\n  //     if (!runner.to) continue;\n  //     for (j = 0; j < this.propsMap.length; j++) {\n  //       const prop = this.propsMap[j];\n  //       if (Utils.isUndefined(runner.to[prop])) runner.to[prop] = this.object.props(prop);\n  //     }\n  //   }\n  // }\n\n  /**\n   * init a runner\n   * @private\n   */\n  initRunner() {\n    const runner = this.runners[this.cursor];\n    runner.infinite = false;\n    runner.resident = true;\n    runner.object = this.object;\n\n    let animate = null;\n    if (runner.path) {\n      animate = new PathMotion(runner);\n    } else if (runner.to) {\n      animate = new Transition(runner);\n    }\n    if (animate !== null) {\n      animate.on('complete', this.nextRunner.bind(this));\n      this.queues.push(animate);\n    }\n  }\n\n  /**\n   * step to next `runner`\n   * @param {Object} _ is hold for pose\n   * @param {Number} time time snippet\n   * @private\n   */\n  nextRunner(_, time) {\n    this.queues[this.cursor].init();\n    this.cursor += this.direction;\n    this.timeSnippet = time;\n  }\n\n  /**\n   * get next pose\n   * @param {Number} snippetCache time snippet\n   * @return {Object} pose\n   */\n  nextPose(snippetCache) {\n    if (!this.queues[this.cursor] && this.runners[this.cursor]) {\n      this.initRunner();\n    }\n    if (this.timeSnippet >= 0) {\n      snippetCache += this.timeSnippet;\n      this.timeSnippet = 0;\n    }\n    return this.queues[this.cursor].update(snippetCache);\n  }\n\n  /**\n   * update state\n   * @param {Number} snippet time snippet\n   * @return {Object} pose\n   */\n  update(snippet) {\n    if (this.wait > 0) {\n      this.wait -= Math.abs(snippet);\n      return;\n    }\n    if (this.paused || !this.living || this.delayCut > 0) {\n      if (this.delayCut > 0) this.delayCut -= Math.abs(snippet);\n      return;\n    }\n\n    const cc = this.cursor;\n\n    const pose = this.nextPose(this.direction * this.timeScale * snippet);\n\n    this.emit('update', {\n      index: cc,\n      pose,\n    }, this.progress / this.duration);\n\n    if (this.spill()) {\n      if (this.repeats > 0 || this.infinite) {\n        if (this.repeats > 0) --this.repeats;\n        this.delayCut = this.delay;\n        this.direction = 1;\n        this.cursor = 0;\n      } else {\n        if (!this.resident) this.living = false;\n        this.emit('complete', pose);\n      }\n    }\n    return pose;\n  }\n\n  /**\n   * check progress is spill?\n   * @return {Boolean} is spill\n   */\n  spill() {\n    // TODO: 这里应该保留溢出，不然会导致时间轴上的误差\n    const topSpill = this.cursor >= this.length;\n    return topSpill;\n  }\n}\n\nexport default AnimateRunner;\n","import Transition from './Transition';\nimport AnimateRunner from './AnimateRunner';\nimport PathMotion from './PathMotion';\n\n/**\n * timeline animations class\n * @private\n */\nclass TimelineAnimations {\n  constructor(object) {\n    /**\n     * display object cache it for use after\n     */\n    this.object = object;\n\n    /**\n     * object's all animates queue\n     *\n     * @member {Array}\n     */\n    this.animates = [];\n\n    /**\n     * object's timeline update time-scale\n     *\n     * @member {Number}\n     */\n    this.timeScale = 1;\n\n    /**\n     * pause the object's timeline update\n     *\n     * @member {Boolean}\n     */\n    this.paused = false;\n  }\n\n  /**\n   * update this object animates queue\n   * @param {Number} snippet time snippet\n   */\n  update(snippet) {\n    if (this.paused) return;\n    snippet = this.timeScale * snippet;\n    const cache = this.animates.slice(0);\n    for (let i = 0; i < cache.length; i++) {\n      if (!cache[i].living && !cache[i].resident) {\n        this.animates.splice(i, 1);\n      }\n      cache[i].update(snippet);\n    }\n  }\n\n  /**\n   * create a `animate` animation\n   *\n   * @private\n   * @param {object} options config for animate\n   * @param {boolean} clear whether clear all animation at before\n   * @return {Transition} transition animator\n   */\n  animate(options, clear) {\n    options.object = this.object;\n    return this._addMove(new Transition(options), clear);\n  }\n\n  /**\n   * create a `motion` animation\n   *\n   * @private\n   * @param {object} options config for motion\n   * @param {boolean} clear whether clear all animation at before\n   * @return {PathMotion} pathMotion animator\n   */\n  motion(options, clear) {\n    options.object = this.object;\n    return this._addMove(new PathMotion(options), clear);\n  }\n\n  /**\n   * create a `runners` animation\n   * @private\n   * @param {object} options config for motion\n   * @param {boolean} clear whether clear all animation at before\n   * @return {AnimateRunner} animateRunner animator\n   */\n  runners(options, clear) {\n    options.object = this.object;\n    return this._addMove(new AnimateRunner(options), clear);\n  }\n\n  /**\n   * create a `keyFrames` animation\n   * @private\n   * @param {object} options config for motion\n   * @param {boolean} clear whether clear all animation at before\n   * @return {KeyFrames} keyFrames animator\n   */\n  // keyFrames(options, clear) {\n  //   options.object = this.object;\n  //   return this._addMove(new KeyFrames(options), clear);\n  // }\n\n  /**\n   * add animator into animates queue\n   * @private\n   * @param {object} animate animator\n   * @param {boolean} clear whether clear all animation at before\n   * @return {Transition} animator\n   */\n  _addMove(animate, clear) {\n    if (clear) this.clear();\n    this.animates.push(animate);\n    return animate;\n  }\n\n  /**\n   * pause animates\n   */\n  pause() {\n    this.paused = true;\n  }\n\n  /**\n   * restore animates play\n   */\n  restart() {\n    this.paused = false;\n  }\n\n  /**\n   * set this queue's timeScale\n   * @param {Number} speed set timescale\n   */\n  setSpeed(speed) {\n    this.timeScale = speed;\n  }\n\n  /**\n   * clear all animates\n   * @private\n   */\n  clear() {\n    this.animates.length = 0;\n  }\n}\n\nexport { TimelineAnimations };\n","import { Object3D } from 'three';\nimport { TimelineAnimations } from '../animation/TimelineAnimations';\nimport Utils from '../utils/Utils';\n\n/**\n * timeline scale, effect this display-node and it's children\n */\nObject3D.prototype.timeScale = 1;\n\n/**\n * whether pause the timeline update with this display-node and it's children\n */\nObject3D.prototype.paused = false;\n\n/**\n * scale display-object with xyz together\n *\n */\nObject.defineProperty(Object3D.prototype, 'scaleXYZ', {\n  get() {\n    return this.scale.x;\n  },\n  set(scale) {\n    this.scale.x = this.scale.y = this.scale.z = scale;\n  },\n});\n\n/**\n * animate animation, let a display-object move from a pose to another pose\n *\n * ```js\n * model.animate({\n *   from: { 'position.x': 100 },\n *   to: { 'position.x': 200 },\n *   ease: Tween.Bounce.Out, // use which timing-function default: `Tween.Ease.InOut`\n *   repeats: 10, // repeat 10 times, after compelete this animation loop\n *   infinite: true, // infinite repeat forevery\n *   alternate: true, // repeat with alternate, just like yoyo\n *   duration: 1000, // animation duration 1000ms\n *   wait: 100, // animation await sometime\n *   onUpdate: function(state,rate){}, // will be invoked when update pose\n *   onComplete: function(){ console.log('end'); } // will be invoked when update last pose (complete)\n * });\n * ```\n *\n * @param {Object} options animate animation config\n * @param {Object} [options.from] which pose state this animate start with\n * @param {Object} options.to which pose state this animate to\n * @param {Tween} [options.ease=Tween.Ease.InOut] use which timing-function\n * @param {Number} [options.repeats=0] whether animate repeat some times, it's weight lower than `options.infinite`\n * @param {Number} [options.duration=300] animate duration\n * @param {Number} [options.wait=0] animate wait time before first start, not effect next repeat\n * @param {Number} [options.delay=0] animate delay time before start or restart, effect at repeat if it have\n * @param {Boolean} [options.infinite=false] whether animate infinite repeat, it's weight higher than `options.repeats`\n * @param {Boolean} [options.alternate=false] whether animate paly with alternate, just like yoyo\n * @param {Function} [options.onUpdate] will be invoked when update pose\n * @param {Function} [options.onComplete] will be invoked when update last pose (complete)\n * @param {Boolean} clear whether clear display-object's animation queue\n * @return {Animate} animate object\n */\nObject3D.prototype.animate = function(options, clear) {\n  if (!this.timelineAnimations) this.initTimeline();\n  return this.timelineAnimations.animate(options, clear);\n};\n\n/**\n * combine animation, let a display-object do animate one by one\n *\n * ```js\n * display.runners({\n *   runners: [\n *     { from: {}, to: {} },\n *     { path: JC.BezierCurve([ point1, point2, point3, point4 ]) },\n *   ],\n *   repeats: 10, // repeat 10 times, after compelete this animation loop\n *   infinite: true, // infinite repeat forevery\n *   alternate: true, // repeat with alternate, just like yoyo\n *   duration: 1000, // animation duration 1000ms\n *   onUpdate: function(state,rate){}, // will be invoked when update pose\n *   onComplete: function(){ console.log('end'); } // will be invoked when update last pose (complete)\n * });\n * ```\n *\n * @param {Object} options combine animation config\n * @param {Array} options.runners combine animation, support `animate`、`motion`\n * @param {Number} [options.repeats=0] whether animate repeat some times, it's weight lower than `options.infinite`\n * @param {Number} [options.duration=300] animate duration\n * @param {Number} [options.wait=0] animate wait time before first start, not effect next repeat\n * @param {Number} [options.delay=0] animate delay time before start or restart, effect at repeat if it have\n * @param {Boolean} [options.infinite=false] whether animate infinite repeat, it's weight higher than `options.repeats`\n * @param {Boolean} [options.alternate=false] whether animate paly with alternate, just like yoyo\n * @param {Function} [options.onUpdate] will be invoked when update pose\n * @param {Function} [options.onComplete] will be invoked when update last pose (complete)\n * @param {Boolean} clear whether clear display-object's animation queue\n * @return {Animate} Animate\n */\nObject3D.prototype.runners = function(options, clear) {\n  if (!this.timelineAnimations) this.initTimeline();\n  return this.timelineAnimations.runners(options, clear);\n};\n\n/**\n * motion animation, let a display-object move along with the path\n *\n * ```js\n * display.motion({\n *   path: new SvgCurve('M10 10 H 90 V 90 H 10 L 10 10), // path, should instance of Curve\n *   attachTangent: true, // whether display-object should attach tangent or not\n *   ease: Tween.Bounce.Out, // use which timing-function default: `Tween.Ease.InOut`\n *   repeats: 10, // repeat 10 times, after compelete this animation loop\n *   infinite: true, // infinite repeat forevery\n *   alternate: true, // repeat with alternate, just like yoyo\n *   duration: 1000, // animation duration 1000ms\n *   wait: 100, // animation await sometime\n *   onUpdate: function(state,rate){}, // will be invoked when update pose\n *   onComplete: function(){ console.log('end'); } // will be invoked when update last pose (complete)\n * });\n * ```\n * @param {Object} options motion animation config\n * @param {Curve} options.path path, should instance of Curve\n * @param {Boolean} [options.attachTangent=false] whether display-object should attach tangent or not\n * @param {Boolean} [options.lengthMode=false] whether move with length-mode or not\n * @param {Tween} [options.ease=Tween.Ease.InOut] use which timing-function\n * @param {Number} [options.repeats=0] whether animate repeat some times, it's weight lower than `options.infinite`\n * @param {Number} [options.duration=300] animate duration\n * @param {Number} [options.wait=0] animate wait time before first start, not effect next repeat\n * @param {Number} [options.delay=0] animate delay time before start or restart, effect at repeat if it have\n * @param {Boolean} [options.infinite=false] whether animate infinite repeat, it's weight higher than `options.repeats`\n * @param {Boolean} [options.alternate=false] whether animate paly with alternate, just like yoyo\n * @param {Function} [options.onUpdate] will be invoked when update pose\n * @param {Function} [options.onComplete] will be invoked when update last pose (complete)\n * @param {Boolean} clear whether clear display-object's animation queue\n * @return {Animate} Animate\n */\nObject3D.prototype.motion = function(options, clear) {\n  if (!this.timelineAnimations) this.initTimeline();\n  return this.timelineAnimations.motion(options, clear);\n};\n\n/**\n * initial timeline when it was not created\n *\n * @private\n */\nObject3D.prototype.initTimeline = function() {\n  this.timelineAnimations = new TimelineAnimations(this);\n};\n\n/**\n * update display-object animation\n *\n * @private\n * @param {Number} snippet time snippet\n */\nObject3D.prototype.updateAnimations = function(snippet) {\n  if (!this.timelineAnimations) return;\n  this.timelineAnimations.update(snippet);\n};\n\n/**\n * update display-object timeline\n *\n * @param {Number} snippet time snippet\n */\nObject3D.prototype.updateTimeline = function(snippet) {\n  if (this.paused) return;\n  snippet = this.timeScale * snippet;\n\n  this.emit('pretimeline', {\n    snippet,\n  });\n\n  this.updateAnimations(snippet);\n\n  let i = 0;\n  const children = this.children;\n  const length = children.length;\n  while (i < length) {\n    children[i].updateTimeline(snippet);\n    i++;\n  }\n\n  this.emit('posttimeline', {\n    snippet,\n  });\n};\n\n/**\n * get depth property from this object\n *\n * @private\n * @param {String} key property chain\n * @param {Number} value want set which value\n * @return {Number} return number\n */\nObject3D.prototype.props = function(key, value) {\n  if (!key) return;\n\n  const rawKeys = key.split('.');\n\n  if (rawKeys.length === 0) {\n    if (Utils.isUndefined(value)) {\n      return this[key];\n    }\n    this[key] = value;\n    return value;\n  }\n\n  const prop = rawKeys.pop();\n  const head = rawKeys.join('.');\n\n  if (!this.keysMaps || !this.keysMaps[head]) {\n    this.linkProp(head, rawKeys);\n  }\n\n  if (Utils.isUndefined(value)) {\n    return this.keysMaps[head][prop];\n  }\n  this.keysMaps[head][prop] = value;\n  return value;\n};\n\nObject3D.prototype.linkProp = function(head, rawKeys) {\n  if (!this.keysMaps) this.keysMaps = {};\n  let prop = this;\n  for (let i = 0; i < rawKeys.length; i++) {\n    const key = rawKeys[i];\n    prop = prop[key];\n  }\n  this.keysMaps[head] = prop;\n};\n\n","import { Vector3 } from 'three';\n\nexport default class Smooth {\n  constructor(object, options) {\n    options = options || {};\n    this.object = object;\n    this.to = new Vector3().copy(object);\n    this.now = this.to.clone();\n    this.speed = options.speed || 0.02;\n    this.noise = options.noise || 0.000001;\n  }\n  goto(x, y, z) {\n    this.to.set(x, y, z);\n  }\n  update() {\n    const space = this.to.clone().sub(this.now).multiplyScalar(this.speed);\n    if (space.length() < this.noise) return;\n    this.now.add(space);\n    this.object.x = this.now.x;\n    this.object.y = this.now.y;\n    this.object.z = this.now.z;\n  }\n}\n","import { EventDispatcher, Quaternion, Vector3, Euler } from 'three';\nimport Utils from './Utils';\n\nconst zee = new Vector3(0, 0, 1);\n\nconst euler = new Euler();\n\nconst q0 = new Quaternion();\n\nconst q1 = new Quaternion(-Math.sqrt(0.5), 0, 0, Math.sqrt(0.5)); // - PI/2 around the x-axis\n\nconst ROTATE_ORDER = 'YXZ';\n\nclass Orienter extends EventDispatcher {\n  constructor(options) {\n    super();\n    options = options || {};\n\n    this._orient = this._orient.bind(this);\n    this._change = this._change.bind(this);\n\n    this.needFix = Utils.isBoolean(options.needFix) ? options.needFix : true;\n    this.fix = 0;\n    this.timing = 8;\n\n    this.alpha = 0;\n    this.beta = 0;\n    this.gamma = 0;\n    this.lon = 0;\n    this.lat = 0;\n    this.direction = 0;\n    this.quaternion = new Quaternion();\n\n    this.eared = false;\n    this.nodce = true;\n    this.connect();\n  }\n\n  connect() {\n    this._change();\n    if (this.eared) return;\n    this.eared = true;\n    window.addEventListener('deviceorientation', this._orient, false);\n    window.addEventListener('orientationchange', this._change, false);\n  }\n\n  disconnect() {\n    this.eared = false;\n    window.removeEventListener('deviceorientation', this._orient, false);\n    window.removeEventListener('orientationchange', this._change, false);\n  }\n\n  _orient(event) {\n    if (!Utils.isNumber(event.alpha) || !Utils.isNumber(event.beta) || !Utils.isNumber(event.gamma)) {\n      this.nodce = true;\n      return;\n    }\n    if (this.needFix) {\n      if (this.timing === 0) {\n        this.needFix = false;\n        this.fix = event.alpha;\n      }\n      this.timing--;\n    } else {\n      this.alpha = Utils.euclideanModulo(event.alpha - this.fix, 360);\n    }\n    this.nodce = false;\n\n    this.beta = event.beta;\n    this.gamma = event.gamma;\n\n    this.update();\n\n    this.emit('deviceorientation', {\n      alpha: this.alpha,\n      beta: this.beta,\n      gamma: this.gamma,\n      lon: this.lon,\n      lat: this.lat,\n      quaternion: this.quaternion,\n    });\n  }\n\n  update() {\n    if (!this.eared || this.nodce) return;\n    const alpha = Utils.DTR(this.alpha);\n    const beta = Utils.DTR(this.beta);\n    const gamma = Utils.DTR(this.gamma);\n    euler.set(beta, alpha, -gamma, ROTATE_ORDER); // 'ZXY' for the device, but 'YXZ' for us\n\n    this.quaternion.setFromEuler(euler); // orient the device\n    this.quaternion.multiply(q1); // camera looks out the back of the device, not the top\n    this.quaternion.multiply(q0.setFromAxisAngle(zee, -this.direction)); // adjust for screen orientation\n\n    this.calculation();\n  }\n\n  calculation() {\n    this.lon = Utils.euclideanModulo(this.alpha + this.gamma, 360);\n\n    const face = new Vector3(0, 0, -1);\n    face.applyQuaternion(this.quaternion);\n    const xzFace = new Vector3(face.x, 0, face.z);\n    const cos = Utils.clamp(xzFace.dot(face), -1, 1);\n    const nor = face.y >= 0 ? 1 : -1;\n    const degree = Utils.RTD(Math.acos(cos));\n    this.lat = this.beta < 0 ? nor * (180 - degree) : nor * degree;\n  }\n\n  _change() {\n    this.direction = window.orientation || 0;\n    this.update();\n  }\n}\n\nexport default Orienter;\n","/* eslint no-unused-vars: 0 */\n\nexport default class Pass {\n  constructor() {\n    // if set to true, the pass is processed by the composer\n    this.enabled = true;\n\n    // if set to true, the pass indicates to swap read and write buffer after rendering\n    this.needsSwap = true;\n\n    // if set to true, the pass clears its buffer before rendering\n    this.clear = false;\n\n    // if set to true, the result of the pass is rendered to screen\n    this.renderToScreen = false;\n  }\n\n  setSize(width, height) {}\n\n  render(renderer, writeBuffer, readBuffer, delta) {\n    console.error('Pass: .render() must be implemented in derived pass.');\n  }\n}\n","/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Full-screen textured quad shader\n * @private\n */\n\nconst CopyShader = {\n\n  uniforms: {\n\n    tDiffuse: { value: null },\n    opacity: { value: 1.0 },\n\n  },\n\n  vertexShader: `\n  varying vec2 vUv;\n  void main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  }`,\n\n  fragmentShader: `\n  uniform float opacity;\n  uniform sampler2D tDiffuse;\n  varying vec2 vUv;\n  void main() {\n    vec4 texel = texture2D( tDiffuse, vUv );\n    gl_FragColor = opacity * texel;\n  }`,\n\n};\n\nexport default CopyShader;\n","import { Vector2 } from 'three';\n/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Convolution shader\n * ported from o3d sample to WebGL / GLSL\n * http://o3d.googlecode.com/svn/trunk/samples/convolution.html\n * @private\n */\nconst ConvolutionShader = {\n\n  defines: {\n\n    KERNEL_SIZE_FLOAT: '25.0',\n    KERNEL_SIZE_INT: '25',\n\n  },\n\n  uniforms: {\n\n    tDiffuse: { value: null },\n    uImageIncrement: { value: new Vector2(0.001953125, 0.0) },\n    cKernel: { value: [] },\n\n  },\n\n  vertexShader: `\n  uniform vec2 uImageIncrement;\n  varying vec2 vUv;\n  void main() {\n    vUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  }`,\n\n  fragmentShader: `\n  uniform float cKernel[ KERNEL_SIZE_INT ];\n  uniform sampler2D tDiffuse;\n  uniform vec2 uImageIncrement;\n  varying vec2 vUv;\n  void main() {\n    vec2 imageCoord = vUv;\n    vec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );\n    for( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {\n      sum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];\n      imageCoord += uImageIncrement;\n    }\n    gl_FragColor = sum;\n  }`,\n\n  buildKernel(sigma) {\n\n    // We lop off the sqrt(2 * pi) * sigma term, since we're going to normalize anyway.\n\n    function gauss(x, sigma) {\n\n      return Math.exp(-(x * x) / (2.0 * sigma * sigma));\n\n    }\n\n    let i;\n    let sum;\n    const kMaxKernelSize = 25;\n    let kernelSize = 2 * Math.ceil(sigma * 3.0) + 1;\n\n    if (kernelSize > kMaxKernelSize) kernelSize = kMaxKernelSize;\n    const halfWidth = (kernelSize - 1) * 0.5;\n\n    const values = new Array(kernelSize);\n    sum = 0.0;\n    for (i = 0; i < kernelSize; ++i) {\n\n      values[ i ] = gauss(i - halfWidth, sigma);\n      sum += values[ i ];\n\n    }\n\n    // normalize the kernel\n\n    for (i = 0; i < kernelSize; ++i) values[ i ] /= sum;\n\n    return values;\n\n  },\n\n};\n\nexport default ConvolutionShader;\n","import {\n  LinearFilter,\n  RGBAFormat,\n  WebGLRenderTarget,\n  UniformsUtils,\n  ShaderMaterial,\n  AdditiveBlending,\n  Vector2,\n  OrthographicCamera,\n  Scene,\n  Mesh,\n  PlaneBufferGeometry,\n} from 'three';\nimport Pass from './Pass';\nimport CopyShader from '../shader/CopyShader';\nimport ConvolutionShader from '../shader/ConvolutionShader';\n\nexport default class BloomPass extends Pass {\n  constructor(strength, kernelSize, sigma, resolution) {\n    super();\n    strength = (strength !== undefined) ? strength : 1;\n    kernelSize = (kernelSize !== undefined) ? kernelSize : 25;\n    sigma = (sigma !== undefined) ? sigma : 4.0;\n    resolution = (resolution !== undefined) ? resolution : 256;\n\n    // render targets\n\n    const pars = { minFilter: LinearFilter, magFilter: LinearFilter, format: RGBAFormat };\n\n    this.renderTargetX = new WebGLRenderTarget(resolution, resolution, pars);\n    this.renderTargetX.texture.name = 'BloomPass.x';\n    this.renderTargetY = new WebGLRenderTarget(resolution, resolution, pars);\n    this.renderTargetY.texture.name = 'BloomPass.y';\n\n    // copy material\n\n    if (CopyShader === undefined) console.error('BloomPass relies on CopyShader');\n\n    const copyShader = CopyShader;\n\n    this.copyUniforms = UniformsUtils.clone(copyShader.uniforms);\n\n    this.copyUniforms.opacity.value = strength;\n\n    this.materialCopy = new ShaderMaterial({\n      uniforms: this.copyUniforms,\n      vertexShader: copyShader.vertexShader,\n      fragmentShader: copyShader.fragmentShader,\n      blending: AdditiveBlending,\n      transparent: true,\n    });\n\n    // convolution material\n\n    if (ConvolutionShader === undefined) console.error('BloomPass relies on ConvolutionShader');\n\n    const convolutionShader = ConvolutionShader;\n\n    this.convolutionUniforms = UniformsUtils.clone(convolutionShader.uniforms);\n\n    this.convolutionUniforms.uImageIncrement.value = BloomPass.blurX;\n    this.convolutionUniforms.cKernel.value = ConvolutionShader.buildKernel(sigma);\n\n    this.materialConvolution = new ShaderMaterial({\n      uniforms: this.convolutionUniforms,\n      vertexShader: convolutionShader.vertexShader,\n      fragmentShader: convolutionShader.fragmentShader,\n      defines: {\n        KERNEL_SIZE_FLOAT: kernelSize.toFixed(1),\n        KERNEL_SIZE_INT: kernelSize.toFixed(0),\n      },\n    });\n\n    this.needsSwap = false;\n\n    this.camera = new OrthographicCamera(-1, 1, 1, -1, 0, 1);\n    this.scene = new Scene();\n\n    this.quad = new Mesh(new PlaneBufferGeometry(2, 2), null);\n    this.quad.frustumCulled = false; // Avoid getting clipped\n    this.scene.add(this.quad);\n  }\n\n  render(renderer, writeBuffer, readBuffer, delta, maskActive) {\n\n    if (maskActive) renderer.context.disable(renderer.context.STENCIL_TEST);\n\n    // Render quad with blured scene into texture (convolution pass 1)\n\n    this.quad.material = this.materialConvolution;\n\n    this.convolutionUniforms.tDiffuse.value = readBuffer.texture;\n    this.convolutionUniforms.uImageIncrement.value = BloomPass.blurX;\n\n    renderer.render(this.scene, this.camera, this.renderTargetX, true);\n\n\n    // Render quad with blured scene into texture (convolution pass 2)\n\n    this.convolutionUniforms.tDiffuse.value = this.renderTargetX.texture;\n    this.convolutionUniforms.uImageIncrement.value = BloomPass.blurY;\n\n    renderer.render(this.scene, this.camera, this.renderTargetY, true);\n\n    // Render original scene with superimposed blur to texture\n\n    this.quad.material = this.materialCopy;\n\n    this.copyUniforms.tDiffuse.value = this.renderTargetY.texture;\n\n    if (maskActive) renderer.context.enable(renderer.context.STENCIL_TEST);\n\n    renderer.render(this.scene, this.camera, readBuffer, this.clear);\n\n  }\n}\n\nBloomPass.blurX = new Vector2(0.001953125, 0.0);\nBloomPass.blurY = new Vector2(0.0, 0.001953125);\n","import Pass from './Pass';\n\nexport default class ClearMaskPass extends Pass {\n  constructor() {\n    super();\n    this.needsSwap = false;\n  }\n\n  render(renderer) {\n    renderer.state.buffers.stencil.setTest(false);\n  }\n}\n","/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Film grain & scanlines shader\n *\n * - ported from HLSL to WebGL / GLSL\n * http://www.truevision3d.com/forums/showcase/staticnoise_colorblackwhite_scanline_shaders-t18698.0.html\n *\n * Screen Space Static Postprocessor\n *\n * Produces an analogue noise overlay similar to a film grain / TV static\n *\n * Original implementation and noise algorithm\n * Pat 'Hawthorne' Shearon\n *\n * Optimized scanlines + noise version with intensity scaling\n * Georg 'Leviathan' Steinrohder\n *\n * This version is provided under a Creative Commons Attribution 3.0 License\n * http://creativecommons.org/licenses/by/3.0/\n * @private\n */\nconst FilmShader = {\n  uniforms: {\n    tDiffuse: { value: null },\n    time: { value: 0.0 },\n    nIntensity: { value: 0.5 },\n    sIntensity: { value: 0.05 },\n    sCount: { value: 4096 },\n    grayscale: { value: 1 },\n  },\n\n  vertexShader: `\n  varying vec2 vUv;\n  void main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  }`,\n\n  fragmentShader: `\n  #include <common>\n  // control parameter\n  uniform float time;\n\n  uniform bool grayscale;\n\n  // noise effect intensity value (0 = no effect, 1 = full effect)\n  uniform float nIntensity;\n\n  // scanlines effect intensity value (0 = no effect, 1 = full effect)\n  uniform float sIntensity;\n\n  // scanlines effect count value (0 = no effect, 4096 = full effect)\n  uniform float sCount;\n\n  uniform sampler2D tDiffuse;\n\n  varying vec2 vUv;\n\n  void main() {\n    // sample the source\n    vec4 cTextureScreen = texture2D( tDiffuse, vUv );\n\n    // make some noise\n    float dx = rand( vUv + time );\n\n    // add noise\n    vec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx, 0.0, 1.0 );\n\n    // get us a sine and cosine\n    vec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );\n\n    // add scanlines\n    cResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;\n\n    // interpolate between source and result by intensity\n    cResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );\n\n    // convert to grayscale if desired\n    if( grayscale ) {\n\n      cResult = vec3( cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 );\n\n    }\n\n    gl_FragColor =  vec4( cResult, cTextureScreen.a );\n\n  }`,\n\n};\n\nexport default FilmShader;\n","import {\n  UniformsUtils,\n  ShaderMaterial,\n  OrthographicCamera,\n  Scene,\n  Mesh,\n  PlaneBufferGeometry,\n} from 'three';\nimport Pass from './Pass';\nimport FilmShader from '../shader/FilmShader';\n\n/**\n * @author alteredq / http://alteredqualia.com/\n * @private\n */\nexport default class FilmPass extends Pass {\n  constructor(noiseIntensity, scanlinesIntensity, scanlinesCount, grayscale) {\n    super();\n\n    if (FilmShader === undefined) console.error('FilmPass relies on FilmShader');\n\n    const shader = FilmShader;\n\n    this.uniforms = UniformsUtils.clone(shader.uniforms);\n\n    this.material = new ShaderMaterial({\n\n      uniforms: this.uniforms,\n      vertexShader: shader.vertexShader,\n      fragmentShader: shader.fragmentShader,\n\n    });\n\n    if (grayscale !== undefined)\tthis.uniforms.grayscale.value = grayscale;\n    if (noiseIntensity !== undefined) this.uniforms.nIntensity.value = noiseIntensity;\n    if (scanlinesIntensity !== undefined) this.uniforms.sIntensity.value = scanlinesIntensity;\n    if (scanlinesCount !== undefined) this.uniforms.sCount.value = scanlinesCount;\n\n    this.camera = new OrthographicCamera(-1, 1, 1, -1, 0, 1);\n    this.scene = new Scene();\n\n    this.quad = new Mesh(new PlaneBufferGeometry(2, 2), null);\n    this.quad.frustumCulled = false; // Avoid getting clipped\n    this.scene.add(this.quad);\n  }\n\n  render(renderer, writeBuffer, readBuffer, delta) {\n\n    this.uniforms.tDiffuse.value = readBuffer.texture;\n    this.uniforms.time.value += delta;\n\n    this.quad.material = this.material;\n\n    if (this.renderToScreen) {\n\n      renderer.render(this.scene, this.camera);\n\n    } else {\n\n      renderer.render(this.scene, this.camera, writeBuffer, this.clear);\n\n    }\n\n  }\n}\n","/**\n * @author felixturner / http://airtight.cc/\n *\n * RGB Shift Shader\n * Shifts red and blue channels from center in opposite directions\n * Ported from http://kriss.cx/tom/2009/05/rgb-shift/\n * by Tom Butterworth / http://kriss.cx/tom/\n *\n * amount: shift distance (1 is width of input)\n * angle: shift angle in radians\n * @private\n */\nconst DigitalGlitch = {\n\n  uniforms: {\n\n    tDiffuse: { value: null }, // diffuse texture\n    tDisp: { value: null }, // displacement texture for digital glitch squares\n    byp: { value: 0 }, // apply the glitch ?\n    amount: { value: 0.08 },\n    angle: { value: 0.02 },\n    seed: { value: 0.02 },\n    seed_x: { value: 0.02 }, // -1,1\n    seed_y: { value: 0.02 }, // -1,1\n    distortion_x:\t{ value: 0.5 },\n    distortion_y:\t{ value: 0.6 },\n    col_s: { value: 0.05 },\n  },\n\n  vertexShader: `\n  varying vec2 vUv;\n  void main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  }`,\n\n  fragmentShader: `\n  uniform int byp; // should we apply the glitch ?\n\n  uniform sampler2D tDiffuse;\n  uniform sampler2D tDisp;\n\n  uniform float amount;\n  uniform float angle;\n  uniform float seed;\n  uniform float seed_x;\n  uniform float seed_y;\n  uniform float distortion_x;\n  uniform float distortion_y;\n  uniform float col_s;\n\n  varying vec2 vUv;\n\n\n  float rand(vec2 co){\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n  }\n\n  void main() {\n    if(byp<1) {\n      vec2 p = vUv;\n      float xs = floor(gl_FragCoord.x / 0.5);\n      float ys = floor(gl_FragCoord.y / 0.5);\n      // based on staffantans glitch shader for unity https://github.com/staffantan/unityglitch\n      vec4 normal = texture2D (tDisp, p*seed*seed);\n      if(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {\n        if(seed_x>0.){\n          p.y = 1. - (p.y + distortion_y);\n        }\n        else {\n          p.y = distortion_y;\n        }\n      }\n      if(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {\n        if(seed_y>0.){\n          p.x=distortion_x;\n        }\n        else {\n          p.x = 1. - (p.x + distortion_x);\n        }\n      }\n      p.x+=normal.x*seed_x*(seed/5.);\n      p.y+=normal.y*seed_y*(seed/5.);\n      // base from RGB shift shader\n      vec2 offset = amount * vec2( cos(angle), sin(angle));\n      vec4 cr = texture2D(tDiffuse, p + offset);\n      vec4 cga = texture2D(tDiffuse, p);\n      vec4 cb = texture2D(tDiffuse, p - offset);\n      gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);\n      // add noise\n      vec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);\n      gl_FragColor = gl_FragColor+ snow;\n    }\n    else {\n      gl_FragColor=texture2D (tDiffuse, vUv);\n    }\n  }`,\n\n};\n\nexport default DigitalGlitch;\n","import {\n  UniformsUtils,\n  ShaderMaterial,\n  OrthographicCamera,\n  Scene,\n  Mesh,\n  PlaneBufferGeometry,\n  DataTexture,\n  RGBFormat,\n  FloatType,\n} from 'three';\nimport Pass from './Pass';\nimport DigitalGlitch from '../shader/DigitalGlitch';\nimport Utils from '../utils/Utils';\n\n/**\n * @author alteredq / http://alteredqualia.com/\n * @private\n */\nexport default class GlitchPass extends Pass {\n  constructor(dt_size) {\n    super();\n    if (DigitalGlitch === undefined) console.error('GlitchPass relies on DigitalGlitch');\n\n    const shader = DigitalGlitch;\n    this.uniforms = UniformsUtils.clone(shader.uniforms);\n\n    if (dt_size === undefined) dt_size = 64;\n\n\n    this.uniforms.tDisp.value = this.generateHeightmap(dt_size);\n\n\n    this.material = new ShaderMaterial({\n      uniforms: this.uniforms,\n      vertexShader: shader.vertexShader,\n      fragmentShader: shader.fragmentShader,\n    });\n\n    this.camera = new OrthographicCamera(-1, 1, 1, -1, 0, 1);\n    this.scene = new Scene();\n\n    this.quad = new Mesh(new PlaneBufferGeometry(2, 2), null);\n    this.quad.frustumCulled = false; // Avoid getting clipped\n    this.scene.add(this.quad);\n\n    this.goWild = false;\n    this.curF = 0;\n    this.generateTrigger();\n  }\n  render(renderer, writeBuffer, readBuffer) {\n\n    this.uniforms.tDiffuse.value = readBuffer.texture;\n    this.uniforms.seed.value = Math.random(); // default seeding\n    this.uniforms.byp.value = 0;\n\n    if (this.curF % this.randX === 0 || this.goWild === true) {\n\n      this.uniforms.amount.value = Math.random() / 30;\n      this.uniforms.angle.value = Utils.random(-Math.PI, Math.PI);\n      this.uniforms.seed_x.value = Utils.random(-1, 1);\n      this.uniforms.seed_y.value = Utils.random(-1, 1);\n      this.uniforms.distortion_x.value = Utils.random(0, 1);\n      this.uniforms.distortion_y.value = Utils.random(0, 1);\n      this.curF = 0;\n      this.generateTrigger();\n\n    } else if (this.curF % this.randX < this.randX / 5) {\n\n      this.uniforms.amount.value = Math.random() / 90;\n      this.uniforms.angle.value = Utils.random(-Math.PI, Math.PI);\n      this.uniforms.distortion_x.value = Utils.random(0, 1);\n      this.uniforms.distortion_y.value = Utils.random(0, 1);\n      this.uniforms.seed_x.value = Utils.random(-0.3, 0.3);\n      this.uniforms.seed_y.value = Utils.random(-0.3, 0.3);\n\n    } else if (this.goWild === false) {\n\n      this.uniforms.byp.value = 1;\n\n    }\n\n    this.curF++;\n    this.quad.material = this.material;\n\n    if (this.renderToScreen) {\n\n      renderer.render(this.scene, this.camera);\n\n    } else {\n\n      renderer.render(this.scene, this.camera, writeBuffer, this.clear);\n\n    }\n\n  }\n\n  generateTrigger() {\n\n    this.randX = Utils.random(120, 240) >> 0;\n\n  }\n\n  generateHeightmap(dt_size) {\n\n    const data_arr = new Float32Array(dt_size * dt_size * 3);\n    const length = dt_size * dt_size;\n\n    for (let i = 0; i < length; i++) {\n\n      const val = Utils.random(0, 1);\n      data_arr[ i * 3 + 0 ] = val;\n      data_arr[ i * 3 + 1 ] = val;\n      data_arr[ i * 3 + 2 ] = val;\n\n    }\n\n    const texture = new DataTexture(data_arr, dt_size, dt_size, RGBFormat, FloatType);\n    texture.needsUpdate = true;\n    return texture;\n\n  }\n}\n","import Pass from './Pass';\n\n/**\n * @author alteredq / http://alteredqualia.com/\n * @private\n */\nexport default class MaskPass extends Pass {\n  constructor(scene, camera) {\n    super();\n    this.scene = scene;\n    this.camera = camera;\n\n    this.clear = true;\n    this.needsSwap = false;\n    this.inverse = false;\n  }\n\n  render(renderer, writeBuffer, readBuffer) {\n\n    const context = renderer.context;\n    const state = renderer.state;\n\n    // don't update color or depth\n\n    state.buffers.color.setMask(false);\n    state.buffers.depth.setMask(false);\n\n    // lock buffers\n\n    state.buffers.color.setLocked(true);\n    state.buffers.depth.setLocked(true);\n\n    // set up stencil\n\n    let writeValue;\n    let clearValue;\n\n    if (this.inverse) {\n\n      writeValue = 0;\n      clearValue = 1;\n\n    } else {\n\n      writeValue = 1;\n      clearValue = 0;\n\n    }\n\n    state.buffers.stencil.setTest(true);\n    state.buffers.stencil.setOp(context.REPLACE, context.REPLACE, context.REPLACE);\n    state.buffers.stencil.setFunc(context.ALWAYS, writeValue, 0xffffffff);\n    state.buffers.stencil.setClear(clearValue);\n\n    // draw into the stencil buffer\n\n    renderer.render(this.scene, this.camera, readBuffer, this.clear);\n    renderer.render(this.scene, this.camera, writeBuffer, this.clear);\n\n    // unlock color and depth buffer for subsequent rendering\n\n    state.buffers.color.setLocked(false);\n    state.buffers.depth.setLocked(false);\n\n    // only render where stencil is set to 1\n\n    state.buffers.stencil.setFunc(context.EQUAL, 1, 0xffffffff); // draw if == 1\n    state.buffers.stencil.setOp(context.KEEP, context.KEEP, context.KEEP);\n\n  }\n\n}\n","/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Focus shader\n * based on PaintEffect postprocess from ro.me\n * http://code.google.com/p/3-dreams-of-black/source/browse/deploy/js/effects/PaintEffect.js\n * @private\n */\nconst MattingShader = {\n\n  uniforms: {\n\n    tDiffuse: { value: null },\n\n    hueStart: { value: 0.0 },\n    hueEnd: { value: 1.0 },\n    lightnessStart: { value: 0.4 },\n    lightnessEnd: { value: 1.0 },\n\n  },\n\n  vertexShader: `\n  varying vec2 vUv;\n  void main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  }`,\n\n  fragmentShader: `\n  uniform float hueStart;\n  uniform float hueEnd;\n  uniform float lightnessStart;\n  uniform float lightnessEnd;\n\n  uniform sampler2D tDiffuse;\n\n  varying vec2 vUv;\n\n  vec3 rgb2hsv(vec3 c){\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n  }\n\n  void main() {\n    float lightnessCenter = (lightnessStart + lightnessEnd) / 2.0;\n    float lightnessRadius = (lightnessEnd - lightnessStart) / 2.0;\n\n    vec4 rgbColor = texture2D( tDiffuse, vUv );\n\n    vec3 hsv = rgb2hsv(rgbColor.rgb);\n\n    float alpha = 1.0;\n\n    // if (hsv.x > hueStart && hsv.x < hueEnd) {\n      float distance = abs(hsv.z - lightnessCenter) / lightnessRadius;\n      alpha = clamp(distance, 0.0, 1.0);\n    // }\n    gl_FragColor = vec4(rgbColor.rgb, alpha * alpha);\n\n  }`,\n};\n\nexport default MattingShader;\n","import {\n  Color,\n} from 'three';\n\n/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Focus shader\n * based on PaintEffect postprocess from ro.me\n * http://code.google.com/p/3-dreams-of-black/source/browse/deploy/js/effects/PaintEffect.js\n * @private\n */\nconst EdgeBlurShader = {\n\n  uniforms: {\n\n    tDiffuse: { value: null },\n\n    frameSize: { value: [] },\n\n    cKernel: { value: [\n      0.045, 0.122, 0.045,\n      0.122, 0.332, 0.122,\n      0.045, 0.122, 0.045,\n    ] },\n\n  },\n\n  vertexShader: `\n  varying vec2 vUv;\n  void main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  }`,\n\n  fragmentShader: `\n  uniform float cKernel[9];\n\n  uniform vec2 frameSize;\n\n  uniform sampler2D tDiffuse;\n\n  varying vec2 vUv;\n\n  void main() {\n    vec2 onePixel = vec2(1.0, 1.0) / frameSize;\n\n    vec4 rgbColor =\n      texture2D(tDiffuse, vUv + onePixel * vec2(-1, -1)) * cKernel[0] +\n      texture2D(tDiffuse, vUv + onePixel * vec2( 0, -1)) * cKernel[1] +\n      texture2D(tDiffuse, vUv + onePixel * vec2( 1, -1)) * cKernel[2] +\n      texture2D(tDiffuse, vUv + onePixel * vec2(-1,  0)) * cKernel[3] +\n      texture2D(tDiffuse, vUv + onePixel * vec2( 0,  0)) * cKernel[4] +\n      texture2D(tDiffuse, vUv + onePixel * vec2( 1,  0)) * cKernel[5] +\n      texture2D(tDiffuse, vUv + onePixel * vec2(-1,  1)) * cKernel[6] +\n      texture2D(tDiffuse, vUv + onePixel * vec2( 0,  1)) * cKernel[7] +\n      texture2D(tDiffuse, vUv + onePixel * vec2( 1,  1)) * cKernel[8] ;\n\n    gl_FragColor = rgbColor;\n  }`,\n};\n\nexport default EdgeBlurShader;\n","import {\n  LinearFilter,\n  RGBAFormat,\n  WebGLRenderTarget,\n  UniformsUtils,\n  ShaderMaterial,\n  AdditiveBlending,\n  Vector2,\n  OrthographicCamera,\n  Scene,\n  Mesh,\n  PlaneBufferGeometry,\n} from 'three';\nimport Pass from './Pass';\nimport CopyShader from '../shader/CopyShader';\nimport MattingShader from '../shader/MattingShader';\nimport EdgeBlur from '../shader/EdgeBlur';\n\nexport default class MattingPass extends Pass {\n  constructor(primer, options) {\n    super();\n\n    const { width, height, strength = 1.0, hueStart = 0.0, hueEnd = 1.0, lightnessStart = 0.6, lightnessEnd = 1.0 } = options || {};\n\n    this.primer = primer;\n\n    // render targets\n\n    const pars = { minFilter: LinearFilter, magFilter: LinearFilter, format: RGBAFormat };\n\n    this.renderTargetX = new WebGLRenderTarget(width, height, pars);\n    this.renderTargetX.texture.name = 'MattingPass.x';\n    this.renderTargetY = new WebGLRenderTarget(width, height, pars);\n    this.renderTargetY.texture.name = 'MattingPass.y';\n\n    // copy material\n\n    if (CopyShader === undefined) console.error('MattingPass relies on CopyShader');\n\n    const copyShader = CopyShader;\n\n    this.copyUniforms = UniformsUtils.clone(copyShader.uniforms);\n\n    this.copyUniforms.opacity.value = strength;\n\n    this.materialCopy = new ShaderMaterial({\n      uniforms: this.copyUniforms,\n      vertexShader: copyShader.vertexShader,\n      fragmentShader: copyShader.fragmentShader,\n      blending: AdditiveBlending,\n      transparent: true,\n    });\n\n    // matting material\n\n    if (MattingShader === undefined) console.error('MattingPass relies on MattingShader');\n\n    this.mattingUniforms = UniformsUtils.clone(MattingShader.uniforms);\n\n    this.mattingUniforms.hueStart.value = hueStart;\n    this.mattingUniforms.hueEnd.value = hueEnd;\n    this.mattingUniforms.lightnessStart.value = lightnessStart;\n    this.mattingUniforms.lightnessEnd.value = lightnessEnd;\n\n    this.materialMatting = new ShaderMaterial({\n      uniforms: this.mattingUniforms,\n      vertexShader: MattingShader.vertexShader,\n      fragmentShader: MattingShader.fragmentShader,\n      blending: AdditiveBlending,\n      transparent: true,\n    });\n\n    this.edgeBlurUniforms = UniformsUtils.clone(EdgeBlur.uniforms);\n    this.edgeBlurUniforms.frameSize.value = new Vector2(width, height);\n\n\n    this.materialEdgeBlur = new ShaderMaterial({\n      uniforms: this.edgeBlurUniforms,\n      vertexShader: EdgeBlur.vertexShader,\n      fragmentShader: EdgeBlur.fragmentShader,\n      blending: AdditiveBlending,\n      transparent: true,\n    });\n\n    this.needsSwap = false;\n\n    this.camera = new OrthographicCamera(-1, 1, 1, -1, 0, 1);\n    this.scene = new Scene();\n\n    this.quad = new Mesh(new PlaneBufferGeometry(2, 2), null);\n    this.quad.frustumCulled = false; // Avoid getting clipped\n    this.scene.add(this.quad);\n  }\n\n  render(renderer, writeBuffer, readBuffer, delta, maskActive) {\n\n    if (maskActive) renderer.context.disable(renderer.context.STENCIL_TEST);\n\n    this.primer.render(renderer, this.renderTargetX);\n\n    this.quad.material = this.materialMatting;\n    this.mattingUniforms.tDiffuse.value = this.renderTargetX.texture;\n    renderer.render(this.scene, this.camera, this.renderTargetY, true);\n\n\n    this.quad.material = this.materialEdgeBlur;\n    this.edgeBlurUniforms.tDiffuse.value = this.renderTargetY.texture;\n    renderer.render(this.scene, this.camera, null, this.clear);\n\n    // Render quad with blured scene into texture (convolution pass 2)\n\n    // this.convolutionUniforms.tDiffuse.value = this.renderTargetX.texture;\n    // this.convolutionUniforms.uImageIncrement.value = MattingPass.blurY;\n\n    // renderer.render(this.scene, this.camera, this.renderTargetY, true);\n\n    // // Render original scene with superimposed blur to texture\n\n    // this.quad.material = this.materialCopy;\n\n    // this.copyUniforms.tDiffuse.value = this.renderTargetY.texture;\n\n    if (maskActive) renderer.context.enable(renderer.context.STENCIL_TEST);\n\n    // renderer.render(this.scene, this.camera, readBuffer, this.clear);\n\n  }\n}\n","import Pass from './Pass';\n\nexport default class RenderPass extends Pass {\n  constructor(scene, camera, overrideMaterial, clearColor, clearAlpha) {\n    super();\n    this.scene = scene;\n    this.camera = camera;\n\n    this.overrideMaterial = overrideMaterial;\n\n    this.clearColor = clearColor;\n    this.clearAlpha = (clearAlpha !== undefined) ? clearAlpha : 0;\n\n    this.clear = false;\n    this.clearDepth = false;\n    this.needsSwap = false;\n  }\n\n  render(renderer, writeBuffer, readBuffer) {\n\n    const oldAutoClear = renderer.autoClear;\n    renderer.autoClear = false;\n\n    this.scene.overrideMaterial = this.overrideMaterial;\n\n    let oldClearColor;\n    let oldClearAlpha;\n\n    if (this.clearColor) {\n\n      oldClearColor = renderer.getClearColor().getHex();\n      oldClearAlpha = renderer.getClearAlpha();\n\n      renderer.setClearColor(this.clearColor, this.clearAlpha);\n\n    }\n\n    if (this.clearDepth) {\n\n      renderer.clearDepth();\n\n    }\n\n    renderer.render(this.scene, this.camera, this.renderToScreen ? null : readBuffer, this.clear);\n\n    if (this.clearColor) {\n\n      renderer.setClearColor(oldClearColor, oldClearAlpha);\n\n    }\n\n    this.scene.overrideMaterial = null;\n    renderer.autoClear = oldAutoClear;\n  }\n}\n","import { ShaderMaterial, UniformsUtils, OrthographicCamera, Scene, Mesh, PlaneBufferGeometry } from 'three';\nimport Pass from './Pass';\n/**\n * @author alteredq / http://alteredqualia.com/\n * @private\n */\nexport default class ShaderPass extends Pass {\n  constructor(shader, textureID) {\n    super();\n    this.textureID = (textureID !== undefined) ? textureID : 'tDiffuse';\n\n    if (shader instanceof ShaderMaterial) {\n\n      this.uniforms = shader.uniforms;\n\n      this.material = shader;\n\n    } else if (shader) {\n\n      this.uniforms = UniformsUtils.clone(shader.uniforms);\n\n      this.material = new ShaderMaterial({\n\n        defines: shader.defines || {},\n        uniforms: this.uniforms,\n        vertexShader: shader.vertexShader,\n        fragmentShader: shader.fragmentShader,\n\n      });\n\n    }\n\n    this.camera = new OrthographicCamera(-1, 1, 1, -1, 0, 1);\n    this.scene = new Scene();\n\n    this.quad = new Mesh(new PlaneBufferGeometry(2, 2), null);\n    this.quad.frustumCulled = false; // Avoid getting clipped\n    this.scene.add(this.quad);\n  }\n\n  render(renderer, writeBuffer, readBuffer) {\n\n    if (this.uniforms[ this.textureID ]) {\n      this.uniforms[ this.textureID ].value = readBuffer.texture;\n    }\n\n    this.quad.material = this.material;\n\n    if (this.renderToScreen) {\n      renderer.render(this.scene, this.camera);\n    } else {\n      renderer.render(this.scene, this.camera, writeBuffer, this.clear);\n    }\n  }\n}\n","/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Focus shader\n * based on PaintEffect postprocess from ro.me\n * http://code.google.com/p/3-dreams-of-black/source/browse/deploy/js/effects/PaintEffect.js\n * @private\n */\nconst FocusShader = {\n\n  uniforms: {\n\n    tDiffuse: { value: null },\n    screenWidth: { value: 1024 },\n    screenHeight: { value: 1024 },\n    sampleDistance: { value: 0.94 },\n    waveFactor: { value: 0.00125 },\n\n  },\n\n  vertexShader: `\n  varying vec2 vUv;\n  void main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  }`,\n\n  fragmentShader: `\n  uniform float screenWidth;\n  uniform float screenHeight;\n  uniform float sampleDistance;\n  uniform float waveFactor;\n\n  uniform sampler2D tDiffuse;\n\n  varying vec2 vUv;\n\n  void main() {\n\n    vec4 color, org, tmp, add;\n    float sample_dist, f;\n    vec2 vin;\n    vec2 uv = vUv;\n\n    add = color = org = texture2D( tDiffuse, uv );\n\n    vin = ( uv - vec2( 0.5 ) ) * vec2( 1.4 );\n    sample_dist = dot( vin, vin ) * 2.0;\n\n    f = ( waveFactor * 100.0 + sample_dist ) * sampleDistance * 4.0;\n\n    vec2 sampleSize = vec2(  1.0 / screenWidth, 1.0 / screenHeight ) * vec2( f );\n\n    add += tmp = texture2D( tDiffuse, uv + vec2( 0.111964, 0.993712 ) * sampleSize );\n    if( tmp.b < color.b ) color = tmp;\n\n    add += tmp = texture2D( tDiffuse, uv + vec2( 0.846724, 0.532032 ) * sampleSize );\n    if( tmp.b < color.b ) color = tmp;\n\n    add += tmp = texture2D( tDiffuse, uv + vec2( 0.943883, -0.330279 ) * sampleSize );\n    if( tmp.b < color.b ) color = tmp;\n\n    add += tmp = texture2D( tDiffuse, uv + vec2( 0.330279, -0.943883 ) * sampleSize );\n    if( tmp.b < color.b ) color = tmp;\n\n    add += tmp = texture2D( tDiffuse, uv + vec2( -0.532032, -0.846724 ) * sampleSize );\n    if( tmp.b < color.b ) color = tmp;\n\n    add += tmp = texture2D( tDiffuse, uv + vec2( -0.993712, -0.111964 ) * sampleSize );\n    if( tmp.b < color.b ) color = tmp;\n\n    add += tmp = texture2D( tDiffuse, uv + vec2( -0.707107, 0.707107 ) * sampleSize );\n    if( tmp.b < color.b ) color = tmp;\n\n    color = color * vec4( 2.0 ) - ( add / vec4( 8.0 ) );\n    color = color + ( add / vec4( 8.0 ) - color ) * ( vec4( 1.0 ) - vec4( sample_dist * 0.5 ) );\n\n    gl_FragColor = vec4( color.rgb * color.rgb * vec3( 0.95 ) + color.rgb, 1.0 );\n\n  }`,\n};\n\nexport default FocusShader;\n","import {\n  Object3D,\n} from 'three';\nimport Utils from '../utils/Utils';\n\n/**\n * used to link 3d-model with reality world, an ar-glue\n *\n * @param {Object} options config\n * @param {String} options.name ar-glue name, same with `setMarkers` name-id\n * @param {Boolean} [options.autoHide=true] whether auto-hide when marker have not detected\n */\nclass ARGlue extends Object3D {\n  constructor(options) {\n    super();\n    options = options || {};\n\n    /**\n     * unique name in all ar-glue object\n     *\n     * @member {String}\n     */\n    this.name = options.name;\n\n    /**\n     * whether auto-hide when marker have not detected\n     *\n     * @member {Boolean}\n     */\n    this.autoHide = Utils.isBoolean(options.autoHide) ? options.autoHide : true;\n\n    /**\n     * close this object matrixAutoUpdate, just recive matrix from `UC-AR`\n     *\n     * @member {Boolean}\n     */\n    this.matrixAutoUpdate = false;\n\n    /**\n     * class type, a mark to distinguish ar-glue and normal display-object\n     *\n     * @member {String}\n     */\n    this.type = 'ARGlue';\n\n    if (!options.name) {\n      console.error('ARGlue: this glue must have a name');\n    }\n  }\n\n  /**\n   * update this glue pose matrix\n   * @param {Array} matrix pose matrix\n   * @param {Boolean} isDetected whether detected at this tick\n   */\n  updatePose(matrix, isDetected) {\n    if (this.autoHide && !isDetected) {\n      this.visible = false;\n    } else {\n      this.visible = true;\n    }\n    this.matrix.fromArray(matrix);\n  }\n}\n\nexport default ARGlue;\n","import { LinearFilter, RGBAFormat, WebGLRenderTarget } from 'three';\nimport CopyShader from '../shader/CopyShader';\nimport ShaderPass from '../postprocessing/ShaderPass';\n\nconst parameters = {\n  minFilter: LinearFilter,\n  magFilter: LinearFilter,\n  format: RGBAFormat,\n  stencilBuffer: false,\n};\n\n/**\n * @author alteredq / http://alteredqualia.com/\n * @private\n */\nexport default class EffectComposer {\n  constructor(options) {\n    const { width, height } = options;\n    this.autoClear = true;\n\n    this.renderTarget1 = new WebGLRenderTarget(width, height, parameters);\n    this.renderTarget1.texture.name = 'RT1';\n\n    this.renderTarget2 = this.renderTarget1.clone();\n    this.renderTarget2.texture.name = 'RT2';\n\n    this.writeBuffer = this.renderTarget1;\n    this.readBuffer = this.renderTarget2;\n\n    // dependencies ShaderPass and CopyShader\n    this.copyPass = new ShaderPass(CopyShader);\n  }\n\n  swapBuffers() {\n    const tmp = this.readBuffer;\n    this.readBuffer = this.writeBuffer;\n    this.writeBuffer = tmp;\n  }\n\n  render(renderer, effectPack, toScreen) {\n    const il = effectPack.passes.length;\n    const delta = effectPack.delta;\n\n    // copy content to readBuffer\n    this.copyPass.render(renderer, this.readBuffer, effectPack.renderTarget);\n\n    // add effect like yoyo\n    for (let i = 0; i < il; i++) {\n      const pass = effectPack.passes[i];\n      if (pass.enabled === false) continue;\n\n      pass.render(renderer, this.writeBuffer, this.readBuffer, delta);\n\n      if (pass.needsSwap) {\n        this.swapBuffers();\n      }\n    }\n\n    // copy content back to layer buffer\n    const renderTarget = toScreen ? null : effectPack.renderTarget;\n    this.copyPass.render(renderer, renderTarget, this.readBuffer);\n  }\n\n  /**\n   * resize buffer size when viewport has change\n   * @param {number} width render buffer width\n   * @param {number} height render buffer height\n   */\n  setSize(width, height) {\n    this.renderTarget1.setSize(width, height);\n    this.renderTarget2.setSize(width, height);\n  }\n\n}\n","/**\n * get variable type\n * @param {*} val a variable which you want to get the type\n * @return {String} variable-type\n */\nfunction _rt(val) {\n  return Object.prototype.toString.call(val);\n}\n\n/**\n * Utils tool box\n *\n * @namespace Utils\n */\nexport const Utils = {\n  /**\n   * determine whether it is a `Function`\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {*} variable a variable which you want to determine\n   * @return {Boolean} type result\n   */\n  isFunction: (function() {\n    const ks = _rt(function() {});\n    return function(variable) {\n      return _rt(variable) === ks;\n    };\n  })(),\n\n\n  /**\n   * determine whether it is a `undefined`\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {*} variable a variable which you want to determine\n   * @return {Boolean} type result\n   */\n  isUndefined(variable) {\n    return typeof variable === 'undefined';\n  },\n};\n","import { EventDispatcher, Object3D } from 'three';\nimport { Utils } from '../utils/Utils.js';\n\n/**\n * proxy `addEventListener` function\n *\n * @param {String} type event type, evnet name\n * @param {Function} fn callback\n * @return {this} this\n */\nEventDispatcher.prototype.on = function(type, fn) {\n  if (!Utils.isFunction(fn)) return;\n  if (this instanceof Object3D) this.interactive = true;\n  this.addEventListener(type, fn);\n  return this;\n};\n\n/**\n * proxy `removeEventListener` function\n *\n * @param {String} type event type, evnet name\n * @param {Function} fn callback, which you had bind before\n * @return {this} this\n */\nEventDispatcher.prototype.off = function(type, fn) {\n  this.removeEventListener(type, fn);\n  return this;\n};\n\n/**\n * binding a once event, just emit once time\n *\n * @param {String} type event type, evnet name\n * @param {Function} fn callback\n * @return {this} this\n */\nEventDispatcher.prototype.once = function(type, fn) {\n  if (!Utils.isFunction(fn)) return;\n  const cb = (ev) => {\n    fn(ev);\n    this.off(type, cb);\n  };\n  this.on(type, cb);\n  return this;\n};\n\n/**\n * emit a event\n *\n * @param {String} type event type, evnet name\n * @return {this} this\n */\nEventDispatcher.prototype.emit = function(type, ...argument) {\n  if (this._listeners === undefined || Utils.isUndefined(this._listeners[type])) return;\n  const cbs = this._listeners[type] || [];\n  const cache = cbs.slice(0);\n\n  for (let i = 0; i < cache.length; i++) {\n    cache[i].apply(this, argument);\n  }\n  return this;\n};\n\n","import { Object3D } from 'three';\n\n/**\n * whether displayObject is interactively\n */\nObject3D.prototype.interactive = false;\n\n/**\n * whether displayObject's children is interactively\n */\nObject3D.prototype.interactiveChildren = true;\n\n/**\n * whether displayObject had touchstart\n * @private\n */\nObject3D.prototype.started = false;\n\n/**\n * tracked event cache, like: touchend、mouseout、pointerout which decided by primary-event\n */\nObject.defineProperty(Object3D.prototype, 'trackedPointers', {\n  get() {\n    if (!this._trackedPointers) this._trackedPointers = {};\n    return this._trackedPointers;\n  },\n});\n\n/**\n * dispatch a raycast\n *\n * @param {Raycaster} raycaster Raycaster object, get from THREE.Raycaster\n * @return {Object|Boolean} had pass hit-test\n */\nObject3D.prototype.raycastTest = function(raycaster) {\n  const result = [];\n  this.raycast(raycaster, result);\n\n  if (result.length > 0) {\n    return result[0];\n  }\n\n  return false;\n};\n","import { Vector2 } from 'three';\n\n/**\n * Holds all information related to an Interaction event\n *\n * @class\n */\nclass InteractionData {\n  /**\n   * InteractionData constructor\n   */\n  constructor() {\n    /**\n     * This point stores the global coords of where the touch/mouse event happened\n     *\n     * @member {Vector2}\n     */\n    this.global = new Vector2();\n\n    /**\n     * The target DisplayObject that was interacted with\n     *\n     * @member {Object3D}\n     */\n    this.target = null;\n\n    /**\n     * When passed to an event handler, this will be the original DOM Event that was captured\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/TouchEvent\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent\n     * @member {MouseEvent|TouchEvent|PointerEvent}\n     */\n    this.originalEvent = null;\n\n    /**\n     * Unique identifier for this interaction\n     *\n     * @member {number}\n     */\n    this.identifier = null;\n\n    /**\n     * Indicates whether or not the pointer device that created the event is the primary pointer.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/isPrimary\n     * @type {Boolean}\n     */\n    this.isPrimary = false;\n\n    /**\n     * Indicates which button was pressed on the mouse or pointer device to trigger the event.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/button\n     * @type {number}\n     */\n    this.button = 0;\n\n    /**\n     * Indicates which buttons are pressed on the mouse or pointer device when the event is triggered.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/buttons\n     * @type {number}\n     */\n    this.buttons = 0;\n\n    /**\n     * The width of the pointer's contact along the x-axis, measured in CSS pixels.\n     * radiusX of TouchEvents will be represented by this value.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/width\n     * @type {number}\n     */\n    this.width = 0;\n\n    /**\n     * The height of the pointer's contact along the y-axis, measured in CSS pixels.\n     * radiusY of TouchEvents will be represented by this value.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/height\n     * @type {number}\n     */\n    this.height = 0;\n\n    /**\n     * The angle, in degrees, between the pointer device and the screen.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/tiltX\n     * @type {number}\n     */\n    this.tiltX = 0;\n\n    /**\n     * The angle, in degrees, between the pointer device and the screen.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/tiltY\n     * @type {number}\n     */\n    this.tiltY = 0;\n\n    /**\n     * The type of pointer that triggered the event.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/pointerType\n     * @type {string}\n     */\n    this.pointerType = null;\n\n    /**\n     * Pressure applied by the pointing device during the event. A Touch's force property\n     * will be represented by this value.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/pressure\n     * @type {number}\n     */\n    this.pressure = 0;\n\n    /**\n     * From TouchEvents (not PointerEvents triggered by touches), the rotationAngle of the Touch.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Touch/rotationAngle\n     * @type {number}\n     */\n    this.rotationAngle = 0;\n\n    /**\n     * Twist of a stylus pointer.\n     * @see https://w3c.github.io/pointerevents/#pointerevent-interface\n     * @type {number}\n     */\n    this.twist = 0;\n\n    /**\n     * Barrel pressure on a stylus pointer.\n     * @see https://w3c.github.io/pointerevents/#pointerevent-interface\n     * @type {number}\n     */\n    this.tangentialPressure = 0;\n  }\n\n  /**\n   * The unique identifier of the pointer. It will be the same as `identifier`.\n   * @readonly\n   * @member {number}\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/pointerId\n   */\n  get pointerId() {\n    return this.identifier;\n  }\n\n  /**\n   * Copies properties from normalized event data.\n   *\n   * @param {Touch|MouseEvent|PointerEvent} event The normalized event data\n   * @private\n   */\n  _copyEvent(event) {\n    // isPrimary should only change on touchstart/pointerdown, so we don't want to overwrite\n    // it with \"false\" on later events when our shim for it on touch events might not be\n    // accurate\n    if (event.isPrimary) {\n      this.isPrimary = true;\n    }\n    this.button = event.button;\n    this.buttons = event.buttons;\n    this.width = event.width;\n    this.height = event.height;\n    this.tiltX = event.tiltX;\n    this.tiltY = event.tiltY;\n    this.pointerType = event.pointerType;\n    this.pressure = event.pressure;\n    this.rotationAngle = event.rotationAngle;\n    this.twist = event.twist || 0;\n    this.tangentialPressure = event.tangentialPressure || 0;\n  }\n\n  /**\n   * Resets the data for pooling.\n   *\n   * @private\n   */\n  _reset() {\n    // isPrimary is the only property that we really need to reset - everything else is\n    // guaranteed to be overwritten\n    this.isPrimary = false;\n  }\n}\n\nexport default InteractionData;\n","/**\n * Event class that mimics native DOM events.\n *\n * @class\n */\nclass InteractionEvent {\n  /**\n   * InteractionEvent constructor\n   */\n  constructor() {\n    /**\n     * Whether this event will continue propagating in the tree\n     *\n     * @member {boolean}\n     */\n    this.stopped = false;\n\n    /**\n     * The object which caused this event to be dispatched.\n     *\n     * @member {Object3D}\n     */\n    this.target = null;\n\n    /**\n     * The object whose event listener’s callback is currently being invoked.\n     *\n     * @member {Object3D}\n     */\n    this.currentTarget = null;\n\n    /**\n     * Type of the event\n     *\n     * @member {string}\n     */\n    this.type = null;\n\n    /**\n     * InteractionData related to this event\n     *\n     * @member {InteractionData}\n     */\n    this.data = null;\n\n    /**\n     * ray caster detial from 3d-mesh\n     *\n     * @member {Intersect}\n     */\n    this.intersect = null;\n  }\n\n  /**\n   * Prevents event from reaching any objects other than the current object.\n   *\n   */\n  stopPropagation() {\n    this.stopped = true;\n  }\n\n  /**\n   * Resets the event.\n   *\n   * @private\n   */\n  _reset() {\n    this.stopped = false;\n    this.currentTarget = null;\n    this.target = null;\n    this.intersect = null;\n  }\n}\n\nexport default InteractionEvent;\n","/**\n * DisplayObjects with the `trackedPointers` property use this class to track interactions\n *\n * @class\n * @private\n */\nexport default class InteractionTrackingData {\n  /**\n   * @param {number} pointerId - Unique pointer id of the event\n   */\n  constructor(pointerId) {\n    this._pointerId = pointerId;\n    this._flags = InteractionTrackingData.FLAGS.NONE;\n  }\n\n  /**\n   *\n   * @private\n   * @param {number} flag - The interaction flag to set\n   * @param {boolean} yn - Should the flag be set or unset\n   */\n  _doSet(flag, yn) {\n    if (yn) {\n      this._flags = this._flags | flag;\n    } else {\n      this._flags = this._flags & (~flag);\n    }\n  }\n\n  /**\n   * Unique pointer id of the event\n   *\n   * @readonly\n   * @member {number}\n   */\n  get pointerId() {\n    return this._pointerId;\n  }\n\n  /**\n   * State of the tracking data, expressed as bit flags\n   *\n   * @member {number}\n   */\n  get flags() {\n    return this._flags;\n  }\n\n  /**\n   * Set the flags for the tracking data\n   *\n   * @param {number} flags - Flags to set\n   */\n  set flags(flags) {\n    this._flags = flags;\n  }\n\n  /**\n   * Is the tracked event inactive (not over or down)?\n   *\n   * @member {number}\n   */\n  get none() {\n    return this._flags === this.constructor.FLAGS.NONE;\n  }\n\n  /**\n   * Is the tracked event over the DisplayObject?\n   *\n   * @member {boolean}\n   */\n  get over() {\n    return (this._flags & this.constructor.FLAGS.OVER) !== 0;\n  }\n\n  /**\n   * Set the over flag\n   *\n   * @param {boolean} yn - Is the event over?\n   */\n  set over(yn) {\n    this._doSet(this.constructor.FLAGS.OVER, yn);\n  }\n\n  /**\n   * Did the right mouse button come down in the DisplayObject?\n   *\n   * @member {boolean}\n   */\n  get rightDown() {\n    return (this._flags & this.constructor.FLAGS.RIGHT_DOWN) !== 0;\n  }\n\n  /**\n   * Set the right down flag\n   *\n   * @param {boolean} yn - Is the right mouse button down?\n   */\n  set rightDown(yn) {\n    this._doSet(this.constructor.FLAGS.RIGHT_DOWN, yn);\n  }\n\n  /**\n   * Did the left mouse button come down in the DisplayObject?\n   *\n   * @member {boolean}\n   */\n  get leftDown() {\n    return (this._flags & this.constructor.FLAGS.LEFT_DOWN) !== 0;\n  }\n\n  /**\n   * Set the left down flag\n   *\n   * @param {boolean} yn - Is the left mouse button down?\n   */\n  set leftDown(yn) {\n    this._doSet(this.constructor.FLAGS.LEFT_DOWN, yn);\n  }\n}\n\nInteractionTrackingData.FLAGS = Object.freeze({\n  NONE: 0,\n  OVER: 1 << 0,\n  LEFT_DOWN: 1 << 1,\n  RIGHT_DOWN: 1 << 2,\n});\n","import '../patch/EventDispatcher';\nimport '../patch/Object3D';\n\nimport { EventDispatcher, Raycaster } from 'three';\nimport InteractionData from './InteractionData';\nimport InteractionEvent from './InteractionEvent';\nimport InteractionTrackingData from './InteractionTrackingData';\n\nconst MOUSE_POINTER_ID = 'MOUSE';\n\n// helpers for hitTest() - only used inside hitTest()\nconst hitTestEvent = {\n  target: null,\n  data: {\n    global: null,\n  },\n};\n\n/**\n * The interaction manager deals with mouse, touch and pointer events. Any DisplayObject can be interactive\n * if its interactive parameter is set to true\n * This manager also supports multitouch.\n *\n * reference to [pixi.js](http://www.pixijs.com/) impl\n *\n * @private\n * @class\n * @extends EventDispatcher\n */\nclass InteractionManager extends EventDispatcher {\n  /**\n   * @param {WebGLRenderer} renderer - A reference to the current renderer\n   * @param {Scene} scene - A reference to the current scene\n   * @param {Camera} camera - A reference to the current camera\n   * @param {Object} [options] - The options for the manager.\n   * @param {Boolean} [options.autoPreventDefault=false] - Should the manager automatically prevent default browser actions.\n   * @param {Boolean} [options.autoAttach=true] - Should the manager automatically attach target element.\n   * @param {Number} [options.interactionFrequency=10] - Frequency increases the interaction events will be checked.\n   */\n  constructor(renderer, scene, camera, options) {\n    super();\n\n    options = options || {};\n\n    /**\n     * The renderer this interaction manager works for.\n     *\n     * @member {WebGLRenderer}\n     */\n    this.renderer = renderer;\n\n    /**\n     * The renderer this interaction manager works for.\n     *\n     * @member {Scene}\n     */\n    this.scene = scene;\n\n    /**\n     * The renderer this interaction manager works for.\n     *\n     * @member {Camera}\n     */\n    this.camera = camera;\n\n    /**\n     * Should default browser actions automatically be prevented.\n     * Does not apply to pointer events for backwards compatibility\n     * preventDefault on pointer events stops mouse events from firing\n     * Thus, for every pointer event, there will always be either a mouse of touch event alongside it.\n     *\n     * @member {boolean}\n     * @default false\n     */\n    this.autoPreventDefault = options.autoPreventDefault || false;\n\n    /**\n     * Frequency in milliseconds that the mousemove, moveover & mouseout interaction events will be checked.\n     *\n     * @member {number}\n     * @default 10\n     */\n    this.interactionFrequency = options.interactionFrequency || 10;\n\n    /**\n     * The mouse data\n     *\n     * @member {InteractionData}\n     */\n    this.mouse = new InteractionData();\n    this.mouse.identifier = MOUSE_POINTER_ID;\n\n    // setting the mouse to start off far off screen will mean that mouse over does\n    //  not get called before we even move the mouse.\n    this.mouse.global.set(-999999);\n\n    /**\n     * Actively tracked InteractionData\n     *\n     * @private\n     * @member {Object.<number,InteractionData>}\n     */\n    this.activeInteractionData = {};\n    this.activeInteractionData[MOUSE_POINTER_ID] = this.mouse;\n\n    /**\n     * Pool of unused InteractionData\n     *\n     * @private\n     * @member {InteractionData[]}\n     */\n    this.interactionDataPool = [];\n\n    /**\n     * An event data object to handle all the event tracking/dispatching\n     *\n     * @member {object}\n     */\n    this.eventData = new InteractionEvent();\n\n    /**\n     * The DOM element to bind to.\n     *\n     * @private\n     * @member {HTMLElement}\n     */\n    this.interactionDOMElement = null;\n\n    /**\n     * This property determines if mousemove and touchmove events are fired only when the cursor\n     * is over the object.\n     * Setting to true will make things work more in line with how the DOM verison works.\n     * Setting to false can make things easier for things like dragging\n     * It is currently set to false as this is how three.js used to work.\n     *\n     * @member {boolean}\n     * @default true\n     */\n    this.moveWhenInside = true;\n\n    /**\n     * Have events been attached to the dom element?\n     *\n     * @private\n     * @member {boolean}\n     */\n    this.eventsAdded = false;\n\n    /**\n     * Is the mouse hovering over the renderer?\n     *\n     * @private\n     * @member {boolean}\n     */\n    this.mouseOverRenderer = false;\n\n    /**\n     * Does the device support touch events\n     * https://www.w3.org/TR/touch-events/\n     *\n     * @readonly\n     * @member {boolean}\n     */\n    this.supportsTouchEvents = 'ontouchstart' in window;\n\n    /**\n     * Does the device support pointer events\n     * https://www.w3.org/Submission/pointer-events/\n     *\n     * @readonly\n     * @member {boolean}\n     */\n    this.supportsPointerEvents = !!window.PointerEvent;\n\n    // this will make it so that you don't have to call bind all the time\n\n    /**\n     * @private\n     * @member {Function}\n     */\n    this.onClick = this.onClick.bind(this);\n    this.processClick = this.processClick.bind(this);\n\n    /**\n     * @private\n     * @member {Function}\n     */\n    this.onPointerUp = this.onPointerUp.bind(this);\n    this.processPointerUp = this.processPointerUp.bind(this);\n\n    /**\n     * @private\n     * @member {Function}\n     */\n    this.onPointerCancel = this.onPointerCancel.bind(this);\n    this.processPointerCancel = this.processPointerCancel.bind(this);\n\n    /**\n     * @private\n     * @member {Function}\n     */\n    this.onPointerDown = this.onPointerDown.bind(this);\n    this.processPointerDown = this.processPointerDown.bind(this);\n\n    /**\n     * @private\n     * @member {Function}\n     */\n    this.onPointerMove = this.onPointerMove.bind(this);\n    this.processPointerMove = this.processPointerMove.bind(this);\n\n    /**\n     * @private\n     * @member {Function}\n     */\n    this.onPointerOut = this.onPointerOut.bind(this);\n    this.processPointerOverOut = this.processPointerOverOut.bind(this);\n\n    /**\n     * @private\n     * @member {Function}\n     */\n    this.onPointerOver = this.onPointerOver.bind(this);\n\n    /**\n     * Dictionary of how different cursor modes are handled. Strings are handled as CSS cursor\n     * values, objects are handled as dictionaries of CSS values for interactionDOMElement,\n     * and functions are called instead of changing the CSS.\n     * Default CSS cursor values are provided for 'default' and 'pointer' modes.\n     * @member {Object.<string, (string|Function|Object.<string, string>)>}\n     */\n    this.cursorStyles = {\n      default: 'inherit',\n      pointer: 'pointer',\n    };\n\n    /**\n     * The mode of the cursor that is being used.\n     * The value of this is a key from the cursorStyles dictionary.\n     *\n     * @member {string}\n     */\n    this.currentCursorMode = null;\n\n    /**\n     * Internal cached let.\n     *\n     * @private\n     * @member {string}\n     */\n    this.cursor = null;\n\n    /**\n     * ray caster, for survey intersects from 3d-scene\n     *\n     * @private\n     * @member {Raycaster}\n     */\n    this.raycaster = new Raycaster();\n\n    /**\n     * snippet time\n     *\n     * @private\n     * @member {Number}\n     */\n    this._deltaTime = 0;\n\n    this.setTargetElement(this.renderer.domElement);\n\n    /**\n     * Fired when a pointer device button (usually a mouse left-button) is pressed on the display\n     * object.\n     *\n     * @event InteractionManager#mousedown\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device secondary button (usually a mouse right-button) is pressed\n     * on the display object.\n     *\n     * @event InteractionManager#rightdown\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button (usually a mouse left-button) is released over the display\n     * object.\n     *\n     * @event InteractionManager#mouseup\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device secondary button (usually a mouse right-button) is released\n     * over the display object.\n     *\n     * @event InteractionManager#rightup\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button (usually a mouse left-button) is pressed and released on\n     * the display object.\n     *\n     * @event InteractionManager#click\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device secondary button (usually a mouse right-button) is pressed\n     * and released on the display object.\n     *\n     * @event InteractionManager#rightclick\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button (usually a mouse left-button) is released outside the\n     * display object that initially registered a\n     * [mousedown]{@link InteractionManager#event:mousedown}.\n     *\n     * @event InteractionManager#mouseupoutside\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device secondary button (usually a mouse right-button) is released\n     * outside the display object that initially registered a\n     * [rightdown]{@link InteractionManager#event:rightdown}.\n     *\n     * @event InteractionManager#rightupoutside\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device (usually a mouse) is moved while over the display object\n     *\n     * @event InteractionManager#mousemove\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device (usually a mouse) is moved onto the display object\n     *\n     * @event InteractionManager#mouseover\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device (usually a mouse) is moved off the display object\n     *\n     * @event InteractionManager#mouseout\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button is pressed on the display object.\n     *\n     * @event InteractionManager#pointerdown\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button is released over the display object.\n     *\n     * @event InteractionManager#pointerup\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when the operating system cancels a pointer event\n     *\n     * @event InteractionManager#pointercancel\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button is pressed and released on the display object.\n     *\n     * @event InteractionManager#pointertap\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button is released outside the display object that initially\n     * registered a [pointerdown]{@link InteractionManager#event:pointerdown}.\n     *\n     * @event InteractionManager#pointerupoutside\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device is moved while over the display object\n     *\n     * @event InteractionManager#pointermove\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device is moved onto the display object\n     *\n     * @event InteractionManager#pointerover\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device is moved off the display object\n     *\n     * @event InteractionManager#pointerout\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a touch point is placed on the display object.\n     *\n     * @event InteractionManager#touchstart\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a touch point is removed from the display object.\n     *\n     * @event InteractionManager#touchend\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when the operating system cancels a touch\n     *\n     * @event InteractionManager#touchcancel\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a touch point is placed and removed from the display object.\n     *\n     * @event InteractionManager#tap\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a touch point is removed outside of the display object that initially\n     * registered a [touchstart]{@link InteractionManager#event:touchstart}.\n     *\n     * @event InteractionManager#touchendoutside\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a touch point is moved along the display object.\n     *\n     * @event InteractionManager#touchmove\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button (usually a mouse left-button) is pressed on the display.\n     * object. DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#mousedown\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device secondary button (usually a mouse right-button) is pressed\n     * on the display object. DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#rightdown\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button (usually a mouse left-button) is released over the display\n     * object. DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#mouseup\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device secondary button (usually a mouse right-button) is released\n     * over the display object. DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#rightup\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button (usually a mouse left-button) is pressed and released on\n     * the display object. DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#click\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device secondary button (usually a mouse right-button) is pressed\n     * and released on the display object. DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#rightclick\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button (usually a mouse left-button) is released outside the\n     * display object that initially registered a\n     * [mousedown]{@link Object3D#event:mousedown}.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#mouseupoutside\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device secondary button (usually a mouse right-button) is released\n     * outside the display object that initially registered a\n     * [rightdown]{@link Object3D#event:rightdown}.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#rightupoutside\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device (usually a mouse) is moved while over the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#mousemove\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device (usually a mouse) is moved onto the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#mouseover\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device (usually a mouse) is moved off the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#mouseout\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button is pressed on the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#pointerdown\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button is released over the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#pointerup\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when the operating system cancels a pointer event.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#pointercancel\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button is pressed and released on the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#pointertap\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button is released outside the display object that initially\n     * registered a [pointerdown]{@link Object3D#event:pointerdown}.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#pointerupoutside\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device is moved while over the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#pointermove\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device is moved onto the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#pointerover\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device is moved off the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#pointerout\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a touch point is placed on the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#touchstart\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a touch point is removed from the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#touchend\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when the operating system cancels a touch.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#touchcancel\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a touch point is placed and removed from the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#tap\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a touch point is removed outside of the display object that initially\n     * registered a [touchstart]{@link Object3D#event:touchstart}.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#touchendoutside\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a touch point is moved along the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#touchmove\n     * @param {InteractionEvent} event - Interaction event\n     */\n  }\n\n  /**\n   * Hit tests a point against the display tree, returning the first interactive object that is hit.\n   *\n   * @param {Point} globalPoint - A point to hit test with, in global space.\n   * @param {Object3D} [root] - The root display object to start from. If omitted, defaults\n   * to the last rendered root of the associated renderer.\n   * @return {Object3D} The hit display object, if any.\n   */\n  hitTest(globalPoint, root) {\n    // clear the target for our hit test\n    hitTestEvent.target = null;\n    // assign the global point\n    hitTestEvent.data.global = globalPoint;\n    // ensure safety of the root\n    if (!root) {\n      root = this.scene;\n    }\n    // run the hit test\n    this.processInteractive(hitTestEvent, root, null, true);\n    // return our found object - it'll be null if we didn't hit anything\n\n    return hitTestEvent.target;\n  }\n\n  /**\n   * Sets the DOM element which will receive mouse/touch events. This is useful for when you have\n   * other DOM elements on top of the renderers Canvas element. With this you'll be bale to deletegate\n   * another DOM element to receive those events.\n   *\n   * @param {HTMLCanvasElement} element - the DOM element which will receive mouse and touch events.\n   */\n  setTargetElement(element) {\n    this.removeEvents();\n\n    this.interactionDOMElement = element;\n\n    this.addEvents();\n  }\n\n  /**\n   * Registers all the DOM events\n   *\n   * @private\n   */\n  addEvents() {\n    if (!this.interactionDOMElement || this.eventsAdded) {\n      return;\n    }\n\n    this.emit('addevents');\n\n    this.interactionDOMElement.addEventListener('click', this.onClick, true);\n\n    if (window.navigator.msPointerEnabled) {\n      this.interactionDOMElement.style['-ms-content-zooming'] = 'none';\n      this.interactionDOMElement.style['-ms-touch-action'] = 'none';\n    } else if (this.supportsPointerEvents) {\n      this.interactionDOMElement.style['touch-action'] = 'none';\n    }\n\n    /**\n     * These events are added first, so that if pointer events are normalised, they are fired\n     * in the same order as non-normalised events. ie. pointer event 1st, mouse / touch 2nd\n     */\n    if (this.supportsPointerEvents) {\n      window.document.addEventListener('pointermove', this.onPointerMove, true);\n      this.interactionDOMElement.addEventListener('pointerdown', this.onPointerDown, true);\n      // pointerout is fired in addition to pointerup (for touch events) and pointercancel\n      // we already handle those, so for the purposes of what we do in onPointerOut, we only\n      // care about the pointerleave event\n      this.interactionDOMElement.addEventListener('pointerleave', this.onPointerOut, true);\n      this.interactionDOMElement.addEventListener('pointerover', this.onPointerOver, true);\n      window.addEventListener('pointercancel', this.onPointerCancel, true);\n      window.addEventListener('pointerup', this.onPointerUp, true);\n    } else {\n      window.document.addEventListener('mousemove', this.onPointerMove, true);\n      this.interactionDOMElement.addEventListener('mousedown', this.onPointerDown, true);\n      this.interactionDOMElement.addEventListener('mouseout', this.onPointerOut, true);\n      this.interactionDOMElement.addEventListener('mouseover', this.onPointerOver, true);\n      window.addEventListener('mouseup', this.onPointerUp, true);\n    }\n\n    // always look directly for touch events so that we can provide original data\n    // In a future version we should change this to being just a fallback and rely solely on\n    // PointerEvents whenever available\n    if (this.supportsTouchEvents) {\n      this.interactionDOMElement.addEventListener('touchstart', this.onPointerDown, true);\n      this.interactionDOMElement.addEventListener('touchcancel', this.onPointerCancel, true);\n      this.interactionDOMElement.addEventListener('touchend', this.onPointerUp, true);\n      this.interactionDOMElement.addEventListener('touchmove', this.onPointerMove, true);\n    }\n\n    this.eventsAdded = true;\n  }\n\n  /**\n   * Removes all the DOM events that were previously registered\n   *\n   * @private\n   */\n  removeEvents() {\n    if (!this.interactionDOMElement) {\n      return;\n    }\n\n    this.emit('removeevents');\n\n    this.interactionDOMElement.removeEventListener('click', this.onClick, true);\n\n    if (window.navigator.msPointerEnabled) {\n      this.interactionDOMElement.style['-ms-content-zooming'] = '';\n      this.interactionDOMElement.style['-ms-touch-action'] = '';\n    } else if (this.supportsPointerEvents) {\n      this.interactionDOMElement.style['touch-action'] = '';\n    }\n\n    if (this.supportsPointerEvents) {\n      window.document.removeEventListener('pointermove', this.onPointerMove, true);\n      this.interactionDOMElement.removeEventListener('pointerdown', this.onPointerDown, true);\n      this.interactionDOMElement.removeEventListener('pointerleave', this.onPointerOut, true);\n      this.interactionDOMElement.removeEventListener('pointerover', this.onPointerOver, true);\n      window.removeEventListener('pointercancel', this.onPointerCancel, true);\n      window.removeEventListener('pointerup', this.onPointerUp, true);\n    } else {\n      window.document.removeEventListener('mousemove', this.onPointerMove, true);\n      this.interactionDOMElement.removeEventListener('mousedown', this.onPointerDown, true);\n      this.interactionDOMElement.removeEventListener('mouseout', this.onPointerOut, true);\n      this.interactionDOMElement.removeEventListener('mouseover', this.onPointerOver, true);\n      window.removeEventListener('mouseup', this.onPointerUp, true);\n    }\n\n    if (this.supportsTouchEvents) {\n      this.interactionDOMElement.removeEventListener('touchstart', this.onPointerDown, true);\n      this.interactionDOMElement.removeEventListener('touchcancel', this.onPointerCancel, true);\n      this.interactionDOMElement.removeEventListener('touchend', this.onPointerUp, true);\n      this.interactionDOMElement.removeEventListener('touchmove', this.onPointerMove, true);\n    }\n\n    this.interactionDOMElement = null;\n\n    this.eventsAdded = false;\n  }\n\n  /**\n   * Updates the state of interactive objects.\n   * Invoked by a throttled ticker.\n   *\n   * @param {number} deltaTime - time delta since last tick\n   */\n  update({ snippet }) {\n    this._deltaTime += snippet;\n\n    if (this._deltaTime < this.interactionFrequency) {\n      return;\n    }\n\n    this._deltaTime = 0;\n\n    if (!this.interactionDOMElement) {\n      return;\n    }\n\n    // if the user move the mouse this check has already been done using the mouse move!\n    if (this.didMove) {\n      this.didMove = false;\n\n      return;\n    }\n\n    this.cursor = null;\n\n    // Resets the flag as set by a stopPropagation call. This flag is usually reset by a user interaction of any kind,\n    // but there was a scenario of a display object moving under a static mouse cursor.\n    // In this case, mouseover and mouseevents would not pass the flag test in triggerEvent function\n    for (const k in this.activeInteractionData) {\n      // eslint-disable-next-line no-prototype-builtins\n      if (this.activeInteractionData.hasOwnProperty(k)) {\n        const interactionData = this.activeInteractionData[k];\n\n        if (interactionData.originalEvent && interactionData.pointerType !== 'touch') {\n          const interactionEvent = this.configureInteractionEventForDOMEvent(\n            this.eventData,\n            interactionData.originalEvent,\n            interactionData\n          );\n\n          this.processInteractive(\n            interactionEvent,\n            this.scene,\n            this.processPointerOverOut,\n            true\n          );\n        }\n      }\n    }\n\n    this.setCursorMode(this.cursor);\n\n    // TODO\n  }\n\n  /**\n   * Sets the current cursor mode, handling any callbacks or CSS style changes.\n   *\n   * @param {string} mode - cursor mode, a key from the cursorStyles dictionary\n   */\n  setCursorMode(mode) {\n    mode = mode || 'default';\n    // if the mode didn't actually change, bail early\n    if (this.currentCursorMode === mode) {\n      return;\n    }\n    this.currentCursorMode = mode;\n    const style = this.cursorStyles[mode];\n\n    // only do things if there is a cursor style for it\n    if (style) {\n      switch (typeof style) {\n        case 'string':\n          // string styles are handled as cursor CSS\n          this.interactionDOMElement.style.cursor = style;\n          break;\n        case 'function':\n          // functions are just called, and passed the cursor mode\n          style(mode);\n          break;\n        case 'object':\n          // if it is an object, assume that it is a dictionary of CSS styles,\n          // apply it to the interactionDOMElement\n          Object.assign(this.interactionDOMElement.style, style);\n          break;\n        default:\n          break;\n      }\n    } else if (typeof mode === 'string' && !Object.prototype.hasOwnProperty.call(this.cursorStyles, mode)) {\n      // if it mode is a string (not a Symbol) and cursorStyles doesn't have any entry\n      // for the mode, then assume that the dev wants it to be CSS for the cursor.\n      this.interactionDOMElement.style.cursor = mode;\n    }\n  }\n\n  /**\n   * Dispatches an event on the display object that was interacted with\n   *\n   * @param {Object3D} displayObject - the display object in question\n   * @param {string} eventString - the name of the event (e.g, mousedown)\n   * @param {object} eventData - the event data object\n   * @private\n   */\n  triggerEvent(displayObject, eventString, eventData) {\n    if (!eventData.stopped) {\n      eventData.currentTarget = displayObject;\n      eventData.type = eventString;\n\n      displayObject.emit(eventString, eventData);\n\n      if (displayObject[eventString]) {\n        displayObject[eventString](eventData);\n      }\n    }\n  }\n\n  /**\n   * Maps x and y coords from a DOM object and maps them correctly to the three.js view. The\n   * resulting value is stored in the point. This takes into account the fact that the DOM\n   * element could be scaled and positioned anywhere on the screen.\n   *\n   * @param  {Vector2} point - the point that the result will be stored in\n   * @param  {number} x - the x coord of the position to map\n   * @param  {number} y - the y coord of the position to map\n   */\n  mapPositionToPoint(point, x, y) {\n    let rect;\n\n    // IE 11 fix\n    if (!this.interactionDOMElement.parentElement) {\n      rect = {\n        x: 0,\n        y: 0,\n        left: 0,\n        top: 0,\n        width: 0,\n        height: 0,\n      };\n    } else {\n      rect = this.interactionDOMElement.getBoundingClientRect();\n    }\n\n    point.x = ((x - rect.left) / rect.width) * 2 - 1;\n    point.y = -((y - rect.top) / rect.height) * 2 + 1;\n  }\n\n  /**\n   * This function is provides a neat way of crawling through the scene graph and running a\n   * specified function on all interactive objects it finds. It will also take care of hit\n   * testing the interactive objects and passes the hit across in the function.\n   *\n   * @private\n   * @param {InteractionEvent} interactionEvent - event containing the point that\n   *  is tested for collision\n   * @param {Object3D} displayObject - the displayObject\n   *  that will be hit test (recursively crawls its children)\n   * @param {Function} [func] - the function that will be called on each interactive object. The\n   *  interactionEvent, displayObject and hit will be passed to the function\n   * @param {boolean} [hitTest] - this indicates if the objects inside should be hit test against the point\n   * @param {boolean} [interactive] - Whether the displayObject is interactive\n   * @return {boolean} returns true if the displayObject hit the point\n   */\n  processInteractive(interactionEvent, displayObject, func, hitTest, interactive) {\n    if (!displayObject || !displayObject.visible) {\n      return false;\n    }\n\n    // Took a little while to rework this function correctly! But now it is done and nice and optimised. ^_^\n    //\n    // This function will now loop through all objects and then only hit test the objects it HAS\n    // to, not all of them. MUCH faster..\n    // An object will be hit test if the following is true:\n    //\n    // 1: It is interactive.\n    // 2: It belongs to a parent that is interactive AND one of the parents children have not already been hit.\n    //\n    // As another little optimisation once an interactive object has been hit we can carry on\n    // through the scenegraph, but we know that there will be no more hits! So we can avoid extra hit tests\n    // A final optimisation is that an object is not hit test directly if a child has already been hit.\n\n    interactive = displayObject.interactive || interactive;\n\n    let hit = false;\n    let interactiveParent = interactive;\n\n    if (displayObject.interactiveChildren && displayObject.children) {\n      const children = displayObject.children;\n\n      for (let i = children.length - 1; i >= 0; i--) {\n        const child = children[i];\n\n        // time to get recursive.. if this function will return if something is hit..\n        const childHit = this.processInteractive(interactionEvent, child, func, hitTest, interactiveParent);\n\n        if (childHit) {\n          // its a good idea to check if a child has lost its parent.\n          // this means it has been removed whilst looping so its best\n          if (!child.parent) {\n            continue;\n          }\n\n          // we no longer need to hit test any more objects in this container as we we\n          // now know the parent has been hit\n          interactiveParent = false;\n\n          // If the child is interactive , that means that the object hit was actually\n          // interactive and not just the child of an interactive object.\n          // This means we no longer need to hit test anything else. We still need to run\n          // through all objects, but we don't need to perform any hit tests.\n\n          if (childHit) {\n            if (interactionEvent.target) {\n              hitTest = false;\n            }\n            hit = true;\n          }\n        }\n      }\n    }\n\n    // no point running this if the item is not interactive or does not have an interactive parent.\n    if (interactive) {\n      // if we are hit testing (as in we have no hit any objects yet)\n      // We also don't need to worry about hit testing if once of the displayObjects children\n      // has already been hit - but only if it was interactive, otherwise we need to keep\n      // looking for an interactive child, just in case we hit one\n      if (hitTest && !interactionEvent.target) {\n        const intersect = displayObject.raycastTest(this.raycaster);\n        if (intersect) {\n          interactionEvent.intersect = intersect;\n          hit = true;\n        }\n      }\n\n      if (displayObject.interactive) {\n        if (hit && !interactionEvent.target) {\n          interactionEvent.data.target = interactionEvent.target = displayObject;\n        }\n\n        if (func) {\n          func(interactionEvent, displayObject, !!hit);\n        }\n      }\n    }\n\n    return hit;\n  }\n\n\n  /**\n   * Is called when the click is pressed down on the renderer element\n   *\n   * @private\n   * @param {MouseEvent} originalEvent - The DOM event of a click being pressed down\n   */\n  onClick(originalEvent) {\n    if (originalEvent.type !== 'click') return;\n\n    const events = this.normalizeToPointerData(originalEvent);\n\n    if (this.autoPreventDefault && events[0].isNormalized) {\n      originalEvent.preventDefault();\n    }\n\n    const interactionData = this.getInteractionDataForPointerId(events[0]);\n\n    const interactionEvent = this.configureInteractionEventForDOMEvent(this.eventData, event, interactionData);\n\n    interactionEvent.data.originalEvent = originalEvent;\n\n    this.processInteractive(interactionEvent, this.scene, this.processClick, true);\n\n    this.emit('click', interactionEvent);\n  }\n\n  /**\n   * Processes the result of the click check and dispatches the event if need be\n   *\n   * @private\n   * @param {InteractionEvent} interactionEvent - The interaction event wrapping the DOM event\n   * @param {Object3D} displayObject - The display object that was tested\n   * @param {boolean} hit - the result of the hit test on the display object\n   */\n  processClick(interactionEvent, displayObject, hit) {\n    if (hit) {\n      this.triggerEvent(displayObject, 'click', interactionEvent);\n    }\n  }\n\n  /**\n   * Is called when the pointer button is pressed down on the renderer element\n   *\n   * @private\n   * @param {PointerEvent} originalEvent - The DOM event of a pointer button being pressed down\n   */\n  onPointerDown(originalEvent) {\n    // if we support touch events, then only use those for touch events, not pointer events\n    if (this.supportsTouchEvents && originalEvent.pointerType === 'touch') return;\n\n    const events = this.normalizeToPointerData(originalEvent);\n\n    /**\n     * No need to prevent default on natural pointer events, as there are no side effects\n     * Normalized events, however, may have the double mousedown/touchstart issue on the native android browser,\n     * so still need to be prevented.\n     */\n\n    // Guaranteed that there will be at least one event in events, and all events must have the same pointer type\n\n    if (this.autoPreventDefault && events[0].isNormalized) {\n      originalEvent.preventDefault();\n    }\n\n    const eventLen = events.length;\n\n    for (let i = 0; i < eventLen; i++) {\n      const event = events[i];\n\n      const interactionData = this.getInteractionDataForPointerId(event);\n\n      const interactionEvent = this.configureInteractionEventForDOMEvent(this.eventData, event, interactionData);\n\n      interactionEvent.data.originalEvent = originalEvent;\n\n      this.processInteractive(interactionEvent, this.scene, this.processPointerDown, true);\n\n      this.emit('pointerdown', interactionEvent);\n      if (event.pointerType === 'touch') {\n        this.emit('touchstart', interactionEvent);\n      } else if (event.pointerType === 'mouse' || event.pointerType === 'pen') {\n        const isRightButton = event.button === 2;\n\n        this.emit(isRightButton ? 'rightdown' : 'mousedown', this.eventData);\n      }\n    }\n  }\n\n  /**\n   * Processes the result of the pointer down check and dispatches the event if need be\n   *\n   * @private\n   * @param {InteractionEvent} interactionEvent - The interaction event wrapping the DOM event\n   * @param {Object3D} displayObject - The display object that was tested\n   * @param {boolean} hit - the result of the hit test on the display object\n   */\n  processPointerDown(interactionEvent, displayObject, hit) {\n    const data = interactionEvent.data;\n    const id = interactionEvent.data.identifier;\n\n    if (hit) {\n      if (!displayObject.trackedPointers[id]) {\n        displayObject.trackedPointers[id] = new InteractionTrackingData(id);\n      }\n      this.triggerEvent(displayObject, 'pointerdown', interactionEvent);\n\n      if (data.pointerType === 'touch') {\n        displayObject.started = true;\n        this.triggerEvent(displayObject, 'touchstart', interactionEvent);\n      } else if (data.pointerType === 'mouse' || data.pointerType === 'pen') {\n        const isRightButton = data.button === 2;\n\n        if (isRightButton) {\n          displayObject.trackedPointers[id].rightDown = true;\n        } else {\n          displayObject.trackedPointers[id].leftDown = true;\n        }\n\n        this.triggerEvent(displayObject, isRightButton ? 'rightdown' : 'mousedown', interactionEvent);\n      }\n    }\n  }\n\n  /**\n   * Is called when the pointer button is released on the renderer element\n   *\n   * @private\n   * @param {PointerEvent} originalEvent - The DOM event of a pointer button being released\n   * @param {boolean} cancelled - true if the pointer is cancelled\n   * @param {Function} func - Function passed to {@link processInteractive}\n   */\n  onPointerComplete(originalEvent, cancelled, func) {\n    const events = this.normalizeToPointerData(originalEvent);\n\n    const eventLen = events.length;\n\n    // if the event wasn't targeting our canvas, then consider it to be pointerupoutside\n    // in all cases (unless it was a pointercancel)\n    const eventAppend = originalEvent.target !== this.interactionDOMElement ? 'outside' : '';\n\n    for (let i = 0; i < eventLen; i++) {\n      const event = events[i];\n\n      const interactionData = this.getInteractionDataForPointerId(event);\n\n      const interactionEvent = this.configureInteractionEventForDOMEvent(this.eventData, event, interactionData);\n\n      interactionEvent.data.originalEvent = originalEvent;\n\n      // perform hit testing for events targeting our canvas or cancel events\n      this.processInteractive(interactionEvent, this.scene, func, cancelled || !eventAppend);\n\n      this.emit(cancelled ? 'pointercancel' : `pointerup${eventAppend}`, interactionEvent);\n\n      if (event.pointerType === 'mouse' || event.pointerType === 'pen') {\n        const isRightButton = event.button === 2;\n\n        this.emit(isRightButton ? `rightup${eventAppend}` : `mouseup${eventAppend}`, interactionEvent);\n      } else if (event.pointerType === 'touch') {\n        this.emit(cancelled ? 'touchcancel' : `touchend${eventAppend}`, interactionEvent);\n        this.releaseInteractionDataForPointerId(event.pointerId, interactionData);\n      }\n    }\n  }\n\n  /**\n   * Is called when the pointer button is cancelled\n   *\n   * @private\n   * @param {PointerEvent} event - The DOM event of a pointer button being released\n   */\n  onPointerCancel(event) {\n    // if we support touch events, then only use those for touch events, not pointer events\n    if (this.supportsTouchEvents && event.pointerType === 'touch') return;\n\n    this.onPointerComplete(event, true, this.processPointerCancel);\n  }\n\n  /**\n   * Processes the result of the pointer cancel check and dispatches the event if need be\n   *\n   * @private\n   * @param {InteractionEvent} interactionEvent - The interaction event wrapping the DOM event\n   * @param {Object3D} displayObject - The display object that was tested\n   */\n  processPointerCancel(interactionEvent, displayObject) {\n    const data = interactionEvent.data;\n\n    const id = interactionEvent.data.identifier;\n\n    if (displayObject.trackedPointers[id] !== undefined) {\n      delete displayObject.trackedPointers[id];\n      this.triggerEvent(displayObject, 'pointercancel', interactionEvent);\n\n      if (data.pointerType === 'touch') {\n        this.triggerEvent(displayObject, 'touchcancel', interactionEvent);\n      }\n    }\n  }\n\n  /**\n   * Is called when the pointer button is released on the renderer element\n   *\n   * @private\n   * @param {PointerEvent} event - The DOM event of a pointer button being released\n   */\n  onPointerUp(event) {\n    // if we support touch events, then only use those for touch events, not pointer events\n    if (this.supportsTouchEvents && event.pointerType === 'touch') return;\n\n    this.onPointerComplete(event, false, this.processPointerUp);\n  }\n\n  /**\n   * Processes the result of the pointer up check and dispatches the event if need be\n   *\n   * @private\n   * @param {InteractionEvent} interactionEvent - The interaction event wrapping the DOM event\n   * @param {Object3D} displayObject - The display object that was tested\n   * @param {boolean} hit - the result of the hit test on the display object\n   */\n  processPointerUp(interactionEvent, displayObject, hit) {\n    const data = interactionEvent.data;\n\n    const id = interactionEvent.data.identifier;\n\n    const trackingData = displayObject.trackedPointers[id];\n\n    const isTouch = data.pointerType === 'touch';\n\n    const isMouse = (data.pointerType === 'mouse' || data.pointerType === 'pen');\n\n    // Mouse only\n    if (isMouse) {\n      const isRightButton = data.button === 2;\n\n      const flags = InteractionTrackingData.FLAGS;\n\n      const test = isRightButton ? flags.RIGHT_DOWN : flags.LEFT_DOWN;\n\n      const isDown = trackingData !== undefined && (trackingData.flags & test);\n\n      if (hit) {\n        this.triggerEvent(displayObject, isRightButton ? 'rightup' : 'mouseup', interactionEvent);\n\n        if (isDown) {\n          this.triggerEvent(displayObject, isRightButton ? 'rightclick' : 'leftclick', interactionEvent);\n        }\n      } else if (isDown) {\n        this.triggerEvent(displayObject, isRightButton ? 'rightupoutside' : 'mouseupoutside', interactionEvent);\n      }\n      // update the down state of the tracking data\n      if (trackingData) {\n        if (isRightButton) {\n          trackingData.rightDown = false;\n        } else {\n          trackingData.leftDown = false;\n        }\n      }\n    }\n\n    // Pointers and Touches, and Mouse\n    if (isTouch && displayObject.started) {\n      displayObject.started = false;\n      this.triggerEvent(displayObject, 'touchend', interactionEvent);\n    }\n    if (hit) {\n      this.triggerEvent(displayObject, 'pointerup', interactionEvent);\n\n      if (trackingData) {\n        this.triggerEvent(displayObject, 'pointertap', interactionEvent);\n        if (isTouch) {\n          this.triggerEvent(displayObject, 'tap', interactionEvent);\n          // touches are no longer over (if they ever were) when we get the touchend\n          // so we should ensure that we don't keep pretending that they are\n          trackingData.over = false;\n        }\n      }\n    } else if (trackingData) {\n      this.triggerEvent(displayObject, 'pointerupoutside', interactionEvent);\n      if (isTouch) this.triggerEvent(displayObject, 'touchendoutside', interactionEvent);\n    }\n    // Only remove the tracking data if there is no over/down state still associated with it\n    if (trackingData && trackingData.none) {\n      delete displayObject.trackedPointers[id];\n    }\n  }\n\n  /**\n   * Is called when the pointer moves across the renderer element\n   *\n   * @private\n   * @param {PointerEvent} originalEvent - The DOM event of a pointer moving\n   */\n  onPointerMove(originalEvent) {\n    // if we support touch events, then only use those for touch events, not pointer events\n    if (this.supportsTouchEvents && originalEvent.pointerType === 'touch') return;\n\n    const events = this.normalizeToPointerData(originalEvent);\n\n    if (events[0].pointerType === 'mouse') {\n      this.didMove = true;\n\n      this.cursor = null;\n    }\n\n    const eventLen = events.length;\n\n    for (let i = 0; i < eventLen; i++) {\n      const event = events[i];\n\n      const interactionData = this.getInteractionDataForPointerId(event);\n\n      const interactionEvent = this.configureInteractionEventForDOMEvent(this.eventData, event, interactionData);\n\n      interactionEvent.data.originalEvent = originalEvent;\n\n      const interactive = event.pointerType === 'touch' ? this.moveWhenInside : true;\n\n      this.processInteractive(\n        interactionEvent,\n        this.scene,\n        this.processPointerMove,\n        interactive\n      );\n      this.emit('pointermove', interactionEvent);\n      if (event.pointerType === 'touch') this.emit('touchmove', interactionEvent);\n      if (event.pointerType === 'mouse' || event.pointerType === 'pen') this.emit('mousemove', interactionEvent);\n    }\n\n    if (events[0].pointerType === 'mouse') {\n      this.setCursorMode(this.cursor);\n\n      // TODO BUG for parents interactive object (border order issue)\n    }\n  }\n\n  /**\n   * Processes the result of the pointer move check and dispatches the event if need be\n   *\n   * @private\n   * @param {InteractionEvent} interactionEvent - The interaction event wrapping the DOM event\n   * @param {Object3D} displayObject - The display object that was tested\n   * @param {boolean} hit - the result of the hit test on the display object\n   */\n  processPointerMove(interactionEvent, displayObject, hit) {\n    const data = interactionEvent.data;\n\n    const isTouch = data.pointerType === 'touch';\n\n    const isMouse = (data.pointerType === 'mouse' || data.pointerType === 'pen');\n\n    if (isMouse) {\n      this.processPointerOverOut(interactionEvent, displayObject, hit);\n    }\n\n    if (isTouch && displayObject.started) this.triggerEvent(displayObject, 'touchmove', interactionEvent);\n    if (!this.moveWhenInside || hit) {\n      this.triggerEvent(displayObject, 'pointermove', interactionEvent);\n      if (isMouse) this.triggerEvent(displayObject, 'mousemove', interactionEvent);\n    }\n  }\n\n  /**\n   * Is called when the pointer is moved out of the renderer element\n   *\n   * @private\n   * @param {PointerEvent} originalEvent - The DOM event of a pointer being moved out\n   */\n  onPointerOut(originalEvent) {\n    // if we support touch events, then only use those for touch events, not pointer events\n    if (this.supportsTouchEvents && originalEvent.pointerType === 'touch') return;\n\n    const events = this.normalizeToPointerData(originalEvent);\n\n    // Only mouse and pointer can call onPointerOut, so events will always be length 1\n    const event = events[0];\n\n    if (event.pointerType === 'mouse') {\n      this.mouseOverRenderer = false;\n      this.setCursorMode(null);\n    }\n\n    const interactionData = this.getInteractionDataForPointerId(event);\n\n    const interactionEvent = this.configureInteractionEventForDOMEvent(this.eventData, event, interactionData);\n\n    interactionEvent.data.originalEvent = event;\n\n    this.processInteractive(interactionEvent, this.scene, this.processPointerOverOut, false);\n\n    this.emit('pointerout', interactionEvent);\n    if (event.pointerType === 'mouse' || event.pointerType === 'pen') {\n      this.emit('mouseout', interactionEvent);\n    } else {\n      // we can get touchleave events after touchend, so we want to make sure we don't\n      // introduce memory leaks\n      this.releaseInteractionDataForPointerId(interactionData.identifier);\n    }\n  }\n\n  /**\n   * Processes the result of the pointer over/out check and dispatches the event if need be\n   *\n   * @private\n   * @param {InteractionEvent} interactionEvent - The interaction event wrapping the DOM event\n   * @param {Object3D} displayObject - The display object that was tested\n   * @param {boolean} hit - the result of the hit test on the display object\n   */\n  processPointerOverOut(interactionEvent, displayObject, hit) {\n    const data = interactionEvent.data;\n\n    const id = interactionEvent.data.identifier;\n\n    const isMouse = (data.pointerType === 'mouse' || data.pointerType === 'pen');\n\n    let trackingData = displayObject.trackedPointers[id];\n\n    // if we just moused over the display object, then we need to track that state\n    if (hit && !trackingData) {\n      trackingData = displayObject.trackedPointers[id] = new InteractionTrackingData(id);\n    }\n\n    if (trackingData === undefined) return;\n\n    if (hit && this.mouseOverRenderer) {\n      if (!trackingData.over) {\n        trackingData.over = true;\n        this.triggerEvent(displayObject, 'pointerover', interactionEvent);\n        if (isMouse) {\n          this.triggerEvent(displayObject, 'mouseover', interactionEvent);\n        }\n      }\n\n      // only change the cursor if it has not already been changed (by something deeper in the\n      // display tree)\n      if (isMouse && this.cursor === null) {\n        this.cursor = displayObject.cursor;\n      }\n    } else if (trackingData.over) {\n      trackingData.over = false;\n      this.triggerEvent(displayObject, 'pointerout', this.eventData);\n      if (isMouse) {\n        this.triggerEvent(displayObject, 'mouseout', interactionEvent);\n      }\n      // if there is no mouse down information for the pointer, then it is safe to delete\n      if (trackingData.none) {\n        delete displayObject.trackedPointers[id];\n      }\n    }\n  }\n\n  /**\n   * Is called when the pointer is moved into the renderer element\n   *\n   * @private\n   * @param {PointerEvent} originalEvent - The DOM event of a pointer button being moved into the renderer view\n   */\n  onPointerOver(originalEvent) {\n    const events = this.normalizeToPointerData(originalEvent);\n\n    // Only mouse and pointer can call onPointerOver, so events will always be length 1\n    const event = events[0];\n\n    const interactionData = this.getInteractionDataForPointerId(event);\n\n    const interactionEvent = this.configureInteractionEventForDOMEvent(this.eventData, event, interactionData);\n\n    interactionEvent.data.originalEvent = event;\n\n    if (event.pointerType === 'mouse') {\n      this.mouseOverRenderer = true;\n    }\n\n    this.emit('pointerover', interactionEvent);\n    if (event.pointerType === 'mouse' || event.pointerType === 'pen') {\n      this.emit('mouseover', interactionEvent);\n    }\n  }\n\n  /**\n   * Get InteractionData for a given pointerId. Store that data as well\n   *\n   * @private\n   * @param {PointerEvent} event - Normalized pointer event, output from normalizeToPointerData\n   * @return {InteractionData} - Interaction data for the given pointer identifier\n   */\n  getInteractionDataForPointerId(event) {\n    const pointerId = event.pointerId;\n\n    let interactionData;\n\n    if (pointerId === MOUSE_POINTER_ID || event.pointerType === 'mouse') {\n      interactionData = this.mouse;\n    } else if (this.activeInteractionData[pointerId]) {\n      interactionData = this.activeInteractionData[pointerId];\n    } else {\n      interactionData = this.interactionDataPool.pop() || new InteractionData();\n      interactionData.identifier = pointerId;\n      this.activeInteractionData[pointerId] = interactionData;\n    }\n    // copy properties from the event, so that we can make sure that touch/pointer specific\n    // data is available\n    interactionData._copyEvent(event);\n\n    return interactionData;\n  }\n\n  /**\n   * Return unused InteractionData to the pool, for a given pointerId\n   *\n   * @private\n   * @param {number} pointerId - Identifier from a pointer event\n   */\n  releaseInteractionDataForPointerId(pointerId) {\n    const interactionData = this.activeInteractionData[pointerId];\n\n    if (interactionData) {\n      delete this.activeInteractionData[pointerId];\n      interactionData._reset();\n      this.interactionDataPool.push(interactionData);\n    }\n  }\n\n  /**\n   * Configure an InteractionEvent to wrap a DOM PointerEvent and InteractionData\n   *\n   * @private\n   * @param {InteractionEvent} interactionEvent - The event to be configured\n   * @param {PointerEvent} pointerEvent - The DOM event that will be paired with the InteractionEvent\n   * @param {InteractionData} interactionData - The InteractionData that will be paired\n   *        with the InteractionEvent\n   * @return {InteractionEvent} the interaction event that was passed in\n   */\n  configureInteractionEventForDOMEvent(interactionEvent, pointerEvent, interactionData) {\n    interactionEvent.data = interactionData;\n\n    this.mapPositionToPoint(interactionData.global, pointerEvent.clientX, pointerEvent.clientY);\n\n    this.raycaster.setFromCamera(interactionData.global, this.camera);\n\n    // Not really sure why this is happening, but it's how a previous version handled things TODO: there should be remove\n    if (pointerEvent.pointerType === 'touch') {\n      pointerEvent.globalX = interactionData.global.x;\n      pointerEvent.globalY = interactionData.global.y;\n    }\n\n    interactionData.originalEvent = pointerEvent;\n    interactionEvent._reset();\n\n    return interactionEvent;\n  }\n\n  /**\n   * Ensures that the original event object contains all data that a regular pointer event would have\n   *\n   * @private\n   * @param {TouchEvent|MouseEvent|PointerEvent} event - The original event data from a touch or mouse event\n   * @return {PointerEvent[]} An array containing a single normalized pointer event, in the case of a pointer\n   *  or mouse event, or a multiple normalized pointer events if there are multiple changed touches\n   */\n  normalizeToPointerData(event) {\n    const normalizedEvents = [];\n\n    if (this.supportsTouchEvents && event instanceof TouchEvent) {\n      for (let i = 0, li = event.changedTouches.length; i < li; i++) {\n        const touch = event.changedTouches[i];\n\n        if (typeof touch.button === 'undefined') touch.button = event.touches.length ? 1 : 0;\n        if (typeof touch.buttons === 'undefined') touch.buttons = event.touches.length ? 1 : 0;\n        if (typeof touch.isPrimary === 'undefined') {\n          touch.isPrimary = event.touches.length === 1 && event.type === 'touchstart';\n        }\n        if (typeof touch.width === 'undefined') touch.width = touch.radiusX || 1;\n        if (typeof touch.height === 'undefined') touch.height = touch.radiusY || 1;\n        if (typeof touch.tiltX === 'undefined') touch.tiltX = 0;\n        if (typeof touch.tiltY === 'undefined') touch.tiltY = 0;\n        if (typeof touch.pointerType === 'undefined') touch.pointerType = 'touch';\n        if (typeof touch.pointerId === 'undefined') touch.pointerId = touch.identifier || 0;\n        if (typeof touch.pressure === 'undefined') touch.pressure = touch.force || 0.5;\n        touch.twist = 0;\n        touch.tangentialPressure = 0;\n        // TODO: Remove these, as layerX/Y is not a standard, is deprecated, has uneven\n        // support, and the fill ins are not quite the same\n        // offsetX/Y might be okay, but is not the same as clientX/Y when the canvas's top\n        // left is not 0,0 on the page\n        if (typeof touch.layerX === 'undefined') touch.layerX = touch.offsetX = touch.clientX;\n        if (typeof touch.layerY === 'undefined') touch.layerY = touch.offsetY = touch.clientY;\n\n        // mark the touch as normalized, just so that we know we did it\n        touch.isNormalized = true;\n\n        normalizedEvents.push(touch);\n      }\n    } else if (event instanceof MouseEvent && (!this.supportsPointerEvents || !(event instanceof window.PointerEvent))) {\n      if (typeof event.isPrimary === 'undefined') event.isPrimary = true;\n      if (typeof event.width === 'undefined') event.width = 1;\n      if (typeof event.height === 'undefined') event.height = 1;\n      if (typeof event.tiltX === 'undefined') event.tiltX = 0;\n      if (typeof event.tiltY === 'undefined') event.tiltY = 0;\n      if (typeof event.pointerType === 'undefined') event.pointerType = 'mouse';\n      if (typeof event.pointerId === 'undefined') event.pointerId = MOUSE_POINTER_ID;\n      if (typeof event.pressure === 'undefined') event.pressure = 0.5;\n      event.twist = 0;\n      event.tangentialPressure = 0;\n\n      // mark the mouse event as normalized, just so that we know we did it\n      event.isNormalized = true;\n\n      normalizedEvents.push(event);\n    } else {\n      normalizedEvents.push(event);\n    }\n\n    return normalizedEvents;\n  }\n\n  /**\n   * Destroys the interaction manager\n   *\n   */\n  destroy() {\n    this.removeEvents();\n\n    this.removeAllListeners();\n\n    this.renderer = null;\n\n    this.mouse = null;\n\n    this.eventData = null;\n\n    this.interactionDOMElement = null;\n\n    this.onPointerDown = null;\n    this.processPointerDown = null;\n\n    this.onPointerUp = null;\n    this.processPointerUp = null;\n\n    this.onPointerCancel = null;\n    this.processPointerCancel = null;\n\n    this.onPointerMove = null;\n    this.processPointerMove = null;\n\n    this.onPointerOut = null;\n    this.processPointerOverOut = null;\n\n    this.onPointerOver = null;\n\n    this._tempPoint = null;\n  }\n}\n\nexport default InteractionManager;\n","import {\n  OrthographicCamera,\n  Scene,\n} from 'three';\n\n/**\n * layer compositor, use to merge primerLayer and graphicsLayer\n */\nclass LayerCompositor {\n  constructor() {\n    /**\n     * framebuffer will auto clear\n     * @member {Boolean}\n     */\n    this.autoClear = true;\n\n    /**\n     * orthographic camera, for composite draw\n     * @member {OrthographicCamera}\n     */\n    this.camera = new OrthographicCamera(-1, 1, 1, -1, 0, 1);\n\n    /**\n     * scene, for composite draw\n     * @member {Scene}\n     */\n    this.scene = new Scene();\n  }\n\n  /**\n   * push a display object into scene\n   *\n   * @param {THREE.Object3D} child display object, which will be rendering\n   * @return {this} this\n   */\n  add() {\n    this.scene.add.apply(this.scene, arguments);\n    return this;\n  }\n\n  /**\n   * remove a display object from scene\n   *\n   * @param {THREE.Object3D} child display object, which you had push it at before\n   * @return {this} this\n   */\n  remove() {\n    this.scene.remove.apply(this.scene, arguments);\n    return this;\n  }\n\n  composition(renderer, renderTarget) {\n    if (this.autoClear) this.clear(renderer, renderTarget);\n    renderer.render(this.scene, this.camera, renderTarget);\n  }\n\n  /**\n   * clear framebuffer\n   * @param {WebGLRender} renderer renderer from view\n   * @param {WebGLRenderTarget} renderTarget clear which render target\n   */\n  clear(renderer, renderTarget) {\n    renderer.setRenderTarget(renderTarget);\n    renderer.clear(renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil);\n  }\n}\n\nexport default LayerCompositor;\n","import Utils from '../utils/Utils';\n\nfunction setDefault(check, value, spare) {\n  return check(value) ? value : spare;\n}\n\n/**\n * ViewConfig class, a default config for WebGLRenderer with-in UC-AR\n *\n * @private\n * @param {Object} options custom config for WebGLRenderer\n * @param {String|canvas} options.canvas `canvas-dom` or canvas `css-selector`\n * @param {Boolean} [options.alpha=false] whether the canvas contains an alpha (transparency) buffer or not.\n * @param {Boolean} [options.antialias=false] whether to perform antialiasing.\n * @param {String} [options.precision='highp'] Shader precision, Can be `highp`, `mediump` or `lowp`.\n * @param {Boolean} [options.premultipliedAlpha=true] whether the renderer will assume that colors have premultiplied alpha.\n * @param {Boolean} [options.stencil=true] whether the drawing buffer has a stencil buffer of at least 8 bits.\n * @param {Boolean} [options.preserveDrawingBuffer=false] whether to preserve the buffers until manually cleared or overwritten.\n * @param {Boolean} [options.depth=true] whether the drawing buffer has a depth buffer of at least 16 bits.\n * @param {Boolean} [options.logarithmicDepthBuffer] whether to use a logarithmic depth buffer.\n */\nexport default class ViewConfig {\n  constructor(options) {\n    /**\n     * canvas dom element\n     *\n     * @member {canvas}\n     */\n    this.canvas = Utils.isString(options.canvas) ?\n      document.getElementById(options.canvas) ||\n      document.querySelector(options.canvas) :\n      options.canvas;\n\n    /**\n     * Shader precision\n     *\n     * @member {String}\n     */\n    this.precision = options.precision;\n\n    /**\n     * canvas contains an alpha (transparency) buffer or not\n     *\n     * @member {Boolean}\n     */\n    this.alpha = setDefault(Utils.isBoolean, options.alpha, true);\n\n    /**\n     * whether to perform antialiasing\n     *\n     * @member {Boolean}\n     */\n    this.antialias = setDefault(Utils.isBoolean, options.antialias, true);\n\n    /**\n     * whether the renderer will assume that colors have premultiplied alpha.\n     *\n     * @member {Boolean}\n     */\n    this.premultipliedAlpha = options.premultipliedAlpha;\n\n    /**\n     * whether the drawing buffer has a stencil buffer of at least 8 bits.\n     *\n     * @member {Boolean}\n     */\n    this.stencil = options.stencil;\n\n    /**\n     * whether to preserve the buffers until manually cleared or overwritten.\n     *\n     * @member {Boolean}\n     */\n    this.preserveDrawingBuffer = options.preserveDrawingBuffer;\n\n    /**\n     * whether the drawing buffer has a depth buffer of at least 16 bits.\n     *\n     * @member {Boolean}\n     */\n    this.depth = options.depth;\n\n    /**\n     * whether to use a logarithmic depth buffer.\n     *\n     * @member {Boolean}\n     */\n    this.logarithmicDepthBuffer = options.logarithmicDepthBuffer;\n  }\n}\n","import {\n  LinearFilter,\n  RGBAFormat,\n  WebGLRenderTarget,\n} from 'three';\n\nconst parameters = {\n  minFilter: LinearFilter,\n  magFilter: LinearFilter,\n  format: RGBAFormat,\n  stencilBuffer: false,\n};\n\nclass EffectPack {\n  constructor(options) {\n    const { width, height } = options;\n\n    this.width = width;\n\n    this.height = height;\n\n    /**\n     * render buffer to carry render content\n     */\n    this.renderTarget = new WebGLRenderTarget(this.width, this.height, parameters);\n\n    /**\n     * after effect update delta\n     * @member {Number}\n     */\n    this.delta = 0;\n\n    /**\n     * store pass array, all effect pass list\n     * @member {pass}\n     */\n    this.passes = [];\n  }\n\n  /**\n   * add a after-effects pass to this layer\n   * @param {Pass} pass pass process\n   */\n  addPass(pass) {\n    this.passes.push(pass);\n    pass.setSize(this.width, this.height);\n  }\n\n  /**\n   * insert a after-effects pass to this layer\n   * @param {Pass} pass pass process\n   * @param {Number} index insert which position\n   */\n  insertPass(pass, index) {\n    this.passes.splice(index, 0, pass);\n  }\n\n  /**\n   * resize buffer size and pass size when viewport has change\n   * @param {number} width render buffer width\n   * @param {number} height render buffer height\n   */\n  setSize(width, height) {\n    this.width = width;\n    this.height = height;\n    this.renderTarget.setSize(width, height);\n\n    const length = this.passes.length;\n    for (let i = 0; i < length; i++) {\n      this.passes[i].setSize(width, height);\n    }\n  }\n\n  /**\n   * get after-effects was active\n   * @return {Boolean} active or not\n   */\n  get isAeOpen() {\n    const length = this.passes.length;\n    if (length === 0) return false;\n    for (let i = 0; i < length; i++) {\n      if (this.passes[i].enabled) return true;\n    }\n    return false;\n  }\n}\n\nexport default EffectPack;\n","import {\n  WebGLRenderer,\n  EventDispatcher,\n} from 'three';\nimport EffectComposer from './EffectComposer';\nimport InteractionManager from 'three.interaction/src/interaction/InteractionManager';\n// import GraphicsLayer from './GraphicsLayer';\n// import PrimerLayer from './PrimerLayer';\nimport LayerCompositor from './LayerCompositor';\nimport ViewConfig from './ViewConfig';\nimport EffectPack from './EffectPack';\nimport Utils from '../utils/Utils';\n\n/**\n * a `UC-AR` renderer framework, help you building AR-APP fastly\n * @extends EventDispatcher\n * @param {Object} options config for `Viewer` render view-port\n * @param {canvas} options.canvas `canvas-dom` or canvas `css-selector`\n * @param {Number} [options.vrmode=false] whether init with vrmode.\n * @param {Number} [options.updateStyle=false] need update canvas style size.\n * @param {Number} [options.pixelRatio=1] render buffer resolution.\n * @param {Boolean} [options.autoClear=true] whether the renderer should automatically clear its output before rendering a frame.\n * @param {Boolean} [options.alpha=false] whether the canvas contains an alpha (transparency) buffer or not.\n * @param {Boolean} [options.antialias=false] whether to perform antialiasing.\n * @param {String} [options.precision='highp'] Shader precision, Can be `highp`, `mediump` or `lowp`.\n * @param {Boolean} [options.premultipliedAlpha=true] whether the renderer will assume that colors have premultiplied alpha.\n * @param {Boolean} [options.stencil=true] whether the drawing buffer has a stencil buffer of at least 8 bits.\n * @param {Boolean} [options.preserveDrawingBuffer=false] whether to preserve the buffers until manually cleared or overwritten.\n * @param {Boolean} [options.depth=true] whether the drawing buffer has a depth buffer of at least 16 bits.\n * @param {Boolean} [options.logarithmicDepthBuffer] whether to use a logarithmic depth buffer.\n */\nclass Viewer extends EventDispatcher {\n  constructor(options) {\n    super();\n\n    const { pixelRatio = 1, width = 300, height = 150, updateStyle = false, vrmode = false } = options;\n\n    this.width = width;\n\n    this.height = height;\n\n    this.viewBox = { width: width * pixelRatio, height: height * pixelRatio };\n\n    /**\n     * `WebGL` renderer object, base on `three.js` gl context\n     * @member {WebGLRenderer}\n     */\n    this.renderer = new WebGLRenderer(new ViewConfig(options));\n\n    /**\n     * init set pixelRatio\n     * @private\n     */\n    this.renderer.setPixelRatio(pixelRatio);\n\n    /**\n     * init set renderer size\n     * @private\n     */\n    this.renderer.setSize(width, height, updateStyle);\n\n    /**\n     * render effect kit to carry render content and some data\n     */\n    this.effectPack = new EffectPack(this.viewBox);\n\n    /**\n     * close auto-clear, and change\n     * @private\n     */\n    this.renderer.autoClear = false;\n\n    /**\n     * whether the renderer should automatically clear its output before rendering a frame.\n     *\n     * @member {Boolean}\n     */\n    this.autoClear = Utils.isBoolean(options.autoClear) ? options.autoClear : true;\n\n    /**\n     * whether update ticker is working or not\n     *\n     * @member {Boolean}\n     */\n    this.ticking = false;\n\n    /**\n     * pre-time cache\n     *\n     * @member {Number}\n     * @private\n     */\n    this.pt = 0;\n\n    /**\n     * how long the time through, at this tick\n     *\n     * @member {Number}\n     * @private\n     */\n    this.snippet = 0;\n\n    /**\n     * set it when you hope engine update at a fixed fps, default 60/fps\n     *\n     * @member {Number}\n     */\n    this.fps = options.fps || 60;\n\n    /**\n     * time-scale for timeline\n     *\n     * @member {Number}\n     */\n    this.timeScale = 1;\n\n    /**\n     * effect composer, for postprogressing\n     * @member {EffectComposer}\n     */\n    this.effectComposer = new EffectComposer(this.viewBox);\n\n    /**\n     * compositor primerLayer and graphicsLayer with zIndex order\n     * @member {LayerCompositor}\n     */\n    this.layerCompositor = new LayerCompositor();\n\n    /**\n     * store layers array, all content layer list\n     * @member {layer}\n     */\n    this.layers = [];\n\n    /**\n     * 3d-view interaction manager\n     * TODO: should fix interaction bug when vrmode\n     */\n    this.interactionManager = new InteractionManager(this.renderer, this.layers, this.camera);\n\n    this._vrmode = null;\n\n    this.vrmodeOnChange = () => {\n      this.setComposerSize();\n      this.setLayersSize();\n    };\n\n    this.vrmode = vrmode;\n  }\n\n  /**\n   * update timeline and update render\n   */\n  update() {\n    this.timeline();\n    const snippet = this.snippet;\n\n    this.emit('pretimeline', {\n      snippet,\n    });\n    this.updateTimeline(snippet);\n    this.emit('posttimeline', {\n      snippet,\n    });\n\n    this.emit('prerender', {\n      snippet,\n    });\n    this.render();\n    this.emit('postrender', {\n      snippet,\n    });\n  }\n\n  /**\n   * update timeline\n   * @param {Number} snippet time snippet\n   * @private\n   */\n  updateTimeline(snippet) {\n    snippet = this.timeScale * snippet;\n\n    this.emit('pretimeline', {\n      snippet,\n    });\n\n    let i = 0;\n    const layers = this.layers;\n    const length = layers.length;\n    while (i < length) {\n      layers[i].updateTimeline(snippet);\n      i++;\n    }\n\n    this.emit('posttimeline', {\n      snippet,\n    });\n  }\n\n  /**\n   * clear framebuffer\n   * @param {WebGLRenderTarget} renderTarget clear which render target\n   */\n  clear(renderTarget) {\n    this.renderer.setRenderTarget(renderTarget);\n    this.renderer.clear(this.renderer.autoClearColor, this.renderer.autoClearDepth, this.renderer.autoClearStencil);\n  }\n\n  /**\n   * set render rectangle area\n   * @param {number} x rectangle left-top point x-position\n   * @param {number} y rectangle left-top point y-position\n   * @param {number} width rectangle width\n   * @param {number} height rectangle height\n   */\n  setSV(x, y, width, height) {\n    this.renderer.setScissor(x, y, width, height);\n    this.renderer.setViewport(x, y, width, height);\n  }\n\n  /**\n   * render all 3d stage, should be overwrite by sub-class\n   */\n  render() {\n    if (this.autoClear) this.clear(null);\n    const size = this.viewBox;\n    if (this.vrmode) {\n      const hw = size.width / 2;\n\n      this.renderer.setScissorTest(true);\n\n      this.setSV(0, 0, hw, size.height);\n      this.xrRender({ mode: 'VR', eye: 'LEFT' });\n\n      this.setSV(hw, 0, hw, size.height);\n      this.xrRender({ mode: 'VR', eye: 'RIGHT' });\n\n      this.renderer.setScissorTest(false);\n    } else {\n      this.setSV(0, 0, size.width, size.height);\n      this.xrRender({ mode: 'NORMAL' });\n    }\n\n  }\n\n  /**\n   * render every layer to it's render buffer\n   * @param {object} session a renderer session\n   * @private\n   */\n  xrRender(session) {\n    this.renderLayers(session);\n    this.layerEffect();\n    this.composition();\n  }\n\n  /**\n   * render every layer to it's render buffer\n   * @param {object} session a renderer session\n   * @private\n   */\n  renderLayers(session) {\n    if (this.needSort) {\n      this._sortList();\n      this._sortLayerQuad();\n      this.needSort = false;\n    }\n    for (let i = 0; i < this.layers.length; i++) {\n      const layer = this.layers[i];\n      if (!layer.isEmpty) layer.render(this.renderer, session);\n    }\n  }\n\n  /**\n   * process every layer effect magic\n   *\n   * @private\n   */\n  layerEffect() {\n    const ll = this.layers.length;\n    for (let i = 0; i < ll; i++) {\n      const layer = this.layers[i];\n      if (layer.effectPack.isAeOpen) this.effectComposer.render(this.renderer, layer.effectPack);\n    }\n  }\n\n  /**\n   * composition every layer to a single layer or render to screen\n   *\n   * @private\n   */\n  composition() {\n    const isAeOpen = this.effectPack.isAeOpen;\n    const renderTarget = isAeOpen ? this.effectPack.renderTarget : null;\n    this.layerCompositor.composition(this.renderer, renderTarget);\n    if (isAeOpen) {\n      this.viewEffect();\n    }\n  }\n\n  /**\n   * if this view has pass effect, do magic again\n   *\n   * @private\n   */\n  viewEffect() {\n    this.effectComposer.render(this.renderer, this.effectPack, true);\n  }\n\n  /**\n   * render loop, trigger one and one tick\n   *\n   * @private\n   */\n  tick() {\n    const This = this;\n    /**\n     * render loop\n     */\n    (function render() {\n      This.update();\n      This.loop = RAF(render);\n    })();\n  }\n\n  /**\n   * update loop with fixed fps, maybe case a performance problem\n   *\n   * @private\n   */\n  tickFixedFPS() {\n    const This = this;\n    this.loop = setInterval(function() {\n      This.update();\n    }, 1000 / this.fps);\n    This.update();\n  }\n\n  /**\n   * get timeline snippet\n   *\n   * @private\n   */\n  timeline() {\n    let snippet = Date.now() - this.pt;\n    if (!this.pt || snippet > 200) {\n      this.pt = Date.now();\n      snippet = Date.now() - this.pt;\n    }\n    this.pt += snippet;\n    this.snippet = snippet;\n  }\n\n  /**\n   * start update engine\n   * @return {this} this\n   */\n  start() {\n    if (this.ticking) return;\n    this.ticking = true;\n    this.pt = Date.now();\n    if (this.fps === 60) {\n      this.tick();\n    } else {\n      this.tickFixedFPS();\n    }\n    return this;\n  }\n\n  /**\n   * stop update engine\n   * @return {this} this\n   */\n  stop() {\n    CAF(this.loop);\n    clearInterval(this.loop);\n    this.ticking = false;\n    return this;\n  }\n\n  /**\n   * sort layer, because array.sort was not stable-sort, so use bubble sort\n   *\n   * @private\n   */\n  _sortList() {\n    const layers = this.layers;\n    const length = layers.length;\n    let i;\n    let j;\n    let temp;\n    for (i = 0; i < length - 1; i++) {\n      for (j = 0; j < length - 1 - i; j++) {\n        if (layers[j].zIndex > layers[j + 1].zIndex) {\n          temp = layers[j];\n          layers[j] = layers[j + 1];\n          layers[j + 1] = temp;\n        }\n      }\n    }\n  }\n\n  /**\n   * sort layer's quad order, mapping with layerCompositor.scene\n   *\n   * @private\n   */\n  _sortLayerQuad() {\n    const quads = this.layerCompositor.scene.children;\n    const length = quads.length;\n    let i;\n    let j;\n    let temp;\n    for (i = 0; i < length - 1; i++) {\n      for (j = 0; j < length - 1 - i; j++) {\n        if (quads[j].root.zIndex > quads[j + 1].root.zIndex) {\n          temp = quads[j];\n          quads[j] = quads[j + 1];\n          quads[j + 1] = temp;\n        }\n      }\n    }\n  }\n\n  /**\n   * add a layer into layer compositor\n   *\n   * @param {Layer} layer primerLayer or graphicsLayer\n   * @return {this} this\n   */\n  add(layer) {\n    if (arguments.length > 1) {\n      for (let i = 0; i < arguments.length; i++) {\n        this.add(arguments[ i ]);\n      }\n      return this;\n    }\n\n    if ((layer && layer.isLayer)) {\n      if (layer.parent !== null) {\n        layer.parent.remove(layer);\n      }\n\n      layer.parent = this;\n      this.layers.push(layer);\n      this.layerCompositor.add(layer.quad);\n      this.setLayerSize(layer);\n      this.needSort = true;\n    } else {\n      console.error('Compositor.add: layer not an instance of Layer.', layer);\n    }\n    return this;\n  }\n\n  /**\n   * remove a layer from compositor\n   *\n   * @param {Layer} layer primerLayer or graphicsLayer\n   * @return {this} this\n   */\n  remove(layer) {\n    if (arguments.length > 1) {\n      for (let i = 0; i < arguments.length; i++) {\n        this.remove(arguments[ i ]);\n      }\n      return this;\n    }\n    const index = this.layers.indexOf(layer);\n\n    if (index !== -1) {\n      layer.parent = null;\n      this.layers.splice(index, 1);\n      this.layerCompositor.remove(layer.quad);\n    }\n    return this;\n  }\n\n  /**\n   * add a after-effects pass to this layer\n   * @param {Pass} pass pass process\n   */\n  addPass() {\n    this.effectPack.addPass.apply(this.effectPack, arguments);\n  }\n\n  /**\n   * insert a after-effects pass to this layer\n   * @param {Pass} pass pass process\n   * @param {Number} index insert which position\n   */\n  insertPass() {\n    this.effectPack.insertPass.apply(this.effectPack, arguments);\n  }\n\n  getPortSize() {\n    let { width, height } = this.viewBox;\n    if (this.vrmode) {\n      width = width / 2;\n      height = height / 2;\n    }\n    return { width, height };\n  }\n\n  setLayersSize() {\n    const { width, height } = this.getPortSize();\n    const l = this.layers.length;\n    for (let i = 0; i < l; i++) {\n      const layer = this.layers[i];\n      layer.setSize(width, height);\n    }\n  }\n\n  setLayerSize(layer) {\n    const { width, height } = this.getPortSize();\n    layer.setSize(width, height);\n  }\n\n  setComposerSize() {\n    const { width, height } = this.getPortSize();\n    this.effectComposer.setSize(width, height);\n  }\n\n  /**\n   * resize window when viewport has change\n   * @param {number} width render buffer width\n   * @param {number} height render buffer height\n   * @param {boolean} updateStyle update style or not\n   */\n  setSize(width, height, updateStyle = false) {\n    this.width = width;\n    this.height = height;\n    this.renderer.setSize(width, height, updateStyle);\n    this.viewBox = this.renderer.getDrawingBufferSize();\n\n    this.setComposerSize();\n    this.setLayersSize();\n  }\n\n  setPixelRatio(pixelRatio) {\n    this.renderer.setPixelRatio(pixelRatio);\n    this.setSize(this.width, this.height);\n  }\n\n  createLayer(layerClass, options) {\n    const { width, height } = this.getPortSize();\n    options = Object.assign({ width, height }, options);\n    const layer = new layerClass(options);\n    this.add(layer);\n    return layer;\n  }\n\n  /**\n   * getter whether scene interactively or not\n   */\n  get vrmode() {\n    return this._vrmode;\n  }\n\n  /**\n   * setter whether scene interactively or not\n   * @param {Boolean} value is interactively ?\n   */\n  set vrmode(value) {\n    if (value !== this.vrmode) {\n      this._vrmode = value;\n      this.vrmodeOnChange();\n    }\n  }\n}\n\nexport default Viewer;\n","import {\n  Mesh,\n  Scene,\n  PlaneBufferGeometry,\n  MeshBasicMaterial,\n} from 'three';\nimport EffectPack from '../EffectPack';\n\n/**\n * render layer, for multi-function render pipeline, support after-effects\n */\nclass Layer {\n  /**\n   * layer required a renderer\n   * @param {Object} options options\n   */\n  constructor(options) {\n    const { width, height } = options;\n\n    /**\n     * the parent of this layer, sometime was compositor\n     * @member {Compositor}\n     */\n    this.parent = null;\n\n    /**\n     * zIndex order, for render list\n     * @member {Number}\n     * @private\n     */\n    this._zIndex = 0;\n\n    /**\n     * layer tag, fast check isLayer\n     * @member {Boolean}\n     */\n    this.isLayer = true;\n\n    /**\n     * framebuffer will auto clear\n     * @member {Boolean}\n     */\n    this.autoClear = true;\n\n    /**\n     * time-scale for timeline\n     *\n     * @member {Number}\n     */\n    this.timeScale = 1;\n\n    /**\n     * after effect update delta\n     * @member {Number}\n     */\n    this.aeDelta = 0;\n\n    /**\n     * render effect kit to carry render content and some data\n     */\n    this.effectPack = new EffectPack({ width, height });\n\n    /**\n     * camera, for composite draw\n     * @member {Camera}\n     */\n    this.camera = null;\n\n    /**\n     * scene, for composite draw\n     * @member {Scene}\n     */\n    this.scene = new Scene();\n\n    /**\n     * quad, for composite draw\n     * @member {Mesh}\n     */\n    this.quad = new Mesh(\n      new PlaneBufferGeometry(2, 2),\n      new MeshBasicMaterial({\n        transparent: true,\n        map: this.effectPack.renderTarget.texture,\n        depthTest: false,\n        depthWrite: false,\n      })\n    );\n\n    this.quad.root = this;\n  }\n\n  /**\n   * push a display object into scene\n   *\n   * @param {THREE.Object3D} child display object, which will be rendering\n   * @return {this} this\n   */\n  add() {\n    this.scene.add.apply(this.scene, arguments);\n    return this;\n  }\n\n  /**\n   * remove a display object from scene\n   *\n   * @param {THREE.Object3D} child display object, which you had push it at before\n   * @return {this} this\n   */\n  remove() {\n    this.scene.remove.apply(this.scene, arguments);\n    return this;\n  }\n\n  /**\n   * update timeline\n   * @param {Number} snippet time snippet\n   * @private\n   */\n  updateTimeline(snippet) {\n    snippet = this.timeScale * snippet;\n    this.scene.updateTimeline(snippet);\n  }\n\n  render(renderer) {\n    if (this.autoClear) this.clear(renderer, this.effectPack.renderTarget);\n\n    renderer.render(this.scene, this.camera, this.effectPack.renderTarget);\n  }\n\n  /**\n   * clear framebuffer\n   * @param {WebGLRender} renderer renderer from view\n   * @param {WebGLRenderTarget} renderTarget clear which render target\n   */\n  clear(renderer, renderTarget) {\n    renderer.setRenderTarget(renderTarget);\n    renderer.clear(renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil);\n  }\n\n  /**\n   * add a after-effects pass to this layer\n   * @param {Pass} pass pass process\n   */\n  addPass() {\n    this.effectPack.addPass.apply(this.effectPack, arguments);\n  }\n\n  /**\n   * insert a after-effects pass to this layer\n   * @param {Pass} pass pass process\n   * @param {Number} index insert which position\n   */\n  insertPass() {\n    this.effectPack.insertPass.apply(this.effectPack, arguments);\n  }\n\n  /**\n   * resize layer size when viewport has change\n   * @param {number} width layer buffer width\n   * @param {number} height layer buffer height\n   */\n  setSize(width, height) {\n    this.effectPack.setSize(width, height);\n  }\n\n  /**\n   * get zIndex\n   * @return {Number} zIndex\n   */\n  get zIndex() {\n    return this._zIndex;\n  }\n\n  /**\n   * set zIndex\n   * @param {Number} index zIndex\n   */\n  set zIndex(index) {\n    if (this._zIndex !== index) {\n      this._zIndex = index;\n      if (this.parent) {\n        this.parent.needSort = true;\n      }\n    }\n  }\n\n  /**\n   * get primers status\n   */\n  get isEmpty() {\n    return this.scene.children.length === 0;\n  }\n}\n\nexport default Layer;\n","import { PerspectiveCamera } from 'three';\nimport Layer from './Layer';\n\nclass ARLayer extends Layer {\n  constructor(options) {\n    super(options);\n\n    const { frameWidth = 480, frameHeight = 640 } = options;\n\n    /**\n     * video frame width\n     * @member {Number}\n     */\n    this.frameWidth = frameWidth;\n\n    /**\n     * video frame height\n     * @member {Number}\n     */\n    this.frameHeight = frameHeight;\n\n    // init update viewport for ar-video-frame\n    this.updateViewport();\n\n    /**\n     * view-port camera object, a perspective camera\n     *\n     * @member {PerspectiveCamera}\n     */\n    this.camera = new PerspectiveCamera();\n    this.camera.matrixAutoUpdate = false;\n\n    /**\n     * tracking object `<markerName-arGlue>` map\n     *\n     * @member {Object}\n     */\n    this.ar_map = {};\n  }\n\n  /**\n   * add display-object like `ARGlue` or `THREE.Object3D` object\n   *\n   * @param {ARGlue|THREE.Object3D} object display-object which you want show\n   * @return {this} this\n   */\n  add(object) {\n    if (arguments.length > 1) {\n      for (let i = 0; i < arguments.length; i++) {\n        this.add(arguments[i]);\n      }\n      return this;\n    }\n\n    if (object.type === 'ARGlue') {\n      const name = object.name;\n      this.ar_map[name] = object;\n    }\n    this.scene.add(object);\n    return this;\n  }\n\n  /**\n   * remove `ARGlue` or `THREE.Object3D` object\n   *\n   * @param {ARGlue|THREE.Object3D} object display-object which you had add before\n   * @return {this} this\n   */\n  remove(object) {\n    if (arguments.length > 1) {\n      for (let i = 0; i < arguments.length; i++) {\n        this.remove(arguments[i]);\n      }\n      return this;\n    }\n\n    if (object.type === 'ARGlue') {\n      const name = object.name;\n      this.ar_map[name] = null;\n    }\n    this.scene.remove(object);\n    return this;\n  }\n\n  /**\n   * update tracking-display-object's pose state, poses get from `UC-AR`\n   *\n   * @param {Array} poses poses matrix array\n   */\n  updatePoses(poses) {\n    poses.forEach(({ name, matrix, isDetected }) => {\n      const glue = this.ar_map[name];\n      if (glue) {\n        glue.updatePose(matrix, isDetected);\n      }\n    });\n  }\n\n  /**\n   * update camera internal parama matrix, this matrix get from `UC-AR`\n   *\n   * @param {Array} matrix 4*4 matrix\n   */\n  updateCameraMatrix(matrix) {\n    this.camera.projectionMatrix.fromArray(matrix);\n  }\n\n  /**\n   * adjust viewport, when frameWidth frameHeight or renderer.getSize had change\n   */\n  updateViewport() {\n    const { width, height } = this.renderer.getSize();\n    const rw = width / this.frameWidth;\n    const rh = height / this.frameHeight;\n    const ratio = Math.max(rw, rh);\n    const rtw = this.frameWidth * ratio;\n    const rth = this.frameHeight * ratio;\n\n    let x = 0;\n    let y = 0;\n\n    if (rw < rh) {\n      x = -(rtw - width) / 2;\n    } else if (rw > rh) {\n      y = -(rth - height) / 2;\n    }\n\n    this.renderer.setViewport(x, y, rtw, rth);\n  }\n\n  /**\n   * render all scene\n   * @param {WebGLRender} renderer renderer context\n   */\n  render(renderer) {\n    if (this.autoClear) this.clear(renderer, this.effectPack.renderTarget);\n    renderer.render(this.scene, this.camera, this.effectPack.renderTarget);\n  }\n\n  /**\n   * resize layer size when viewport has change\n   * @param {number} width layer buffer width\n   * @param {number} height layer buffer height\n   */\n  setSize(width, height) {\n    this.effectPack.setSize(width, height);\n    // this.camera.aspect = width / height;\n    // this.camera.updateProjectionMatrix();\n  }\n}\n\nexport default ARLayer;\n","import { PerspectiveCamera, StereoCamera } from 'three';\n// import InteractionManager from 'three.interaction/src/interaction/InteractionManager';\nimport Orienter from '../../utils/Orienter';\n// import Utils from '../utils/Utils';\nimport Layer from './Layer';\n\nclass XRLayer extends Layer {\n  constructor(options) {\n    super(options);\n    const { width, height, vrsensor, fov = 60, aspect = width / height, near = 0.1, far = 1000 } = options;\n    /**\n     * view-port camera object, a perspective camera\n     *\n     * @member {Camera}\n     */\n    this.camera = new PerspectiveCamera(fov, aspect, near, far);\n\n    /**\n     * stereo camera object\n     *\n     * @member {StereoCamera}\n     */\n    this.stereo = new StereoCamera();\n    this.stereo.aspect = options.stereoAspect || 0.5;\n\n    /**\n     * use orientation sensor or not\n     *\n     * @member {Boolean}\n     */\n    this.vrsensor = vrsensor || false;\n\n    /**\n     * device orientation sensor, control camera look around\n     *\n     * @member {Orienter}\n     */\n    this.sensorCTL = new Orienter();\n\n    // update sensor state before update timeline\n    this.sensorCTL.on('deviceorientation', ({ quaternion }) => {\n      if (this.vrsensor) {\n        this.camera.quaternion.copy(quaternion);\n      }\n    });\n  }\n\n  /**\n   * update stereo camera\n   */\n  updateStereo() {\n    if (this.camera.parent === null) this.camera.updateMatrixWorld();\n    this.stereo.update(this.camera);\n  }\n\n  /**\n   * render all scene\n   * @param {WebGLRender} renderer renderer context\n   * @param {object} session renderer session\n   */\n  render(renderer, session) {\n    if (this.autoClear) this.clear(renderer, this.effectPack.renderTarget);\n\n    if (session.mode === 'VR') {\n      this.updateStereo();\n      const camera = session.eye === 'LEFT' ? this.stereo.cameraL : this.stereo.cameraR;\n      renderer.render(this.scene, camera, this.effectPack.renderTarget);\n    } else {\n      renderer.render(this.scene, this.camera, this.effectPack.renderTarget);\n    }\n  }\n\n  /**\n   * resize layer size when viewport has change\n   * @param {number} width layer buffer width\n   * @param {number} height layer buffer height\n   */\n  setSize(width, height) {\n    this.effectPack.setSize(width, height);\n    this.camera.aspect = width / height;\n    this.camera.updateProjectionMatrix();\n  }\n\n  /**\n   * getter whether scene interactively or not\n   */\n  get interactive() {\n    return this._interactive;\n  }\n\n  /**\n   * setter whether scene interactively or not\n   * @param {Boolean} value is interactively ?\n   */\n  set interactive(value) {\n    if (value !== this.interactive) {\n      this._interactive = value;\n      this.interactiveOnChange();\n    }\n  }\n\n  /**\n   * getter whether scene interactively or not\n   */\n  get vrmode() {\n    return this._vrmode;\n  }\n\n  /**\n   * setter whether scene interactively or not\n   * @param {Boolean} value is interactively ?\n   */\n  set vrmode(value) {\n    if (value !== this.vrmode) {\n      this._vrmode = value;\n      this.vrmodeOnChange();\n    }\n  }\n}\n\nexport default XRLayer;\n","import { OrthographicCamera, Scene, PlaneBufferGeometry, Matrix3, Vector3 } from 'three';\nimport Utils from '../../utils/Utils';\n\nconst LANDSCAPE_MAP = {\n  NONE: 0,\n  CW: Utils.DTR(-90),\n  CCW: Utils.DTR(90),\n};\n\n/**\n * base primer class, provide primering paint\n */\nclass Primer {\n  /**\n   * post some config to primer\n   * @param {*} _ have not be used\n   * @param {*} options config primer status\n   */\n  constructor(_, options) {\n    options = options || {};\n\n    /**\n     * frame landscape orientation\n     * @member {Number}\n     * @private\n     */\n    this.landscape = Utils.isString(options.landscape) && LANDSCAPE_MAP[options.landscape] ?\n      LANDSCAPE_MAP[options.landscape] : LANDSCAPE_MAP.CW;\n\n    /**\n     * this frame need to flip with y-axis\n     * @member {Boolean}\n     * @private\n     */\n    this.flip = Utils.isBoolean(options.flip) ? options.flip : true;\n\n    /**\n     * uv matrix\n     * @member {Matrix3}\n     * @private\n     */\n    this.uvMatrix = new Matrix3();\n\n    /**\n     * primer tag\n     * @member {Boolean}\n     */\n    this.isPrimer = true;\n\n    /**\n     * this primer is enable\n     * @member {Boolean}\n     */\n    this.enabled = true;\n\n    /**\n     * the parent of this parent\n     * @member {Layer}\n     * @private\n     */\n    this.parent = null;\n\n    /**\n     * scene for this 2D context\n     * @member {Scene}\n     * @private\n     */\n    this.scene = new Scene();\n\n    /**\n     * camera for this 2D context\n     * @member {OrthographicCamera}\n     * @private\n     */\n    this.camera = new OrthographicCamera(-1, 1, 1, -1, 0, 1);\n\n    /**\n     * geometry for this 2D context\n     * @member {PlaneBufferGeometry}\n     * @private\n     */\n    this.pigmentGeo = new PlaneBufferGeometry(2, 2);\n\n    /**\n     * whether auto-cover to target viewport\n     * @member {Boolean}\n     */\n    this.autoCover = options.autoCover || false;\n\n    if (this.autoCover && options.targetAspect) {\n      this.setTargetAspect(options.targetAspect);\n    }\n  }\n\n  /**\n   * update timeline\n   */\n  updateTimeline() {\n\n  }\n\n  /**\n   * render function, need overwrite by sub-class\n   */\n  render() {\n    console.warn('should be overwrite by sub-class');\n  }\n\n  /**\n   * set the target viewport aspect\n   * @param {Number} aspect target viewport aspect\n   */\n  setTargetAspect(aspect) {\n    this.targetAspect = aspect;\n    if (this.autoCover) this.needsUpdateAttributes = true;\n  }\n\n  /**\n   * update attribute\n   * @private\n   */\n  _updateAttributes() {\n    if (!this.needsUpdateAttributes) return;\n    const { width, height } = this._cs();\n    this._setPositions(this.pigmentGeo.attributes.position, width, height);\n    this.needsUpdateAttributes = false;\n  }\n\n  /**\n   * update aspect itself\n   * @param {Number} aspect target viewport aspect\n   * @private\n   */\n  _setAspect(aspect) {\n    this.aspect = aspect;\n    if (this.autoCover) this.needsUpdateAttributes = true;\n  }\n\n  /**\n   * calculation the size for geometry in this targetAspect\n   * @return {Object} size\n   * @private\n   */\n  _cs() {\n    const scale = this.aspect / this.targetAspect;\n    const size = {\n      width: 1,\n      height: 1,\n    };\n    if (this.targetAspect > this.aspect) {\n      size.height = 1 / scale;\n    } else if (this.targetAspect < this.aspect) {\n      size.width = scale;\n    }\n    return size;\n  }\n\n  /**\n   * resize geometry size\n   * @param {BufferAttribute} positions positions buffer\n   * @param {Number} width target width\n   * @param {Number} height target height\n   * @return {BufferAttribute} updated BufferAttribute\n   */\n  _setPositions(positions, width, height) {\n    const coefficient = [ -1, 1, 0, 1, 1, 0, -1, -1, 0, 1, -1, 0 ];\n    for (let i = 0; i < positions.count; i++) {\n      const item = positions.itemSize * i;\n      positions.array[item] = coefficient[item] * width;\n      positions.array[item + 1] = coefficient[item + 1] * height;\n    }\n    positions.needsUpdate = true;\n    return positions;\n  }\n\n  /**\n   * correct uv buffer\n   * @param {BufferAttribute} uv uv bufferAttribute\n   * @return {BufferAttribute} corrected BufferAttribute\n   */\n  _correctUv(uv) {\n    const v1 = new Vector3();\n    this.uvMatrix.identity();\n    this.uvMatrix.translate(-0.5, -0.5);\n    this.uvMatrix.rotate(this.landscape);\n    if (this.flip) this.uvMatrix.scale(1, -1);\n    this.uvMatrix.translate(0.5, 0.5);\n    for (let i = 0, l = uv.count; i < l; i++) {\n      v1.x = uv.getX(i);\n      v1.y = uv.getY(i);\n      v1.z = 1;\n\n      v1.applyMatrix3(this.uvMatrix);\n      uv.setXY(i, v1.x, v1.y);\n    }\n    uv.needsUpdate = true;\n    return uv;\n  }\n\n  /**\n   * get autoCover status\n   */\n  get autoCover() {\n    return this._autoCover;\n  }\n\n  /**\n   * set autoCover status\n   * @param {Boolean} autoCover whether autoCover or not\n   */\n  set autoCover(autoCover) {\n    if (autoCover !== this.autoCover) {\n      this._autoCover = autoCover;\n      if (autoCover) this.needsUpdateAttributes = true;\n    }\n  }\n}\n\nexport default Primer;\n","import {\n  LuminanceFormat,\n  Color,\n} from 'three';\n\n/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Focus shader\n * based on PaintEffect postprocess from ro.me\n * http://code.google.com/p/3-dreams-of-black/source/browse/deploy/js/effects/PaintEffect.js\n * @private\n */\nconst YUVShader = {\n\n  texOrder: [ 'uYTex', 'uUTex', 'uVTex' ],\n\n  uniforms: {\n\n    uYTex: { value: null, ss: 1, format: LuminanceFormat },\n    uUTex: { value: null, ss: 0.5, format: LuminanceFormat },\n    uVTex: { value: null, ss: 0.5, format: LuminanceFormat },\n\n    diffuse: { value: new Color(0xffffff) },\n\n  },\n\n  vertexShader: `\n  varying vec2 vUv;\n  void main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  }`,\n\n  fragmentShader: `\n  uniform sampler2D uYTex;\n  uniform sampler2D uUTex;\n  uniform sampler2D uVTex;\n\n  uniform vec3 diffuse;\n\n  varying vec2 vUv;\n\n  const mat3 mYUV2RGB = mat3(\n    1.0,   1.0,     1.0,\n    0.0,  -0.395,  2.032,\n    1.40, -0.581,   0.0\n  );\n\n  void main(){\n    vec3 YUV;\n    YUV.x = 1.1643 * (texture2D(uYTex, vUv).r - 0.0625);\n    YUV.y = texture2D(uUTex, vUv).r - 0.5;\n    YUV.z = texture2D(uVTex, vUv).r - 0.5;\n\n    gl_FragColor = vec4(diffuse * diffuse * (mYUV2RGB * YUV), 1.0);\n  }`,\n};\n\nexport default YUVShader;\n","import {\n  LuminanceFormat,\n  LuminanceAlphaFormat,\n  Color,\n} from 'three';\n\n/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Focus shader\n * based on PaintEffect postprocess from ro.me\n * http://code.google.com/p/3-dreams-of-black/source/browse/deploy/js/effects/PaintEffect.js\n * @private\n */\nconst YCbCrShader = {\n\n  texOrder: [ 'uYTex', 'uCTex' ],\n\n  uniforms: {\n\n    uYTex: { value: null, ss: 1, format: LuminanceFormat },\n    uCTex: { value: null, ss: 0.5, format: LuminanceAlphaFormat },\n\n    diffuse: { value: new Color(0xffffff) },\n\n  },\n\n  vertexShader: `\n  varying vec2 vUv;\n  void main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  }`,\n\n  fragmentShader: `\n  uniform sampler2D uYTex;\n  uniform sampler2D uCTex;\n  uniform vec3 diffuse;\n\n  varying vec2 vUv;\n\n  const mat3 mYCbCrToRGB = mat3(\n    1.0,      1.0,     1.0,\n    0.0,     -0.18732, 1.8556,\n    1.57481, -.46813,  0.0\n  );\n\n  void main(){\n    vec3 YCbCr;\n    YCbCr.x  = texture2D(uYTex, vUv).r;\n    YCbCr.yz = texture2D(uCTex, vUv).ra - 0.5;\n    gl_FragColor = vec4(diffuse * diffuse * (mYCbCrToRGB * YCbCr), 1.0);\n  }`,\n};\n\nexport default YCbCrShader;\n","import {\n  Mesh,\n  UniformsUtils,\n  ShaderMaterial,\n  DataTexture,\n  Color,\n} from 'three';\nimport Primer from './Primer';\nimport YUVShader from '../../shader/YUVShader';\nimport YCbCrShader from '../../shader/YCbCrShader';\n\nconst FORMAT_MAP = {\n  3: YUVShader,\n  4: YCbCrShader,\n  5: YCbCrShader,\n};\n\n/**\n * camera-primer, for ali webar framework\n */\nclass CameraPrimer extends Primer {\n  /**\n   * required displayTarget to get frame\n   * @param {DisplayTarget} displayTarget webar DisplayTarget class\n   * @param {Object} options primer config\n   * @param {Color} [options.color=0xffffff] tint color\n   * @param {Boolean} [options.depthTest=false] enbale depth test\n   * @param {Boolean} [options.depthWrite=false] enbale depth write\n   */\n  constructor(displayTarget, options) {\n    super(displayTarget, options);\n\n    const { color = 0xffffff, depthTest = false, depthWrite = false } = options || {};\n\n    /**\n     * cache the displayTarget\n     * @member {DisplayTarget}\n     */\n    this.displayTarget = displayTarget;\n\n    /**\n     * set primer tint color\n     * @member {Color}\n     */\n    this.color = color;\n\n    /**\n     * whether enbale depth test or not\n     * @member {Boolean}\n     * @private\n     */\n    this._depthTest = depthTest || false;\n\n    /**\n     * whether enbale depth write or not\n     * @member {Boolean}\n     * @private\n     */\n    this._depthWrite = depthWrite || false;\n\n    this.init(this.getFrames());\n  }\n\n  /**\n   * get frame data from displayTarget\n   * @return {frameData} camera frame data\n   */\n  getFrames() {\n    return this.displayTarget.getFrames();\n  }\n\n  /**\n   * init set something\n   * @param {frameData} frameData camera frame data\n   * @private\n   */\n  init({ format, dataArray, width, height }) {\n    this.shader = FORMAT_MAP[format];\n\n    this.uniforms = UniformsUtils.clone(this.shader.uniforms);\n\n    this.shader.texOrder.forEach((tex, idx) => {\n      const { ss, format } = this.uniforms[tex];\n      this.uniforms[tex].value = new DataTexture(dataArray[idx], width * ss, height * ss, format);\n    });\n\n    this.uniforms.diffuse.value = new Color(this.color);\n\n    this.pigmentMat = new ShaderMaterial({\n      uniforms: this.uniforms,\n      vertexShader: this.shader.vertexShader,\n      fragmentShader: this.shader.fragmentShader,\n      depthTest: this._depthTest,\n      depthWrite: this._depthWrite,\n    });\n\n    this.pigment = new Mesh(this.pigmentGeo, this.pigmentMat);\n    this.pigment.frustumCulled = false;\n\n    this._correctUv(this.pigmentGeo.attributes.uv);\n\n    this.scene.add(this.pigment);\n\n    this._setAspect(height / width);\n  }\n\n  /**\n   * update shader uniforms and aspect itself\n   * @param {frameData} frameData camera frame data\n   * @private\n   */\n  updateFrame({ dataArray, width, height }) {\n    this.shader.texOrder.forEach((tex, idx) => {\n      if (this.uniforms[tex].value.needsUpdate) return;\n      const { ss } = this.uniforms[tex];\n      this.uniforms[tex].value.image.data = dataArray[idx];\n      this.uniforms[tex].value.image.width = width * ss;\n      this.uniforms[tex].value.image.height = height * ss;\n      this.uniforms[tex].value.needsUpdate = true;\n    });\n    this._setAspect(height / width);\n  }\n\n  /**\n   * update attribute and frame\n   */\n  update() {\n    if (this.autoCover) this._updateAttributes();\n    if (!this.displayTarget.isDirty) return;\n    this.updateFrame(this.getFrames());\n  }\n\n  /**\n   * render this primer\n   * @param {WebGLRenderer} renderer put webgl renderer\n   * @param {WebGLRenderTarget} rednerTarget render to which buffer\n   */\n  render(renderer, rednerTarget) {\n    this.update();\n    renderer.render(this.scene, this.camera, rednerTarget);\n  }\n}\n\nexport default CameraPrimer;\n","import {\n  Mesh,\n  MeshBasicMaterial,\n  VideoTexture,\n  CanvasTexture,\n  Texture,\n  TextureLoader,\n  Color,\n} from 'three';\nimport Primer from './Primer';\nimport Utils from '../../utils/Utils';\n\n/**\n * texture-primer, for Texture CanvasTexture VideoTexture\n */\nclass TexturePrimer extends Primer {\n  /**\n   * create a texture frame\n   * @param {image|canvas|video} frame texture frame\n   * @param {Object} options config\n   * @param {Color} [options.color=0xffffff] tint color\n   * @param {Boolean} [options.depthTest=false] enable depth test\n   * @param {Boolean} [options.depthWrite=false] enable depth write\n   * @param {THREE.Filter} [options.minFilter] use which min filter\n   * @param {THREE.Filter} [options.magFilter] use which mag filter\n   * @param {THREE.Format} [options.format] use which color format\n   */\n  constructor(frame, options) {\n    super(frame, options);\n\n    const { color = 0xffffff, depthTest = false, depthWrite = false, minFilter, magFilter, format } = options || {};\n\n    this.texture = Utils.isString(frame) ? new TextureLoader().load(frame) :\n      frame.tagName === 'VIDEO' ? new VideoTexture(frame) :\n        frame.tagName === 'CANVAS' ? new CanvasTexture(frame) :\n          frame.tagName === 'IMG' ? new Texture(frame) : null;\n\n    if (minFilter) this.texture.minFilter = minFilter;\n    if (magFilter) this.texture.magFilter = magFilter;\n    if (format) this.texture.format = format;\n\n\n    this.pigmentMat = new MeshBasicMaterial({\n      color: new Color(color),\n      map: this.texture,\n      depthTest,\n      depthWrite,\n    });\n\n    this.pigment = new Mesh(this.pigmentGeo, this.pigmentMat);\n    this.pigment.frustumCulled = false;\n\n    this.scene.add(this.pigment);\n\n    this._gainFrameSize();\n  }\n\n  /**\n   * gain frame size, and to adjust aspect\n   */\n  _gainFrameSize() {\n    const image = this.texture.image;\n    if (!image) return;\n    if (image.width > 0 && image.height > 0) {\n      this._setAspect(image.width / image.height);\n    } else {\n      image.addEventListener('load', () => {\n        this._setAspect(image.width / image.height);\n      });\n    }\n  }\n\n  /**\n   * update positions attribute\n   */\n  update() {\n    if (this.autoCover) this._updateAttributes();\n  }\n\n  /**\n   * render this primer\n   * @param {WebGLRenderer} renderer put webgl renderer\n   * @param {WebGLRenderTarget} rednerTarget render to which buffer\n   */\n  render(renderer, rednerTarget) {\n    this.update();\n    renderer.render(this.scene, this.camera, rednerTarget);\n  }\n}\n\nexport default TexturePrimer;\n","import { Group, Matrix4 } from 'three';\n\n/**\n * anchor class, help your to bind interaction event\n */\nclass AnchorBase extends Group {\n  /**\n   * help you caculate anchor position, relative which parent\n   *\n   * @param {Vector3} point global position relative camera\n   * @param {Object3D} parent relative which parent\n   * @return {Vector3} position relative parent coordinate system\n   */\n  putWhere(point, parent) {\n    point.multiplyScalar(0.9);\n    point.applyMatrix4(new Matrix4().getInverse(parent.matrixWorld));\n    this.position.set(point.x, point.y, point.z);\n    this.lookAt(0, 0, 0);\n    return point;\n  }\n\n  /**\n   * put anchor to which posotion, position was relative it's parent\n   *\n   * @param {Vector3} position position was relative it's parent\n   */\n  putHere(position) {\n    this.position.set(position.x, position.y, position.z);\n    this.lookAt(0, 0, 0);\n  }\n}\n\nexport default AnchorBase;\n","import { Group, Mesh, CircleBufferGeometry, PlaneBufferGeometry, MeshBasicMaterial, Color, TextureLoader } from 'three';\nimport Utils from '../../utils/Utils';\nimport AnchorBase from './AnchorBase';\nimport Tween from '../../utils/Tween';\n\n/**\n * anchor class, help your to bind interaction event\n */\nclass AnchorRippling extends AnchorBase {\n  /**\n   * 构造函数\n   * @param {Object} options 配置\n   * @param {String} [options.image] 点击区域的半径\n   * @param {Number} [options.width=8] 点击区域的半径\n   * @param {Number} [options.height=8] 点击区域的半径\n   * @param {Number} [options.segmentation=4] 点击区域的圆细分\n   * @param {Boolean} [options.rippling=false] 点击区域的圆细分\n   * @param {Number} [options.radius=8] 点击区域的半径\n   * @param {Number} [options.segmentationRip=8] 点击区域的半径\n   * @param {Color} [options.color=0xffffff] 点击区域的圆细分\n   * @param {Number} [options.count=2] 点击区域的圆细分\n   * @param {Number} [options.duration=1000] 点击区域的圆细分\n   */\n  constructor(options) {\n    super();\n    const { image, width, height, segmentation = 4, rippling, radius = 8, segmentationRip = 16, color, count = 2, duration = 1800 } = options || {};\n    /**\n     * global texture for stars\n     * @member {Texture}\n     */\n    this.map = Utils.isString(image) ? new TextureLoader().load(image) : null;\n\n    this.waves = new Group();\n    this.waves.position.z = -0.1;\n    this.uiFace = new Mesh(\n      new PlaneBufferGeometry(width, height, segmentation, segmentation),\n      new MeshBasicMaterial({ map: this.map, transparent: true })\n    );\n\n    if (rippling) this.initRippling(radius, segmentationRip, color, count, duration);\n\n    this.add(this.uiFace);\n  }\n\n  initRippling(radius, segmentation, color, count, duration) {\n    const waitTime = duration / count;\n    for (let i = 0; i <= count; i++) {\n      const last = i === count;\n      const circle = new Mesh(\n        new CircleBufferGeometry(radius, segmentation),\n        new MeshBasicMaterial({ color: new Color(color), transparent: true, depthTest: false })\n      );\n      if (!last) {\n        const wait = waitTime * i;\n        circle.runners({\n          runners: [\n            { from: { 'material.opacity': 0.1 }, to: { scaleXYZ: 1.25, 'material.opacity': 0.5 }, duration: duration * 0.4, ease: Tween.Linear.None },\n            { to: { scaleXYZ: 1.5, 'material.opacity': 0 }, duration: duration * 0.6, ease: Tween.Linear.None },\n          ],\n          wait,\n          infinite: true,\n        });\n      }\n\n      this.waves.add(circle);\n    }\n    this.add(this.waves);\n  }\n}\n\nexport default AnchorRippling;\n","import { Camera, Object3D, Group, TextureLoader, Mesh, SphereBufferGeometry, MeshBasicMaterial, DoubleSide, Vector2, Vector3 } from 'three';\nimport Utils from '../../utils/Utils';\n\nconst RATIO = 0.15;\nconst RANGE = 60;\nconst PI2 = Math.PI * 2;\nconst START = new Vector2();\nconst END = new Vector2();\nconst UP = new Vector3(0, 1, 0);\n\n/**\n * 球面全景图组件，快速实现可交互的全景图\n */\nclass SphereWorld extends Object3D {\n  /**\n   * 构造函数\n   * @param {Object} options 配置\n   * @param {String} options.url 球面全景图的链接地址\n   * @param {Boolean} [options.flipX=true] 球面全景图纹理是否做水平翻转\n   * @param {Boolean} [options.flipY=false] 球面全景图纹理是否做垂直翻转\n   * @param {Boolean} [options.draggable=true] 球面全景图是否可拖拽\n   * @param {Number} [options.rangeMin=-60] Y轴拖拽的范围限制下限\n   * @param {Number} [options.rangeMax=60] Y轴拖拽的范围限制上限\n   * @param {Number} [options.driftX=0] 相对于摄像机的X轴旋转的修正角度\n   * @param {Number} [options.driftY=0] 相对于摄像机的Y轴旋转的修正角度\n   * @param {Number} [options.rotateSpeed=1] 球面全景图的旋转灵敏度\n   * @param {Number} [options.radius=1000] 球面全景图的球体半径\n   * @param {Number} [options.segmentationX=32] 球面全景图的球面横轴细分\n   * @param {Number} [options.segmentationY=32] 球面全景图的球面纵轴细分\n   */\n  constructor({ url, radius, segmentationX, segmentationY, flipX, flipY, draggable, rotateSpeed, rangeMin, rangeMax, driftX, driftY }) {\n    super();\n\n    this.needCamera = true;\n\n    this.needMount = true;\n\n    this.inner = new Group();\n    this.camera = null;\n\n    radius = radius || 1000;\n    segmentationX = segmentationX || 32;\n    segmentationY = segmentationY || 32;\n    driftX = Utils.isNumber(driftX) ? driftX : 0;\n    driftY = Utils.isNumber(driftY) ? driftY : 0;\n\n    this.background = new Mesh(\n      new SphereBufferGeometry(radius, segmentationX, segmentationY),\n      new MeshBasicMaterial({ map: new TextureLoader().load(url), side: DoubleSide })\n    );\n\n    flipX = Utils.isBoolean(flipX) ? flipX : true;\n    flipY = Utils.isBoolean(flipY) ? flipY : false;\n    if (flipX) {\n      this.background.scale.x = -1;\n    }\n    if (flipY) {\n      this.background.scale.y = -1;\n    }\n\n    this.inner.add(this.background);\n    super.add.call(this, this.inner);\n\n    this._onStart = this._onStart.bind(this);\n    this._onMove = this._onMove.bind(this);\n    this._onEnd = this._onEnd.bind(this);\n    this._draggable = false;\n    this._dragX = 0;\n    this.updateTracking = this.updateTracking.bind(this);\n    this.rotateSpeed = rotateSpeed || 1;\n    this.cx = 0;\n    this.cy = 0;\n    this.rangeMin = rangeMin || Utils.DTR(-RANGE);\n    this.rangeMax = rangeMax || Utils.DTR(RANGE);\n    this.eared = false;\n    this.draggable = Utils.isBoolean(draggable) ? draggable : true;\n    this.updateDrag({\n      dragY: driftX,\n      dragX: driftY,\n    });\n  }\n\n  /**\n   * set camera\n   * @param {PerspectiveCamera} camera scene camera, panorama need get camera pose state\n   */\n  setCamera(camera) {\n    if (camera instanceof Camera) {\n      this.camera = camera;\n    }\n  }\n\n  onDragChange() {\n    if (this.draggable) {\n      this.on('pretimeline', this.updateTracking);\n      this.addEvents();\n    } else {\n      this.off('pretimeline', this.updateTracking);\n      this.removeEvents();\n    }\n  }\n\n  addEvents() {\n    if (this.eared) return;\n    this.on('touchstart', this._onStart);\n    this.on('touchmove', this._onMove);\n    this.on('touchend', this._onEnd);\n    this.on('mousedown', this._onStart);\n    this.on('mousemove', this._onMove);\n    this.on('mouseup', this._onEnd);\n    this.eared = true;\n  }\n\n  removeEvents() {\n    this.off('touchstart', this._onStart);\n    this.off('touchmove', this._onMove);\n    this.off('touchend', this._onEnd);\n    this.off('mousedown', this._onStart);\n    this.off('mousemove', this._onMove);\n    this.off('mouseup', this._onEnd);\n    this.eared = false;\n  }\n\n  _onStart(ev) {\n    const originalEvent = ev.data.originalEvent;\n    if (originalEvent.touches && originalEvent.touches.length > 1) return;\n    this.hadStart = true;\n    if (originalEvent.touches) {\n      START.x = originalEvent.touches[0].pageX;\n      START.y = originalEvent.touches[0].pageY;\n    } else {\n      START.x = originalEvent.pageX;\n      START.y = originalEvent.pageY;\n    }\n    this.cx = this.dragX;\n    this.cy = this.inner.rotation.y;\n  }\n  _onMove(ev) {\n    const originalEvent = ev.data.originalEvent;\n    if (!this.hadStart || (originalEvent.touches && originalEvent.touches.length > 1)) return;\n    originalEvent.preventDefault();\n    if (originalEvent.touches) {\n      END.x = originalEvent.touches[0].pageX;\n      END.y = originalEvent.touches[0].pageY;\n    } else {\n      END.x = originalEvent.pageX;\n      END.y = originalEvent.pageY;\n    }\n    END.sub(START);\n\n    const x = END.y * RATIO * this.rotateSpeed;\n    const y = END.x * RATIO * this.rotateSpeed;\n\n    const dragX = this.cx + Utils.DTR(x);\n    const dragY = this.cy - Utils.DTR(y);\n    this.updateDrag({\n      dragX,\n      dragY,\n    });\n  }\n  _onEnd() {\n    this.hadStart = false;\n    this.cx = this.dragX;\n    this.cy = this.dragY;\n  }\n\n  updateDrag({ dragX, dragY }) {\n    this.dragX = Utils.isNumber(dragX) ? dragX : this.dragX;\n    this.dragY = Utils.isNumber(dragY) ? dragY : this.dragY;\n  }\n\n  updateTracking() {\n    if (!this.camera) return;\n    const vector = new Vector3(0, 0, -1);\n    vector.applyQuaternion(this.camera.quaternion);\n    this.quaternion.setFromAxisAngle(new Vector3().crossVectors(UP, vector), this.dragX);\n  }\n\n  /**\n   * 添加绘制对象\n   *\n   * @param {THREE.Object3D} child 添加的绘制对象\n   */\n  add() {\n    this.inner.add.apply(this.inner, arguments);\n  }\n\n  /**\n   * 移除绘制对象\n   *\n   * @param {THREE.Object3D} child 之前添加的绘制对象\n   */\n  remove() {\n    this.inner.remove.apply(this.inner, arguments);\n  }\n\n  /**\n   * getter whether draggable or not\n   */\n  get draggable() {\n    return this._draggable;\n  }\n\n  /**\n   * setter whether draggable or not\n   * @param {Boolean} value whether or not\n   */\n  set draggable(value) {\n    if (value !== this._draggable) {\n      this._draggable = value;\n      this.onDragChange();\n    }\n  }\n\n  /**\n   * getter dragX of this panorama\n   */\n  get dragX() {\n    return this._dragX;\n  }\n\n  /**\n   * setter dragX of this panorama\n   * @param {Number} radian rotation radian\n   */\n  set dragX(radian) {\n    radian = Utils.clamp(radian, this.rangeMin, this.rangeMax);\n    if (radian !== this._dragX) {\n      this._dragX = radian;\n    }\n  }\n\n  /**\n   * getter dragY of this panorama\n   */\n  get dragY() {\n    return this.inner.rotation.y;\n  }\n\n  /**\n   * setter dragY of this panorama\n   * @param {Number} radian rotation radian\n   */\n  set dragY(radian) {\n    radian = Utils.euclideanModulo(radian, PI2);\n    if (radian !== this.inner.rotation.y) {\n      this.inner.rotation.y = radian;\n    }\n  }\n}\n\nexport default SphereWorld;\n","import { Object3D, TextureLoader, Mesh, CylinderBufferGeometry, MeshBasicMaterial, DoubleSide, Vector2, Vector3 } from 'three';\nimport Utils from '../../utils/Utils';\nimport Orienter from '../../utils/Orienter';\n\nconst RATIO = 0.15;\nconst RANGE = 50;\nconst START = new Vector2();\nconst END = new Vector2();\n\n/**\n * 柱面全景图组件，快速实现可交互的全景图\n */\nclass CylinderWorld extends Object3D {\n  /**\n   * 构造函数\n   * @param {Object} options 配置\n   * @param {String} options.url 柱面全景图的链接地址\n   * @param {Number} [options.radius=512] 柱面全景图的球体半径\n   * @param {Number} [options.height=1000] 柱面全景图的球体半径\n   * @param {Number} [options.radiusSegments=64] 柱面全景图的柱面横轴细分\n   * @param {Number} [options.heightSegments=1] 柱面全景图的柱面纵轴细分\n   * @param {Boolean} [options.draggable=true] 柱面全景图是否可拖拽\n   * @param {Number} [options.zoomIn=true] 是否开启景深变化的效果\n   * @param {Number} [options.rangeMin=-50] 相对于摄像机的X轴旋转的范围限制下限\n   * @param {Number} [options.rangeMax=50] 相对于摄像机的X轴旋转的范围限制上限\n   * @param {Number} [options.driftX=0] 相对于摄像机的X轴旋转的修正角度\n   * @param {Number} [options.driftY=0] 相对于摄像机的Y轴旋转的修正角度\n   * @param {Number} [options.rotateSpeed=1] 柱面全景图的拖拽灵敏度\n   * @param {Number} [options.strength=0.3] 柱面全景图的陀螺仪灵敏度\n   * @param {Number} [options.viscosity=0.1] 平滑过渡的粘性\n   * @param {Number} [options.openEnded=true] 柱面全景图的两端是否开放\n   * @param {Boolean} [options.flipX=true] 柱面全景图纹理是否做水平翻转\n   * @param {Boolean} [options.flipY=false] 柱面全景图纹理是否做垂直翻转\n   */\n  constructor({ url, radius, height, radiusSegments, heightSegments, openEnded, flipX, flipY, draggable, zoomIn, rotateSpeed, strength, viscosity, rangeMin, rangeMax, driftX, driftY }) {\n    super();\n\n    this.needMount = true;\n\n    radius = radius || 512;\n    height = height || 1000;\n    radiusSegments = radiusSegments || 64;\n    heightSegments = heightSegments || 1;\n    openEnded = Utils.isBoolean(openEnded) ? openEnded : true;\n\n    this.background = new Mesh(\n      new CylinderBufferGeometry(radius, radius, height, radiusSegments, heightSegments, openEnded),\n      new MeshBasicMaterial({ map: new TextureLoader().load(url), side: DoubleSide })\n    );\n\n    flipX = Utils.isBoolean(flipX) ? flipX : true;\n    flipY = Utils.isBoolean(flipY) ? flipY : false;\n    if (flipX) {\n      this.background.scale.x = -1;\n    }\n    if (flipY) {\n      this.background.scale.y = -1;\n    }\n\n    this.add(this.background);\n\n    this._onStart = this._onStart.bind(this);\n    this._onMove = this._onMove.bind(this);\n    this._onEnd = this._onEnd.bind(this);\n\n    this._draggable = false;\n\n    this.rotateSpeed = rotateSpeed || 1;\n    this.strength = strength || 0.3;\n    this.viscosity = viscosity || 0.1;\n    this.rangeMin = rangeMin || -RANGE;\n    this.rangeMax = rangeMax || RANGE;\n    this.eared = false;\n    this.draggable = Utils.isBoolean(draggable) ? draggable : true;\n    this.zoomIn = Utils.isBoolean(zoomIn) ? zoomIn : true;\n\n    this.gyro = new Orienter();\n    this.drag = new Vector3();\n    this.updateDrag = this.updateDrag.bind(this);\n    this.on('pretimeline', this.updateDrag);\n\n    this.driftX = Utils.isNumber(driftX) ? driftX : 0;\n    this.driftY = Utils.isNumber(driftY) ? driftY : 0;\n  }\n\n  onDragChange() {\n    if (this.draggable) {\n      this.addEvents();\n    } else {\n      this.removeEvents();\n    }\n  }\n\n  addEvents() {\n    if (this.eared) return;\n    this.on('touchstart', this._onStart);\n    this.on('touchmove', this._onMove);\n    this.on('touchend', this._onEnd);\n    this.on('mousedown', this._onStart);\n    this.on('mousemove', this._onMove);\n    this.on('mouseup', this._onEnd);\n    this.eared = true;\n  }\n\n  removeEvents() {\n    this.off('touchstart', this._onStart);\n    this.off('touchmove', this._onMove);\n    this.off('touchend', this._onEnd);\n    this.off('mousedown', this._onStart);\n    this.off('mousemove', this._onMove);\n    this.off('mouseup', this._onEnd);\n    this.eared = false;\n  }\n\n  _onStart(ev) {\n    const originalEvent = ev.data.originalEvent;\n    if (originalEvent.touches && originalEvent.touches.length > 1) return;\n    this.hadStart = true;\n    if (originalEvent.touches) {\n      START.x = originalEvent.touches[0].pageX;\n      START.y = originalEvent.touches[0].pageY;\n    } else {\n      START.x = originalEvent.pageX;\n      START.y = originalEvent.pageY;\n    }\n  }\n  _onMove(ev) {\n    const originalEvent = ev.data.originalEvent;\n    if (!this.hadStart || (originalEvent.touches && originalEvent.touches.length > 1)) return;\n    originalEvent.preventDefault();\n    if (originalEvent.touches) {\n      END.x = originalEvent.touches[0].pageX;\n      END.y = originalEvent.touches[0].pageY;\n    } else {\n      END.x = originalEvent.pageX;\n      END.y = originalEvent.pageY;\n    }\n    const DIFF = new Vector2()\n      .copy(END)\n      .sub(START)\n      .multiplyScalar(RATIO * this.rotateSpeed);\n    this.drag.x = Utils.clamp(this.drag.x - DIFF.y, this.rangeMin, this.rangeMax);\n    this.drag.y = Utils.euclideanModulo(this.drag.y - DIFF.x, 360);\n    START.copy(END);\n  }\n  _onEnd() {\n    this.hadStart = false;\n  }\n\n  updateDrag() {\n    const target = Utils.euclideanModulo(this.drag.y - this.gyro.lon, 360);\n    const breaking = target - this.dragY;\n    let compensate = 0;\n    if (breaking > 180) compensate = 360;\n    if (breaking < -180) compensate = -360;\n    const speed = new Vector2(\n      (this.drag.x - this.gyro.lat * this.strength) - this.dragX,\n      target - (this.dragY + compensate)\n    );\n\n    if (this.zoomIn) {\n      const zoomIn = -Utils.clamp(Math.abs(5 * speed.length()), 0, 200) - this.position.z;\n      this.position.z += zoomIn * this.viscosity * 2;\n    } else {\n      this.position.z = 0;\n    }\n\n    if (Math.abs(speed.y) > 1) {\n      this.dragY += speed.y * this.viscosity;\n    }\n    if (Math.abs(speed.x) > 1) {\n      this.dragX += speed.x * this.viscosity;\n    }\n  }\n\n  /**\n   * getter whether draggable or not\n   */\n  get draggable() {\n    return this._draggable;\n  }\n\n  /**\n   * setter whether draggable or not\n   * @param {Boolean} value whether or not\n   */\n  set draggable(value) {\n    if (value !== this._draggable) {\n      this._draggable = value;\n      this.onDragChange();\n    }\n  }\n\n  /**\n   * getter dragX of this panorama\n   */\n  get dragX() {\n    return Utils.RTD(this.rotation.x);\n  }\n\n  /**\n   * setter dragX of this panorama\n   * @param {Number} degree rotation degree\n   */\n  set dragX(degree) {\n    degree = Utils.clamp(degree, -90, 90);\n    if (degree !== this.dragX) {\n      this.rotation.x = Utils.DTR(degree);\n    }\n  }\n\n  /**\n   * getter dragY of this panorama\n   */\n  get dragY() {\n    return Utils.RTD(this.rotation.y);\n  }\n\n  /**\n   * setter dragY of this panorama\n   * @param {Number} degree rotation degree\n   */\n  set dragY(degree) {\n    degree = Utils.euclideanModulo(degree, 360);\n    if (degree !== this.dragY) {\n      this.rotation.y = Utils.DTR(degree);\n    }\n  }\n\n  /**\n   * getter driftY of this panorama\n   */\n  get driftY() {\n    return Utils.RTD(this.background.rotation.y);\n  }\n\n  /**\n   * setter driftY of this panorama\n   * @param {Number} degree rotation degree\n   */\n  set driftY(degree) {\n    degree = Utils.euclideanModulo(degree, 360);\n    if (degree !== this.driftY) {\n      this.background.rotation.y = Utils.DTR(degree);\n    }\n  }\n\n  /**\n   * getter driftX of this panorama\n   */\n  get driftX() {\n    return this.drag.x;\n  }\n\n  /**\n   * setter driftX of this panorama\n   * @param {Number} degree rotation degree\n   */\n  set driftX(degree) {\n    degree = Utils.clamp(degree, this.rangeMin, this.rangeMax);\n    if (degree !== this.driftX) {\n      this.drag.x = degree;\n    }\n  }\n}\n\nexport default CylinderWorld;\n","import {\n  FileLoader,\n  DefaultLoadingManager,\n  Loader,\n  Color,\n  DirectionalLight,\n  PointLight,\n  SpotLight,\n  AmbientLight,\n  MeshPhongMaterial,\n  MeshLambertMaterial,\n  MeshBasicMaterial,\n  ShaderMaterial,\n  ShaderLib,\n  UniformsUtils,\n  Vector2,\n  NearestFilter,\n  LinearFilter,\n  NearestMipMapNearestFilter,\n  LinearMipMapNearestFilter,\n  NearestMipMapLinearFilter,\n  LinearMipMapLinearFilter,\n  ClampToEdgeWrapping,\n  MirroredRepeatWrapping,\n  RepeatWrapping,\n  AlphaFormat,\n  RGBFormat,\n  RGBAFormat,\n  LuminanceFormat,\n  LuminanceAlphaFormat,\n  UnsignedByteType,\n  UnsignedShort4444Type,\n  UnsignedShort5551Type,\n  UnsignedShort565Type,\n  // BackSide,\n  FrontSide,\n  // NeverDepth,\n  // LessDepth,\n  // EqualDepth,\n  // LessEqualDepth,\n  // GreaterEqualDepth,\n  // NotEqualDepth,\n  // AlwaysDepth,\n  // AddEquation,\n  // SubtractEquation,\n  // ReverseSubtractEquation,\n  // ZeroFactor,\n  // OneFactor,\n  // SrcColorFactor,\n  // OneMinusSrcColorFactor,\n  // SrcAlphaFactor,\n  // OneMinusSrcAlphaFactor,\n  // DstAlphaFactor,\n  // OneMinusDstAlphaFactor,\n  // DstColorFactor,\n  // OneMinusDstColorFactor,\n  // SrcAlphaSaturateFactor,\n  InterpolateSmooth,\n  InterpolateLinear,\n  InterpolateDiscrete,\n  MeshStandardMaterial,\n  InterleavedBuffer,\n  InterleavedBufferAttribute,\n  BufferAttribute,\n  TextureLoader,\n  DoubleSide,\n  BufferGeometry,\n  Group,\n  VertexColors,\n  FlatShading,\n  Mesh,\n  TriangleStripDrawMode,\n  TriangleFanDrawMode,\n  LineSegments,\n  Line,\n  LineLoop,\n  Points,\n  PerspectiveCamera,\n  OrthographicCamera,\n  NumberKeyframeTrack,\n  QuaternionKeyframeTrack,\n  VectorKeyframeTrack,\n  AnimationUtils,\n  AnimationClip,\n  Matrix4,\n  Bone,\n  Object3D,\n  PropertyBinding,\n  SkinnedMesh,\n  Skeleton,\n  Scene,\n} from 'three';\n\n\n// const BINARY_EXTENSION_BUFFER_NAME = 'binary_glTF';\nconst BINARY_EXTENSION_HEADER_MAGIC = 'glTF';\nconst BINARY_EXTENSION_HEADER_LENGTH = 12;\nconst BINARY_EXTENSION_CHUNK_TYPES = {\n  JSON: 0x4E4F534A,\n  BIN: 0x004E4942,\n};\n\nconst EXTENSIONS = {\n  KHR_BINARY_GLTF: 'KHR_binary_glTF',\n  KHR_LIGHTS: 'KHR_lights',\n  KHR_MATERIALS_COMMON: 'KHR_materials_common',\n  KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS: 'KHR_materials_pbrSpecularGlossiness',\n};\n\nfunction GLTFLoader(manager) {\n\n  this.manager = (manager !== undefined) ? manager : DefaultLoadingManager;\n\n}\n\nGLTFLoader.prototype = {\n\n  constructor: GLTFLoader,\n\n  crossOrigin: 'Anonymous',\n\n  load(url, onLoad, onProgress, onError) {\n\n    const scope = this;\n\n    const path = this.path && (typeof this.path === 'string') ? this.path : Loader.prototype.extractUrlBase(url);\n\n    const loader = new FileLoader(scope.manager);\n\n    loader.setResponseType('arraybuffer');\n\n    loader.load(url, function(data) {\n\n      try {\n\n        scope.parse(data, path, onLoad, onError);\n\n      } catch (e) {\n\n        // For SyntaxError or TypeError, return a generic failure message.\n        onError(e.constructor === Error ? e : new Error('GLTFLoader: Unable to parse model.'));\n\n      }\n\n    }, onProgress, onError);\n\n  },\n\n  setCrossOrigin(value) {\n\n    this.crossOrigin = value;\n\n  },\n\n  setPath(value) {\n\n    this.path = value;\n\n  },\n\n  parse(data, path, onLoad, onError) {\n\n    let content;\n    const extensions = {};\n\n    const magic = convertUint8ArrayToString(new Uint8Array(data, 0, 4));\n\n    if (magic === BINARY_EXTENSION_HEADER_MAGIC) {\n\n      extensions[EXTENSIONS.KHR_BINARY_GLTF] = new GLTFBinaryExtension(data);\n      content = extensions[EXTENSIONS.KHR_BINARY_GLTF].content;\n\n    } else {\n\n      content = convertUint8ArrayToString(new Uint8Array(data));\n\n    }\n\n    const json = JSON.parse(content);\n\n    if (json.asset === undefined || json.asset.version[0] < 2) {\n\n      onError(new Error('GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.'));\n      return;\n\n    }\n\n    if (json.extensionsUsed) {\n\n      if (json.extensionsUsed.indexOf(EXTENSIONS.KHR_LIGHTS) >= 0) {\n\n        extensions[EXTENSIONS.KHR_LIGHTS] = new GLTFLightsExtension(json);\n\n      }\n\n      if (json.extensionsUsed.indexOf(EXTENSIONS.KHR_MATERIALS_COMMON) >= 0) {\n\n        extensions[EXTENSIONS.KHR_MATERIALS_COMMON] = new GLTFMaterialsCommonExtension(json);\n\n      }\n\n      if (json.extensionsUsed.indexOf(EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS) >= 0) {\n\n        extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS] = new GLTFMaterialsPbrSpecularGlossinessExtension();\n\n      }\n\n    }\n\n    console.time('GLTFLoader');\n\n    const parser = new GLTFParser(json, extensions, {\n\n      path: path || this.path,\n      crossOrigin: this.crossOrigin,\n\n    });\n\n    parser.parse(function(scene, scenes, cameras, animations) {\n\n      console.timeEnd('GLTFLoader');\n\n      const glTF = {\n        scene,\n        scenes,\n        cameras,\n        animations,\n      };\n\n      onLoad(glTF);\n\n    }, onError);\n\n  },\n\n};\n\n/* GLTFREGISTRY */\n\nfunction GLTFRegistry() {\n\n  let objects = {};\n\n  return {\n\n    get(key) {\n\n      return objects[key];\n\n    },\n\n    add(key, object) {\n\n      objects[key] = object;\n\n    },\n\n    remove(key) {\n\n      delete objects[key];\n\n    },\n\n    removeAll() {\n\n      objects = {};\n\n    },\n\n    update(scene, camera) {\n\n      for (const name in objects) {\n\n        const object = objects[name];\n\n        if (object.update) {\n\n          object.update(scene, camera);\n\n        }\n\n      }\n\n    },\n\n  };\n\n}\n\n/**\n * Lights Extension\n *\n * Specification: PENDING\n * @param {Object} json config\n */\nfunction GLTFLightsExtension(json) {\n\n  this.name = EXTENSIONS.KHR_LIGHTS;\n\n  this.lights = {};\n\n  const extension = (json.extensions && json.extensions[EXTENSIONS.KHR_LIGHTS]) || {};\n  const lights = extension.lights || {};\n\n  for (const lightId in lights) {\n\n    const light = lights[lightId];\n    let lightNode;\n\n    const color = new Color().fromArray(light.color);\n\n    switch (light.type) {\n\n      case 'directional':\n        lightNode = new DirectionalLight(color);\n        lightNode.position.set(0, 0, 1);\n        break;\n\n      case 'point':\n        lightNode = new PointLight(color);\n        break;\n\n      case 'spot':\n        lightNode = new SpotLight(color);\n        lightNode.position.set(0, 0, 1);\n        break;\n\n      case 'ambient':\n        lightNode = new AmbientLight(color);\n        break;\n\n      default :\n        break;\n\n    }\n\n    if (lightNode) {\n\n      if (light.constantAttenuation !== undefined) {\n\n        lightNode.intensity = light.constantAttenuation;\n\n      }\n\n      if (light.linearAttenuation !== undefined) {\n\n        lightNode.distance = 1 / light.linearAttenuation;\n\n      }\n\n      if (light.quadraticAttenuation !== undefined) {\n\n        lightNode.decay = light.quadraticAttenuation;\n\n      }\n\n      if (light.fallOffAngle !== undefined) {\n\n        lightNode.angle = light.fallOffAngle;\n\n      }\n\n      if (light.fallOffExponent !== undefined) {\n\n        console.warn('GLTFLoader:: light.fallOffExponent not currently supported.');\n\n      }\n\n      lightNode.name = light.name || ('light_' + lightId);\n      this.lights[lightId] = lightNode;\n\n    }\n\n  }\n\n}\n\n/**\n * Common Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/Khronos/KHR_materials_common\n */\nfunction GLTFMaterialsCommonExtension() {\n\n  this.name = EXTENSIONS.KHR_MATERIALS_COMMON;\n\n}\n\nGLTFMaterialsCommonExtension.prototype.getMaterialType = function(material) {\n\n  const khrMaterial = material.extensions[this.name];\n\n  switch (khrMaterial.type) {\n\n    case 'commonBlinn':\n    case 'commonPhong':\n      return MeshPhongMaterial;\n\n    case 'commonLambert':\n      return MeshLambertMaterial;\n\n    case 'commonConstant':\n    default:\n      return MeshBasicMaterial;\n\n  }\n\n};\n\nGLTFMaterialsCommonExtension.prototype.extendParams = function(materialParams, material, parser) {\n\n  const khrMaterial = material.extensions[this.name];\n\n  const pending = [];\n\n  const keys = [];\n\n  // TODO: Currently ignored: 'ambientFactor', 'ambientTexture'\n  switch (khrMaterial.type) {\n\n    case 'commonBlinn':\n    case 'commonPhong':\n      keys.push('diffuseFactor', 'diffuseTexture', 'specularFactor', 'specularTexture', 'shininessFactor');\n      break;\n\n    case 'commonLambert':\n      keys.push('diffuseFactor', 'diffuseTexture');\n      break;\n\n    case 'commonConstant':\n    default:\n      break;\n\n  }\n\n  const materialValues = {};\n\n  keys.forEach(function(v) {\n\n    if (khrMaterial[v] !== undefined) materialValues[v] = khrMaterial[v];\n\n  });\n\n  if (materialValues.diffuseFactor !== undefined) {\n\n    materialParams.color = new Color().fromArray(materialValues.diffuseFactor);\n    materialParams.opacity = materialValues.diffuseFactor[3];\n\n  }\n\n  if (materialValues.diffuseTexture !== undefined) {\n\n    pending.push(parser.assignTexture(materialParams, 'map', materialValues.diffuseTexture.index));\n\n  }\n\n  if (materialValues.specularFactor !== undefined) {\n\n    materialParams.specular = new Color().fromArray(materialValues.specularFactor);\n\n  }\n\n  if (materialValues.specularTexture !== undefined) {\n\n    pending.push(parser.assignTexture(materialParams, 'specularMap', materialValues.specularTexture.index));\n\n  }\n\n  if (materialValues.shininessFactor !== undefined) {\n\n    materialParams.shininess = materialValues.shininessFactor;\n\n  }\n\n  return Promise.all(pending);\n\n};\n\n/* BINARY EXTENSION */\n\nfunction GLTFBinaryExtension(data) {\n\n  this.name = EXTENSIONS.KHR_BINARY_GLTF;\n  this.content = null;\n  this.body = null;\n\n  const headerView = new DataView(data, 0, BINARY_EXTENSION_HEADER_LENGTH);\n\n  this.header = {\n    magic: convertUint8ArrayToString(new Uint8Array(data.slice(0, 4))),\n    version: headerView.getUint32(4, true),\n    length: headerView.getUint32(8, true),\n  };\n\n  if (this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC) {\n\n    throw new Error('GLTFLoader: Unsupported glTF-Binary header.');\n\n  } else if (this.header.version < 2.0) {\n\n    throw new Error('GLTFLoader: Legacy binary file detected. Use GLTFLoader instead.');\n\n  }\n\n  const chunkView = new DataView(data, BINARY_EXTENSION_HEADER_LENGTH);\n  let chunkIndex = 0;\n\n  while (chunkIndex < chunkView.byteLength) {\n\n    const chunkLength = chunkView.getUint32(chunkIndex, true);\n    chunkIndex += 4;\n\n    const chunkType = chunkView.getUint32(chunkIndex, true);\n    chunkIndex += 4;\n\n    if (chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON) {\n\n      const contentArray = new Uint8Array(data, BINARY_EXTENSION_HEADER_LENGTH + chunkIndex, chunkLength);\n      this.content = convertUint8ArrayToString(contentArray);\n\n    } else if (chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN) {\n\n      const byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;\n      this.body = data.slice(byteOffset, byteOffset + chunkLength);\n\n    }\n\n    // Clients must ignore chunks with unknown types.\n\n    chunkIndex += chunkLength;\n\n  }\n\n  if (this.content === null) {\n\n    throw new Error('GLTFLoader: JSON content not found.');\n\n  }\n\n}\n\n/**\n * Specular-Glossiness Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/Khronos/KHR_materials_pbrSpecularGlossiness\n * @return {Object} extension\n */\nfunction GLTFMaterialsPbrSpecularGlossinessExtension() {\n\n  return {\n\n    name: EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,\n\n    getMaterialType() {\n\n      return ShaderMaterial;\n\n    },\n\n    extendParams(params, material, parser) {\n\n      const pbrSpecularGlossiness = material.extensions[this.name];\n\n      const shader = ShaderLib.standard;\n\n      const uniforms = UniformsUtils.clone(shader.uniforms);\n\n      const specularMapParsFragmentChunk = [\n        '#ifdef USE_SPECULARMAP',\n        '\tuniform sampler2D specularMap;',\n        '#endif',\n      ].join('\\n');\n\n      const glossinessMapParsFragmentChunk = [\n        '#ifdef USE_GLOSSINESSMAP',\n        '\tuniform sampler2D glossinessMap;',\n        '#endif',\n      ].join('\\n');\n\n      const specularMapFragmentChunk = [\n        'vec3 specularFactor = specular;',\n        '#ifdef USE_SPECULARMAP',\n        '\tvec4 texelSpecular = texture2D( specularMap, vUv );',\n        '\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture',\n        '\tspecularFactor *= texelSpecular.rgb;',\n        '#endif',\n      ].join('\\n');\n\n      const glossinessMapFragmentChunk = [\n        'float glossinessFactor = glossiness;',\n        '#ifdef USE_GLOSSINESSMAP',\n        '\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );',\n        '\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture',\n        '\tglossinessFactor *= texelGlossiness.a;',\n        '#endif',\n      ].join('\\n');\n\n      const lightPhysicalFragmentChunk = [\n        'PhysicalMaterial material;',\n        'material.diffuseColor = diffuseColor.rgb;',\n        'material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );',\n        'material.specularColor = specularFactor.rgb;',\n      ].join('\\n');\n\n      const fragmentShader = shader.fragmentShader\n        .replace('#include <specularmap_fragment>', '')\n        .replace('uniform float roughness;', 'uniform vec3 specular;')\n        .replace('uniform float metalness;', 'uniform float glossiness;')\n        .replace('#include <roughnessmap_pars_fragment>', specularMapParsFragmentChunk)\n        .replace('#include <metalnessmap_pars_fragment>', glossinessMapParsFragmentChunk)\n        .replace('#include <roughnessmap_fragment>', specularMapFragmentChunk)\n        .replace('#include <metalnessmap_fragment>', glossinessMapFragmentChunk)\n        .replace('#include <lights_physical_fragment>', lightPhysicalFragmentChunk);\n\n      delete uniforms.roughness;\n      delete uniforms.metalness;\n      delete uniforms.roughnessMap;\n      delete uniforms.metalnessMap;\n\n      uniforms.specular = {\n        value: new Color().setHex(0x111111),\n      };\n      uniforms.glossiness = {\n        value: 0.5,\n      };\n      uniforms.specularMap = {\n        value: null,\n      };\n      uniforms.glossinessMap = {\n        value: null,\n      };\n\n      params.vertexShader = shader.vertexShader;\n      params.fragmentShader = fragmentShader;\n      params.uniforms = uniforms;\n      params.defines = {\n        STANDARD: '',\n      };\n\n      params.color = new Color(1.0, 1.0, 1.0);\n      params.opacity = 1.0;\n\n      const pending = [];\n\n      if (Array.isArray(pbrSpecularGlossiness.diffuseFactor)) {\n\n        const array = pbrSpecularGlossiness.diffuseFactor;\n\n        params.color.fromArray(array);\n        params.opacity = array[3];\n\n      }\n\n      if (pbrSpecularGlossiness.diffuseTexture !== undefined) {\n\n        pending.push(parser.assignTexture(params, 'map', pbrSpecularGlossiness.diffuseTexture.index));\n\n      }\n\n      params.emissive = new Color(0.0, 0.0, 0.0);\n      params.glossiness = pbrSpecularGlossiness.glossinessFactor !== undefined ? pbrSpecularGlossiness.glossinessFactor : 1.0;\n      params.specular = new Color(1.0, 1.0, 1.0);\n\n      if (Array.isArray(pbrSpecularGlossiness.specularFactor)) {\n\n        params.specular.fromArray(pbrSpecularGlossiness.specularFactor);\n\n      }\n\n      if (pbrSpecularGlossiness.specularGlossinessTexture !== undefined) {\n\n        const specGlossIndex = pbrSpecularGlossiness.specularGlossinessTexture.index;\n        pending.push(parser.assignTexture(params, 'glossinessMap', specGlossIndex));\n        pending.push(parser.assignTexture(params, 'specularMap', specGlossIndex));\n\n      }\n\n      return Promise.all(pending);\n\n    },\n\n    createMaterial(params) {\n\n      // setup material properties based on MeshStandardMaterial for Specular-Glossiness\n\n      const material = new ShaderMaterial({\n        defines: params.defines,\n        vertexShader: params.vertexShader,\n        fragmentShader: params.fragmentShader,\n        uniforms: params.uniforms,\n        fog: true,\n        lights: true,\n        opacity: params.opacity,\n        transparent: params.transparent,\n      });\n\n      material.isGLTFSpecularGlossinessMaterial = true;\n\n      material.color = params.color;\n\n      material.map = params.map === undefined ? null : params.map;\n\n      material.lightMap = null;\n      material.lightMapIntensity = 1.0;\n\n      material.aoMap = params.aoMap === undefined ? null : params.aoMap;\n      material.aoMapIntensity = 1.0;\n\n      material.emissive = params.emissive;\n      material.emissiveIntensity = 1.0;\n      material.emissiveMap = params.emissiveMap === undefined ? null : params.emissiveMap;\n\n      material.bumpMap = params.bumpMap === undefined ? null : params.bumpMap;\n      material.bumpScale = 1;\n\n      material.normalMap = params.normalMap === undefined ? null : params.normalMap;\n      material.normalScale = new Vector2(1, 1);\n\n      material.displacementMap = null;\n      material.displacementScale = 1;\n      material.displacementBias = 0;\n\n      material.specularMap = params.specularMap === undefined ? null : params.specularMap;\n      material.specular = params.specular;\n\n      material.glossinessMap = params.glossinessMap === undefined ? null : params.glossinessMap;\n      material.glossiness = params.glossiness;\n\n      material.alphaMap = null;\n\n      material.envMap = params.envMap === undefined ? null : params.envMap;\n      material.envMapIntensity = 1.0;\n\n      material.refractionRatio = 0.98;\n\n      material.extensions.derivatives = true;\n\n      return material;\n\n    },\n\n    // Here's based on refreshUniformsCommon() and refreshUniformsStandard() in WebGLRenderer.\n    refreshUniforms(renderer, scene, camera, geometry, material) {\n\n      const uniforms = material.uniforms;\n      const defines = material.defines;\n\n      uniforms.opacity.value = material.opacity;\n\n      uniforms.diffuse.value.copy(material.color);\n      uniforms.emissive.value.copy(material.emissive).multiplyScalar(material.emissiveIntensity);\n\n      uniforms.map.value = material.map;\n      uniforms.specularMap.value = material.specularMap;\n      uniforms.alphaMap.value = material.alphaMap;\n\n      uniforms.lightMap.value = material.lightMap;\n      uniforms.lightMapIntensity.value = material.lightMapIntensity;\n\n      uniforms.aoMap.value = material.aoMap;\n      uniforms.aoMapIntensity.value = material.aoMapIntensity;\n\n      // uv repeat and offset setting priorities\n      // 1. color map\n      // 2. specular map\n      // 3. normal map\n      // 4. bump map\n      // 5. alpha map\n      // 6. emissive map\n\n      let uvScaleMap;\n\n      if (material.map) {\n\n        uvScaleMap = material.map;\n\n      } else if (material.specularMap) {\n\n        uvScaleMap = material.specularMap;\n\n      } else if (material.displacementMap) {\n\n        uvScaleMap = material.displacementMap;\n\n      } else if (material.normalMap) {\n\n        uvScaleMap = material.normalMap;\n\n      } else if (material.bumpMap) {\n\n        uvScaleMap = material.bumpMap;\n\n      } else if (material.glossinessMap) {\n\n        uvScaleMap = material.glossinessMap;\n\n      } else if (material.alphaMap) {\n\n        uvScaleMap = material.alphaMap;\n\n      } else if (material.emissiveMap) {\n\n        uvScaleMap = material.emissiveMap;\n\n      }\n\n      if (uvScaleMap !== undefined) {\n\n        // backwards compatibility\n        if (uvScaleMap.isWebGLRenderTarget) {\n\n          uvScaleMap = uvScaleMap.texture;\n\n        }\n\n        const offset = uvScaleMap.offset;\n        const repeat = uvScaleMap.repeat;\n\n        uniforms.offsetRepeat.value.set(offset.x, offset.y, repeat.x, repeat.y);\n\n      }\n\n      uniforms.envMap.value = material.envMap;\n      uniforms.envMapIntensity.value = material.envMapIntensity;\n      uniforms.flipEnvMap.value = (material.envMap && material.envMap.isCubeTexture) ? -1 : 1;\n\n      uniforms.refractionRatio.value = material.refractionRatio;\n\n      uniforms.specular.value.copy(material.specular);\n      uniforms.glossiness.value = material.glossiness;\n\n      uniforms.glossinessMap.value = material.glossinessMap;\n\n      uniforms.emissiveMap.value = material.emissiveMap;\n      uniforms.bumpMap.value = material.bumpMap;\n      uniforms.normalMap.value = material.normalMap;\n\n      uniforms.displacementMap.value = material.displacementMap;\n      uniforms.displacementScale.value = material.displacementScale;\n      uniforms.displacementBias.value = material.displacementBias;\n\n      if (uniforms.glossinessMap.value !== null && defines.USE_GLOSSINESSMAP === undefined) {\n\n        defines.USE_GLOSSINESSMAP = '';\n        // set USE_ROUGHNESSMAP to enable vUv\n        defines.USE_ROUGHNESSMAP = '';\n\n      }\n\n      if (uniforms.glossinessMap.value === null && defines.USE_GLOSSINESSMAP !== undefined) {\n\n        delete defines.USE_GLOSSINESSMAP;\n        delete defines.USE_ROUGHNESSMAP;\n\n      }\n\n    },\n\n  };\n\n}\n\n/** *******************************/\n/** ******** INTERNALS ************/\n/** *******************************/\n\n/* CONSTANTS */\n\nconst WEBGL_CONSTANTS = {\n  FLOAT: 5126,\n  // FLOAT_MAT2: 35674,\n  FLOAT_MAT3: 35675,\n  FLOAT_MAT4: 35676,\n  FLOAT_VEC2: 35664,\n  FLOAT_VEC3: 35665,\n  FLOAT_VEC4: 35666,\n  LINEAR: 9729,\n  REPEAT: 10497,\n  SAMPLER_2D: 35678,\n  POINTS: 0,\n  LINES: 1,\n  LINE_LOOP: 2,\n  LINE_STRIP: 3,\n  TRIANGLES: 4,\n  TRIANGLE_STRIP: 5,\n  TRIANGLE_FAN: 6,\n  UNSIGNED_BYTE: 5121,\n  UNSIGNED_SHORT: 5123,\n};\n\n// const WEBGL_TYPE = {\n//   5126: Number,\n//   // 35674: Matrix2,\n//   35675: Matrix3,\n//   35676: Matrix4,\n//   35664: Vector2,\n//   35665: Vector3,\n//   35666: Vector4,\n//   35678: Texture,\n// };\n\nconst WEBGL_COMPONENT_TYPES = {\n  5120: Int8Array,\n  5121: Uint8Array,\n  5122: Int16Array,\n  5123: Uint16Array,\n  5125: Uint32Array,\n  5126: Float32Array,\n};\n\nconst WEBGL_FILTERS = {\n  9728: NearestFilter,\n  9729: LinearFilter,\n  9984: NearestMipMapNearestFilter,\n  9985: LinearMipMapNearestFilter,\n  9986: NearestMipMapLinearFilter,\n  9987: LinearMipMapLinearFilter,\n};\n\nconst WEBGL_WRAPPINGS = {\n  33071: ClampToEdgeWrapping,\n  33648: MirroredRepeatWrapping,\n  10497: RepeatWrapping,\n};\n\nconst WEBGL_TEXTURE_FORMATS = {\n  6406: AlphaFormat,\n  6407: RGBFormat,\n  6408: RGBAFormat,\n  6409: LuminanceFormat,\n  6410: LuminanceAlphaFormat,\n};\n\nconst WEBGL_TEXTURE_DATATYPES = {\n  5121: UnsignedByteType,\n  32819: UnsignedShort4444Type,\n  32820: UnsignedShort5551Type,\n  33635: UnsignedShort565Type,\n};\n\n// const WEBGL_SIDES = {\n//   1028: BackSide, // Culling front\n//   1029: FrontSide, // Culling back\n//   // 1032: NoSide   // Culling front and back, what to do?\n// };\n\n// const WEBGL_DEPTH_FUNCS = {\n//   512: NeverDepth,\n//   513: LessDepth,\n//   514: EqualDepth,\n//   515: LessEqualDepth,\n//   516: GreaterEqualDepth,\n//   517: NotEqualDepth,\n//   518: GreaterEqualDepth,\n//   519: AlwaysDepth,\n// };\n\n// const WEBGL_BLEND_EQUATIONS = {\n//   32774: AddEquation,\n//   32778: SubtractEquation,\n//   32779: ReverseSubtractEquation,\n// };\n\n// const WEBGL_BLEND_FUNCS = {\n//   0: ZeroFactor,\n//   1: OneFactor,\n//   768: SrcColorFactor,\n//   769: OneMinusSrcColorFactor,\n//   770: SrcAlphaFactor,\n//   771: OneMinusSrcAlphaFactor,\n//   772: DstAlphaFactor,\n//   773: OneMinusDstAlphaFactor,\n//   774: DstColorFactor,\n//   775: OneMinusDstColorFactor,\n//   776: SrcAlphaSaturateFactor,\n//   // The followings are not supported by js yet\n//   // 32769: CONSTANT_COLOR,\n//   // 32770: ONE_MINUS_CONSTANT_COLOR,\n//   // 32771: CONSTANT_ALPHA,\n//   // 32772: ONE_MINUS_CONSTANT_COLOR\n// };\n\nconst WEBGL_TYPE_SIZES = {\n  SCALAR: 1,\n  VEC2: 2,\n  VEC3: 3,\n  VEC4: 4,\n  MAT2: 4,\n  MAT3: 9,\n  MAT4: 16,\n};\n\nconst PATH_PROPERTIES = {\n  scale: 'scale',\n  translation: 'position',\n  rotation: 'quaternion',\n  weights: 'morphTargetInfluences',\n};\n\nconst INTERPOLATION = {\n  CATMULLROMSPLINE: InterpolateSmooth,\n  CUBICSPLINE: InterpolateSmooth,\n  LINEAR: InterpolateLinear,\n  STEP: InterpolateDiscrete,\n};\n\n// const STATES_ENABLES = {\n//   2884: 'CULL_FACE',\n//   2929: 'DEPTH_TEST',\n//   3042: 'BLEND',\n//   3089: 'SCISSOR_TEST',\n//   32823: 'POLYGON_OFFSET_FILL',\n//   32926: 'SAMPLE_ALPHA_TO_COVERAGE',\n// };\n\nconst ALPHA_MODES = {\n  OPAQUE: 'OPAQUE',\n  MASK: 'MASK',\n  BLEND: 'BLEND',\n};\n\n/* UTILITY FUNCTIONS */\n\nfunction _each(object, callback, thisObj) {\n\n  if (!object) {\n    return Promise.resolve();\n  }\n\n  let results;\n  const fns = [];\n\n  if (Object.prototype.toString.call(object) === '[object Array]') {\n\n    results = [];\n\n    const length = object.length;\n\n    for (let idx = 0; idx < length; idx++) {\n\n      const value = callback.call(thisObj || this, object[idx], idx);\n\n      if (value) {\n\n        fns.push(value);\n\n        if (value instanceof Promise) {\n          /* eslint no-loop-func: 0 */\n          value.then(function(key, value) {\n\n            results[key] = value;\n\n          }.bind(this, idx));\n\n        } else {\n\n          results[idx] = value;\n\n        }\n\n      }\n\n    }\n\n  } else {\n\n    results = {};\n\n    for (const key in object) {\n\n      if (object.hasOwnProperty(key)) {\n\n        const value = callback.call(thisObj || this, object[key], key);\n\n        if (value) {\n\n          fns.push(value);\n\n          if (value instanceof Promise) {\n\n            value.then(function(key, value) {\n\n              results[key] = value;\n\n            }.bind(this, key));\n\n          } else {\n\n            results[key] = value;\n\n          }\n\n        }\n\n      }\n\n    }\n\n  }\n\n  return Promise.all(fns).then(function() {\n\n    return results;\n\n  });\n\n}\n\nfunction resolveURL(url, path) {\n\n  // Invalid URL\n  if (typeof url !== 'string' || url === '') { return ''; }\n\n  // Absolute URL http://,https://,//\n  if (/^(https?:)?\\/\\//i.test(url)) {\n\n    return url;\n\n  }\n\n  // Data URI\n  if (/^data:.*,.*$/i.test(url)) {\n\n    return url;\n\n  }\n\n  // Blob URL\n  if (/^blob:.*$/i.test(url)) {\n\n    return url;\n\n  }\n\n  // Relative URL\n  return (path || '') + url;\n\n}\n\nfunction convertUint8ArrayToString(array) {\n\n  if (window.TextDecoder !== undefined) {\n\n    return new TextDecoder().decode(array);\n\n  }\n\n  // Avoid the String.fromCharCode.apply(null, array) shortcut, which\n  // throws a \"maximum call stack size exceeded\" error for large arrays.\n\n  let s = '';\n\n  for (let i = 0, il = array.length; i < il; i++) {\n\n    s += String.fromCharCode(array[i]);\n\n  }\n\n  return s;\n\n}\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\n * @return {MeshStandardMaterial} material\n */\nfunction createDefaultMaterial() {\n\n  return new MeshStandardMaterial({\n    color: 0xFFFFFF,\n    emissive: 0x000000,\n    metalness: 1,\n    roughness: 1,\n    transparent: false,\n    depthTest: true,\n    side: FrontSide,\n  });\n\n}\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\n * @param {Mesh} mesh mesh\n * @param {GLTF.Mesh} meshDef meshDef\n * @param {GLTF.Primitive} primitiveDef primitiveDef\n * @param {Object} dependencies dependencies\n */\nfunction addMorphTargets(mesh, meshDef, primitiveDef, dependencies) {\n\n  const geometry = mesh.geometry;\n  const material = mesh.material;\n\n  const targets = primitiveDef.targets;\n  const morphAttributes = geometry.morphAttributes;\n\n  morphAttributes.position = [];\n  morphAttributes.normal = [];\n\n  material.morphTargets = true;\n\n  for (let i = 0, il = targets.length; i < il; i++) {\n\n    const target = targets[i];\n    const attributeName = 'morphTarget' + i;\n\n    let positionAttribute,\n      normalAttribute;\n\n    if (target.POSITION !== undefined) {\n\n      // js morph formula is\n      //   position\n      //     + weight0 * ( morphTarget0 - position )\n      //     + weight1 * ( morphTarget1 - position )\n      //     ...\n      // while the glTF one is\n      //   position\n      //     + weight0 * morphTarget0\n      //     + weight1 * morphTarget1\n      //     ...\n      // then adding position to morphTarget.\n      // So morphTarget value will depend on mesh's position, then cloning attribute\n      // for the case if attribute is shared among two or more meshes.\n\n      positionAttribute = dependencies.accessors[target.POSITION].clone();\n      const position = geometry.attributes.position;\n\n      for (let j = 0, jl = positionAttribute.count; j < jl; j++) {\n\n        positionAttribute.setXYZ(\n          j,\n          positionAttribute.getX(j) + position.getX(j),\n          positionAttribute.getY(j) + position.getY(j),\n          positionAttribute.getZ(j) + position.getZ(j)\n        );\n\n      }\n\n    } else {\n\n      // Copying the original position not to affect the final position.\n      // See the formula above.\n      positionAttribute = geometry.attributes.position.clone();\n\n    }\n\n    if (target.NORMAL !== undefined) {\n\n      material.morphNormals = true;\n\n      // see target.POSITION's comment\n\n      normalAttribute = dependencies.accessors[target.NORMAL].clone();\n      const normal = geometry.attributes.normal;\n\n      for (let j = 0, jl = normalAttribute.count; j < jl; j++) {\n\n        normalAttribute.setXYZ(\n          j,\n          normalAttribute.getX(j) + normal.getX(j),\n          normalAttribute.getY(j) + normal.getY(j),\n          normalAttribute.getZ(j) + normal.getZ(j)\n        );\n\n      }\n\n    } else {\n\n      normalAttribute = geometry.attributes.normal.clone();\n\n    }\n\n    if (target.TANGENT !== undefined) {\n\n      // TODO: implement\n\n    }\n\n    positionAttribute.name = attributeName;\n    normalAttribute.name = attributeName;\n\n    morphAttributes.position.push(positionAttribute);\n    morphAttributes.normal.push(normalAttribute);\n\n  }\n\n  mesh.updateMorphTargets();\n\n  if (meshDef.weights !== undefined) {\n\n    for (let i = 0, il = meshDef.weights.length; i < il; i++) {\n\n      mesh.morphTargetInfluences[i] = meshDef.weights[i];\n\n    }\n\n  }\n\n}\n\n/* GLTF PARSER */\n\nfunction GLTFParser(json, extensions, options) {\n\n  this.json = json || {};\n  this.extensions = extensions || {};\n  this.options = options || {};\n\n  // loader object cache\n  this.cache = new GLTFRegistry();\n\n}\n\nGLTFParser.prototype._withDependencies = function(dependencies) {\n\n  const _dependencies = {};\n\n  for (let i = 0; i < dependencies.length; i++) {\n\n    const dependency = dependencies[i];\n    const fnName = 'load' + dependency.charAt(0).toUpperCase() + dependency.slice(1);\n\n    const cached = this.cache.get(dependency);\n\n    if (cached !== undefined) {\n\n      _dependencies[dependency] = cached;\n\n    } else if (this[fnName]) {\n\n      const fn = this[fnName]();\n      this.cache.add(dependency, fn);\n\n      _dependencies[dependency] = fn;\n\n    }\n\n  }\n\n  return _each(_dependencies, function(dependency) {\n\n    return dependency;\n\n  });\n\n};\n\nGLTFParser.prototype.parse = function(onLoad, onError) {\n\n  const json = this.json;\n\n  // Clear the loader cache\n  this.cache.removeAll();\n\n  // Fire the callback on complete\n  this._withDependencies([\n\n    'scenes',\n    'cameras',\n    'animations',\n\n  ]).then(function(dependencies) {\n\n    const scenes = [];\n\n    for (const name in dependencies.scenes) {\n\n      scenes.push(dependencies.scenes[name]);\n\n    }\n\n    const scene = json.scene !== undefined ? dependencies.scenes[json.scene] : scenes[0];\n\n    const cameras = [];\n\n    for (const name in dependencies.cameras) {\n\n      const camera = dependencies.cameras[name];\n      cameras.push(camera);\n\n    }\n\n    const animations = [];\n\n    for (const name in dependencies.animations) {\n\n      animations.push(dependencies.animations[name]);\n\n    }\n\n    onLoad(scene, scenes, cameras, animations);\n\n  }).catch(onError);\n\n};\n\n/**\n * Requests the specified dependency asynchronously, with caching.\n * @param {string} type type\n * @param {number} index index\n * @return {Promise<Object>} deps\n */\nGLTFParser.prototype.getDependency = function(type, index) {\n\n  const cacheKey = type + ':' + index;\n  let dependency = this.cache.get(cacheKey);\n\n  if (!dependency) {\n\n    const fnName = 'load' + type.charAt(0).toUpperCase() + type.slice(1);\n    dependency = this[fnName](index);\n    this.cache.add(cacheKey, dependency);\n\n  }\n\n  return dependency;\n\n};\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n * @param {number} bufferIndex bufferIndex\n * @return {Promise<ArrayBuffer>} buffer\n */\nGLTFParser.prototype.loadBuffer = function(bufferIndex) {\n\n  const bufferDef = this.json.buffers[bufferIndex];\n\n  if (bufferDef.type && bufferDef.type !== 'arraybuffer') {\n\n    throw new Error('GLTFLoader: %s buffer type is not supported.', bufferDef.type);\n\n  }\n\n  // If present, GLB container is required to be the first buffer.\n  if (bufferDef.uri === undefined && bufferIndex === 0) {\n\n    return Promise.resolve(this.extensions[EXTENSIONS.KHR_BINARY_GLTF].body);\n\n  }\n\n  const options = this.options;\n\n  return new Promise(function(resolve) {\n\n    const loader = new FileLoader();\n    loader.setResponseType('arraybuffer');\n    loader.load(resolveURL(bufferDef.uri, options.path), resolve);\n\n  });\n\n};\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n * @param {number} bufferViewIndex bufferViewIndex\n * @return {Promise<ArrayBuffer>} buffer\n */\nGLTFParser.prototype.loadBufferView = function(bufferViewIndex) {\n\n  const bufferViewDef = this.json.bufferViews[bufferViewIndex];\n\n  return this.getDependency('buffer', bufferViewDef.buffer).then(function(buffer) {\n\n    const byteLength = bufferViewDef.byteLength || 0;\n    const byteOffset = bufferViewDef.byteOffset || 0;\n    return buffer.slice(byteOffset, byteOffset + byteLength);\n\n  });\n\n};\n\nGLTFParser.prototype.loadAccessors = function() {\n\n  const parser = this;\n  const json = this.json;\n\n  return _each(json.accessors, function(accessor) {\n\n    return parser.getDependency('bufferView', accessor.bufferView).then(function(bufferView) {\n\n      const itemSize = WEBGL_TYPE_SIZES[accessor.type];\n      const TypedArray = WEBGL_COMPONENT_TYPES[accessor.componentType];\n\n      // For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\n      const elementBytes = TypedArray.BYTES_PER_ELEMENT;\n      const itemBytes = elementBytes * itemSize;\n      const byteStride = json.bufferViews[accessor.bufferView].byteStride;\n      let array;\n\n      // The buffer is not interleaved if the stride is the item size in bytes.\n      if (byteStride && byteStride !== itemBytes) {\n\n        // Use the full buffer if it's interleaved.\n        array = new TypedArray(bufferView);\n\n        // Integer parameters to IB/IBA are in array elements, not bytes.\n        const ib = new InterleavedBuffer(array, byteStride / elementBytes);\n\n        return new InterleavedBufferAttribute(ib, itemSize, accessor.byteOffset / elementBytes);\n\n      }\n\n      array = new TypedArray(bufferView, accessor.byteOffset, accessor.count * itemSize);\n\n      return new BufferAttribute(array, itemSize);\n\n\n    });\n\n  });\n\n};\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\n * @param {number} textureIndex textureIndex\n * @return {Promise<Texture>} Texture\n */\nGLTFParser.prototype.loadTexture = function(textureIndex) {\n\n  const parser = this;\n  const json = this.json;\n  const options = this.options;\n\n  const URL = window.URL || window.webkitURL;\n\n  const textureDef = json.textures[textureIndex];\n  const source = json.images[textureDef.source];\n  let sourceURI = source.uri;\n  let isObjectURL = false;\n\n  if (source.bufferView !== undefined) {\n\n    // Load binary image data from bufferView, if provided.\n\n    sourceURI = parser.getDependency('bufferView', source.bufferView)\n      .then(function(bufferView) {\n\n        isObjectURL = true;\n        const blob = new Blob([ bufferView ], {\n          type: source.mimeType,\n        });\n        sourceURI = URL.createObjectURL(blob);\n        return sourceURI;\n\n      });\n\n  }\n\n  return Promise.resolve(sourceURI).then(function(sourceURI) {\n\n    // Load Texture resource.\n\n    const textureLoader = Loader.Handlers.get(sourceURI) || new TextureLoader();\n    textureLoader.setCrossOrigin(options.crossOrigin);\n\n    return new Promise(function(resolve, reject) {\n\n      textureLoader.load(resolveURL(sourceURI, options.path), resolve, undefined, reject);\n\n    });\n\n  }).then(function(texture) {\n\n    // Clean up resources and configure Texture.\n\n    if (isObjectURL !== undefined) {\n\n      URL.revokeObjectURL(sourceURI);\n\n    }\n\n    texture.flipY = false;\n\n    if (textureDef.name !== undefined) texture.name = textureDef.name;\n\n    texture.format = textureDef.format !== undefined ? WEBGL_TEXTURE_FORMATS[textureDef.format] : RGBAFormat;\n\n    if (textureDef.internalFormat !== undefined && texture.format !== WEBGL_TEXTURE_FORMATS[textureDef.internalFormat]) {\n\n      console.warn('GLTFLoader: js does not support texture internalFormat which is different from texture format. ' +\n        'internalFormat will be forced to be the same value as format.');\n\n    }\n\n    texture.type = textureDef.type !== undefined ? WEBGL_TEXTURE_DATATYPES[textureDef.type] : UnsignedByteType;\n\n    const samplers = json.samplers || {};\n    const sampler = samplers[textureDef.sampler] || {};\n\n    texture.magFilter = WEBGL_FILTERS[sampler.magFilter] || LinearFilter;\n    texture.minFilter = WEBGL_FILTERS[sampler.minFilter] || LinearMipMapLinearFilter;\n    texture.wrapS = WEBGL_WRAPPINGS[sampler.wrapS] || RepeatWrapping;\n    texture.wrapT = WEBGL_WRAPPINGS[sampler.wrapT] || RepeatWrapping;\n\n    return texture;\n\n  });\n\n};\n\n/**\n * Asynchronously assigns a texture to the given material parameters.\n * @param {Object} materialParams materialParams\n * @param {string} textureName textureName\n * @param {number} textureIndex textureIndex\n * @return {Promise} Promise\n */\nGLTFParser.prototype.assignTexture = function(materialParams, textureName, textureIndex) {\n\n  return this.getDependency('texture', textureIndex).then(function(texture) {\n\n    materialParams[textureName] = texture;\n\n  });\n\n};\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\n * @return {Promise<Array<Material>>} Material\n */\nGLTFParser.prototype.loadMaterials = function() {\n\n  const parser = this;\n  const json = this.json;\n  const extensions = this.extensions;\n\n  return _each(json.materials, function(material) {\n\n    let materialType;\n    const materialParams = {};\n    const materialExtensions = material.extensions || {};\n\n    const pending = [];\n\n    if (materialExtensions[EXTENSIONS.KHR_MATERIALS_COMMON]) {\n\n      const khcExtension = extensions[EXTENSIONS.KHR_MATERIALS_COMMON];\n      materialType = khcExtension.getMaterialType(material);\n      pending.push(khcExtension.extendParams(materialParams, material, parser));\n\n    } else if (materialExtensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]) {\n\n      const sgExtension = extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];\n      materialType = sgExtension.getMaterialType(material);\n      pending.push(sgExtension.extendParams(materialParams, material, parser));\n\n    } else if (material.pbrMetallicRoughness !== undefined) {\n\n      // Specification:\n      // https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\n\n      materialType = MeshStandardMaterial;\n\n      const metallicRoughness = material.pbrMetallicRoughness;\n\n      materialParams.color = new Color(1.0, 1.0, 1.0);\n      materialParams.opacity = 1.0;\n\n      if (Array.isArray(metallicRoughness.baseColorFactor)) {\n\n        const array = metallicRoughness.baseColorFactor;\n\n        materialParams.color.fromArray(array);\n        materialParams.opacity = array[3];\n\n      }\n\n      if (metallicRoughness.baseColorTexture !== undefined) {\n\n        pending.push(parser.assignTexture(materialParams, 'map', metallicRoughness.baseColorTexture.index));\n\n      }\n\n      materialParams.metalness = metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0;\n      materialParams.roughness = metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0;\n\n      if (metallicRoughness.metallicRoughnessTexture !== undefined) {\n\n        const textureIndex = metallicRoughness.metallicRoughnessTexture.index;\n        pending.push(parser.assignTexture(materialParams, 'metalnessMap', textureIndex));\n        pending.push(parser.assignTexture(materialParams, 'roughnessMap', textureIndex));\n\n      }\n\n    } else {\n\n      materialType = MeshPhongMaterial;\n\n    }\n\n    if (material.doubleSided === true) {\n\n      materialParams.side = DoubleSide;\n\n    }\n\n    const alphaMode = material.alphaMode || ALPHA_MODES.OPAQUE;\n\n    if (alphaMode !== ALPHA_MODES.OPAQUE) {\n\n      materialParams.transparent = true;\n\n    } else {\n\n      materialParams.transparent = false;\n\n    }\n\n    if (material.normalTexture !== undefined) {\n\n      pending.push(parser.assignTexture(materialParams, 'normalMap', material.normalTexture.index));\n\n    }\n\n    if (material.occlusionTexture !== undefined) {\n\n      pending.push(parser.assignTexture(materialParams, 'aoMap', material.occlusionTexture.index));\n\n    }\n\n    if (material.emissiveFactor !== undefined) {\n\n      if (materialType === MeshBasicMaterial) {\n\n        materialParams.color = new Color().fromArray(material.emissiveFactor);\n\n      } else {\n\n        materialParams.emissive = new Color().fromArray(material.emissiveFactor);\n\n      }\n\n    }\n\n    if (material.emissiveTexture !== undefined) {\n\n      if (materialType === MeshBasicMaterial) {\n\n        pending.push(parser.assignTexture(materialParams, 'map', material.emissiveTexture.index));\n\n      } else {\n\n        pending.push(parser.assignTexture(materialParams, 'emissiveMap', material.emissiveTexture.index));\n\n      }\n\n    }\n\n    return Promise.all(pending).then(function() {\n\n      let _material;\n\n      if (materialType === ShaderMaterial) {\n\n        _material = extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(materialParams);\n\n      } else {\n\n        _material = new materialType(materialParams);\n\n      }\n\n      if (material.name !== undefined) _material.name = material.name;\n\n      // Normal map textures use OpenGL conventions:\n      // https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#materialnormaltexture\n      _material.normalScale.x = -1;\n\n      _material.userData = material.extras;\n\n      return _material;\n\n    });\n\n  });\n\n};\n\nGLTFParser.prototype.loadGeometries = function(primitives) {\n\n  return this._withDependencies([\n\n    'accessors',\n\n  ]).then(function(dependencies) {\n\n    return _each(primitives, function(primitive) {\n\n      const geometry = new BufferGeometry();\n\n      const attributes = primitive.attributes;\n\n      for (const attributeId in attributes) {\n\n        const attributeEntry = attributes[attributeId];\n\n        if (attributeEntry === undefined) return;\n\n        const bufferAttribute = dependencies.accessors[attributeEntry];\n\n        switch (attributeId) {\n\n          case 'POSITION':\n\n            geometry.addAttribute('position', bufferAttribute);\n            break;\n\n          case 'NORMAL':\n\n            geometry.addAttribute('normal', bufferAttribute);\n            break;\n\n          case 'TEXCOORD_0':\n          case 'TEXCOORD0':\n          case 'TEXCOORD':\n\n            geometry.addAttribute('uv', bufferAttribute);\n            break;\n\n          case 'TEXCOORD_1':\n\n            geometry.addAttribute('uv2', bufferAttribute);\n            break;\n\n          case 'COLOR_0':\n          case 'COLOR0':\n          case 'COLOR':\n\n            geometry.addAttribute('color', bufferAttribute);\n            break;\n\n          case 'WEIGHTS_0':\n          case 'WEIGHT': // WEIGHT semantic deprecated.\n\n            geometry.addAttribute('skinWeight', bufferAttribute);\n            break;\n\n          case 'JOINTS_0':\n          case 'JOINT': // JOINT semantic deprecated.\n\n            geometry.addAttribute('skinIndex', bufferAttribute);\n            break;\n\n          default:\n            break;\n\n        }\n\n      }\n\n      if (primitive.indices !== undefined) {\n\n        geometry.setIndex(dependencies.accessors[primitive.indices]);\n\n      }\n\n      return geometry;\n\n    });\n\n  });\n\n};\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\n * @return {Promise} promise\n */\nGLTFParser.prototype.loadMeshes = function() {\n\n  const scope = this;\n  const json = this.json;\n\n  return this._withDependencies([\n\n    'accessors',\n    'materials',\n\n  ]).then(function(dependencies) {\n\n    return _each(json.meshes, function(meshDef) {\n\n      const group = new Group();\n\n      if (meshDef.name !== undefined) group.name = meshDef.name;\n      if (meshDef.extras) group.userData = meshDef.extras;\n\n      const primitives = meshDef.primitives || [];\n\n      return scope.loadGeometries(primitives).then(function(geometries) {\n\n        for (const name in primitives) {\n\n          const primitive = primitives[name];\n          const geometry = geometries[name];\n\n          const material = primitive.material === undefined ?\n            createDefaultMaterial() :\n            dependencies.materials[primitive.material];\n\n          if (material.aoMap &&\n            geometry.attributes.uv2 === undefined &&\n            geometry.attributes.uv !== undefined) {\n\n            console.log('GLTFLoader: Duplicating UVs to support aoMap.');\n            geometry.addAttribute('uv2', new BufferAttribute(geometry.attributes.uv.array, 2));\n\n          }\n\n          if (geometry.attributes.color !== undefined) {\n\n            material.vertexColors = VertexColors;\n            material.needsUpdate = true;\n\n          }\n\n          if (geometry.attributes.normal === undefined) {\n\n            if (material.flatShading !== undefined) {\n\n              material.flatShading = true;\n\n            } else {\n\n              // TODO: Remove this backwards-compatibility fix after r87 release.\n              material.shading = FlatShading;\n\n            }\n\n          }\n\n          let mesh;\n\n          if (primitive.mode === WEBGL_CONSTANTS.TRIANGLES || primitive.mode === undefined) {\n\n            mesh = new Mesh(geometry, material);\n\n          } else if (primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP) {\n\n            mesh = new Mesh(geometry, material);\n            mesh.drawMode = TriangleStripDrawMode;\n          } else if (primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN) {\n\n            mesh = new Mesh(geometry, material);\n            mesh.drawMode = TriangleFanDrawMode;\n\n          } else if (primitive.mode === WEBGL_CONSTANTS.LINES) {\n\n            mesh = new LineSegments(geometry, material);\n\n          } else if (primitive.mode === WEBGL_CONSTANTS.LINE_STRIP) {\n\n            mesh = new Line(geometry, material);\n\n          } else if (primitive.mode === WEBGL_CONSTANTS.LINE_LOOP) {\n\n            mesh = new LineLoop(geometry, material);\n\n          } else if (primitive.mode === WEBGL_CONSTANTS.POINTS) {\n\n            mesh = new Points(geometry, material);\n\n          } else {\n\n            throw new Error('GLTFLoader: Primitive mode unsupported: ', primitive.mode);\n\n          }\n\n          mesh.name = group.name + '_' + name;\n\n          if (primitive.targets !== undefined) {\n\n            addMorphTargets(mesh, meshDef, primitive, dependencies);\n\n          }\n\n          if (primitive.extras) mesh.userData = primitive.extras;\n\n          group.add(mesh);\n\n        }\n\n        return group;\n\n      });\n\n    });\n\n  });\n\n};\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\n * @return {Array} array\n */\nGLTFParser.prototype.loadCameras = function() {\n\n  const json = this.json;\n\n  return _each(json.cameras, function(camera) {\n\n    let _camera;\n\n    const params = camera[camera.type];\n\n    if (!params) {\n\n      console.warn('GLTFLoader: Missing camera parameters.');\n      return;\n\n    }\n\n    if (camera.type === 'perspective') {\n\n      const aspectRatio = params.aspectRatio || 1;\n      const xfov = params.yfov * aspectRatio;\n\n      _camera = new PerspectiveCamera(Math.radToDeg(xfov), aspectRatio, params.znear || 1, params.zfar || 2e6);\n\n    } else if (camera.type === 'orthographic') {\n\n      _camera = new OrthographicCamera(params.xmag / -2, params.xmag / 2, params.ymag / 2, params.ymag / -2, params.znear, params.zfar);\n\n    }\n\n    if (camera.name !== undefined) _camera.name = camera.name;\n    if (camera.extras) _camera.userData = camera.extras;\n\n    return _camera;\n\n  });\n\n};\n\nGLTFParser.prototype.loadSkins = function() {\n\n  const json = this.json;\n\n  return this._withDependencies([\n\n    'accessors',\n\n  ]).then(function(dependencies) {\n\n    return _each(json.skins, function(skin) {\n\n      const _skin = {\n        joints: skin.joints,\n        inverseBindMatrices: dependencies.accessors[skin.inverseBindMatrices],\n      };\n\n      return _skin;\n\n    });\n\n  });\n\n};\n\nGLTFParser.prototype.loadAnimations = function() {\n\n  const json = this.json;\n\n  return this._withDependencies([\n\n    'accessors',\n    'nodes',\n\n  ]).then(function(dependencies) {\n\n    return _each(json.animations, function(animation, animationId) {\n\n      const tracks = [];\n\n      for (const channelId in animation.channels) {\n\n        const channel = animation.channels[channelId];\n        const sampler = animation.samplers[channel.sampler];\n\n        if (sampler) {\n\n          const target = channel.target;\n          const name = target.node !== undefined ? target.node : target.id; // NOTE: target.id is deprecated.\n          const input = animation.parameters !== undefined ? animation.parameters[sampler.input] : sampler.input;\n          const output = animation.parameters !== undefined ? animation.parameters[sampler.output] : sampler.output;\n\n          const inputAccessor = dependencies.accessors[input];\n          const outputAccessor = dependencies.accessors[output];\n\n          const node = dependencies.nodes[name];\n\n          if (node) {\n\n            node.updateMatrix();\n            node.matrixAutoUpdate = true;\n\n            let TypedKeyframeTrack;\n\n            switch (PATH_PROPERTIES[target.path]) {\n\n              case PATH_PROPERTIES.weights:\n\n                TypedKeyframeTrack = NumberKeyframeTrack;\n                break;\n\n              case PATH_PROPERTIES.rotation:\n\n                TypedKeyframeTrack = QuaternionKeyframeTrack;\n                break;\n\n              case PATH_PROPERTIES.position:\n              case PATH_PROPERTIES.scale:\n              default:\n\n                TypedKeyframeTrack = VectorKeyframeTrack;\n                break;\n\n            }\n\n            const targetName = node.name ? node.name : node.uuid;\n\n            if (sampler.interpolation === 'CATMULLROMSPLINE') {\n\n              console.warn('GLTFLoader: CATMULLROMSPLINE interpolation is not supported. Using CUBICSPLINE instead.');\n\n            }\n\n            const interpolation = sampler.interpolation !== undefined ? INTERPOLATION[sampler.interpolation] : InterpolateLinear;\n\n            const targetNames = [];\n\n            if (PATH_PROPERTIES[target.path] === PATH_PROPERTIES.weights) {\n\n              // node should be Group here but\n              // PATH_PROPERTIES.weights(morphTargetInfluences) should be\n              // the property of a mesh object under node.\n              // So finding targets here.\n\n              node.traverse(function(object) {\n\n                if (object.isMesh === true && object.material.morphTargets === true) {\n\n                  targetNames.push(object.name ? object.name : object.uuid);\n\n                }\n\n              });\n\n            } else {\n\n              targetNames.push(targetName);\n\n            }\n\n            // KeyframeTrack.optimize() will modify given 'times' and 'values'\n            // buffers before creating a truncated copy to keep. Because buffers may\n            // be reused by other tracks, make copies here.\n            for (let i = 0, il = targetNames.length; i < il; i++) {\n\n              tracks.push(new TypedKeyframeTrack(\n                targetNames[i] + '.' + PATH_PROPERTIES[target.path],\n                AnimationUtils.arraySlice(inputAccessor.array, 0),\n                AnimationUtils.arraySlice(outputAccessor.array, 0),\n                interpolation\n              ));\n\n            }\n\n          }\n\n        }\n\n      }\n\n      const name = animation.name !== undefined ? animation.name : 'animation_' + animationId;\n\n      return new AnimationClip(name, undefined, tracks);\n\n    });\n\n  });\n\n};\n\nGLTFParser.prototype.loadNodes = function() {\n\n  const json = this.json;\n  const extensions = this.extensions;\n  const scope = this;\n\n  const nodes = json.nodes || [];\n  const skins = json.skins || [];\n\n  // Nothing in the node definition indicates whether it is a Bone or an\n  // Object3D. Use the skins' joint references to mark bones.\n  skins.forEach(function(skin) {\n\n    skin.joints.forEach(function(id) {\n\n      nodes[id].isBone = true;\n\n    });\n\n  });\n\n  return _each(json.nodes, function(node) {\n\n    const matrix = new Matrix4();\n\n    const _node = node.isBone === true ? new Bone() : new Object3D();\n\n    if (node.name !== undefined) {\n\n      _node.name = PropertyBinding.sanitizeNodeName(node.name);\n\n    }\n\n    if (node.extras) _node.userData = node.extras;\n\n    if (node.matrix !== undefined) {\n\n      matrix.fromArray(node.matrix);\n      _node.applyMatrix(matrix);\n\n    } else {\n\n      if (node.translation !== undefined) {\n\n        _node.position.fromArray(node.translation);\n\n      }\n\n      if (node.rotation !== undefined) {\n\n        _node.quaternion.fromArray(node.rotation);\n\n      }\n\n      if (node.scale !== undefined) {\n\n        _node.scale.fromArray(node.scale);\n\n      }\n\n    }\n\n    return _node;\n\n  }).then(function(__nodes) {\n\n    return scope._withDependencies([\n\n      'meshes',\n      'skins',\n      'cameras',\n\n    ]).then(function(dependencies) {\n\n      return _each(__nodes, function(_node, nodeId) {\n\n        const node = json.nodes[nodeId];\n\n        let meshes;\n\n        if (node.mesh !== undefined) {\n\n          meshes = [ node.mesh ];\n\n        } else if (node.meshes !== undefined) {\n\n          console.warn('GLTFLoader: Legacy glTF file detected. Nodes may have no more than one mesh.');\n\n          meshes = node.meshes;\n\n        }\n\n        if (meshes !== undefined) {\n\n          for (const meshId in meshes) {\n\n            const mesh = meshes[meshId];\n            const group = dependencies.meshes[mesh];\n\n            if (group === undefined) {\n\n              console.warn('GLTFLoader: Could not find node \"' + mesh + '\".');\n              continue;\n\n            }\n\n            // do not clone children as they will be replaced anyway\n            const clonedgroup = group.clone(false);\n\n            for (const childrenId in group.children) {\n\n              let child = group.children[childrenId];\n              const originalChild = child;\n\n              // clone Mesh to add to _node\n\n              const originalMaterial = child.material;\n              const originalGeometry = child.geometry;\n              const originalInfluences = child.morphTargetInfluences;\n              const originalUserData = child.userData;\n              const originalName = child.name;\n\n              let material = originalMaterial;\n\n              switch (child.type) {\n\n                case 'LineSegments':\n                  child = new LineSegments(originalGeometry, material);\n                  break;\n\n                case 'LineLoop':\n                  child = new LineLoop(originalGeometry, material);\n                  break;\n\n                case 'Line':\n                  child = new Line(originalGeometry, material);\n                  break;\n\n                case 'Points':\n                  child = new Points(originalGeometry, material);\n                  break;\n\n                default:\n                  child = new Mesh(originalGeometry, material);\n                  child.drawMode = originalChild.drawMode;\n\n              }\n\n              child.castShadow = true;\n              child.morphTargetInfluences = originalInfluences;\n              child.userData = originalUserData;\n              child.name = originalName;\n\n              let skinEntry;\n\n              if (node.skin !== undefined) {\n\n                skinEntry = dependencies.skins[node.skin];\n\n              }\n\n              // Replace Mesh with SkinnedMesh in library\n              if (skinEntry) {\n\n                const geometry = originalGeometry;\n                material = originalMaterial;\n                material.skinning = true;\n\n                child = new SkinnedMesh(geometry, material);\n                child.castShadow = true;\n                child.userData = originalUserData;\n                child.name = originalName;\n\n                const bones = [];\n                const boneInverses = [];\n\n                for (let i = 0, l = skinEntry.joints.length; i < l; i++) {\n\n                  const jointId = skinEntry.joints[i];\n                  const jointNode = __nodes[jointId];\n\n                  if (jointNode) {\n\n                    bones.push(jointNode);\n\n                    const m = skinEntry.inverseBindMatrices.array;\n                    const mat = new Matrix4().fromArray(m, i * 16);\n                    boneInverses.push(mat);\n\n                  } else {\n\n                    console.warn('GLTFLoader: Joint \"%s\" could not be found.', jointId);\n\n                  }\n\n                }\n\n                child.bind(new Skeleton(bones, boneInverses), child.matrixWorld);\n\n              }\n\n              clonedgroup.add(child);\n\n            }\n\n            _node.add(clonedgroup);\n\n          }\n\n        }\n\n        if (node.camera !== undefined) {\n\n          const camera = dependencies.cameras[node.camera];\n\n          _node.add(camera);\n\n        }\n\n        if (node.extensions &&\n          node.extensions[EXTENSIONS.KHR_LIGHTS] &&\n          node.extensions[EXTENSIONS.KHR_LIGHTS].light !== undefined) {\n\n          const lights = extensions[EXTENSIONS.KHR_LIGHTS].lights;\n          _node.add(lights[node.extensions[EXTENSIONS.KHR_LIGHTS].light]);\n\n        }\n\n        return _node;\n\n      });\n\n    });\n\n  });\n\n};\n\nGLTFParser.prototype.loadScenes = function() {\n\n  const json = this.json;\n  const extensions = this.extensions;\n\n  // scene node hierachy builder\n\n  function buildNodeHierachy(nodeId, parentObject, allNodes) {\n\n    const _node = allNodes[nodeId];\n    parentObject.add(_node);\n\n    const node = json.nodes[nodeId];\n\n    if (node.children) {\n\n      const children = node.children;\n\n      for (let i = 0, l = children.length; i < l; i++) {\n\n        const child = children[i];\n        buildNodeHierachy(child, _node, allNodes);\n\n      }\n\n    }\n\n  }\n\n  return this._withDependencies([\n\n    'nodes',\n\n  ]).then(function(dependencies) {\n\n    return _each(json.scenes, function(scene) {\n\n      const _scene = new Scene();\n      if (scene.name !== undefined) _scene.name = scene.name;\n\n      if (scene.extras) _scene.userData = scene.extras;\n\n      const nodes = scene.nodes || [];\n\n      for (let i = 0, l = nodes.length; i < l; i++) {\n\n        const nodeId = nodes[i];\n        buildNodeHierachy(nodeId, _scene, dependencies.nodes);\n\n      }\n\n      _scene.traverse(function(child) {\n\n        // for Specular-Glossiness.\n        if (child.material && child.material.isGLTFSpecularGlossinessMaterial) {\n\n          child.onBeforeRender = extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms;\n\n        }\n\n      });\n\n      // Ambient lighting, if present, is always attached to the scene root.\n      if (scene.extensions &&\n        scene.extensions[EXTENSIONS.KHR_LIGHTS] &&\n        scene.extensions[EXTENSIONS.KHR_LIGHTS].light !== undefined) {\n\n        const lights = extensions[EXTENSIONS.KHR_LIGHTS].lights;\n        _scene.add(lights[scene.extensions[EXTENSIONS.KHR_LIGHTS].light]);\n\n      }\n\n      return _scene;\n\n    });\n\n  });\n};\n\nexport { GLTFLoader };\n","import { AnimationMixer, EventDispatcher } from 'three';\nimport { GLTFLoader } from '../utils/GLTFLoader';\nimport Utils from '../utils/Utils';\n\n/**\n * refactor from THREE.DeviceOrientationControls\n */\nclass GltfMagic extends EventDispatcher {\n  constructor({ url, index }) {\n    super();\n    this.url = url;\n    this.index = index || 0;\n    this.scene = null;\n    this.glft = null;\n    this.mixer = null;\n    this.animations = [];\n    this.loader = new GLTFLoader();\n    this.loader.load(this.url, gltf => {\n      this.setup(gltf);\n      this.emit('loaded', {});\n    });\n  }\n\n  switchScene(index) {\n    this.index = Utils.isNumber(index) ? index : this.index;\n    this.scene = this.glft.scenes[this.index] || this.scene;\n    this.setupMixer();\n  }\n\n  setup(gltf) {\n    this.glft = gltf;\n    this.animations = gltf.animations;\n    this.switchScene();\n    this.setupMixer();\n  }\n\n  setupMixer() {\n    this.mixer = new AnimationMixer(this.scene);\n    for (let i = 0; i < this.animations.length; i++) {\n      const clip = this.animations[i];\n      this.mixer.clipAction(clip).play();\n    }\n  }\n\n  update(snippet) {\n    this.mixer && this.mixer.update(snippet / 1000);\n  }\n}\n\nexport { GltfMagic };\n"],"names":["lastTime","vendors","x","length","window","requestAnimationFrame","cancelAnimationFrame","callback","currTime","Date","getTime","timeToCall","Math","max","id","setTimeout","RAF","CAF","_rt","val","Object","prototype","toString","call","Utils","json","JSON","parse","stringify","degree","PI","radius","ks","variable","min","isArray","random","isNumber","n","m","a","b","Animate","options","object","duration","living","resident","infinite","alternate","repeats","delay","wait","timeScale","onComplete","on","bind","onUpdate","init","paused","direction","progress","repeatsCut","delayCut","waitCut","snippet","snippetCache","abs","isEnd","progressCache","spill","codomainBounce","euclideanModulo","pose","nextPose","emit","clamp","bSpill","tSpill","warn","p0","p1","t","speed","EventDispatcher","NEWTON_ITERATIONS","NEWTON_MIN_SLOPE","SUBDIVISION_PRECISION","SUBDIVISION_MAX_ITERATIONS","kSplineTableSize","kSampleStepSize","float32ArraySupported","Float32Array","A","aA1","aA2","B","C","calcBezier","aT","getSlope","binarySubdivide","aX","aA","aB","mX1","mX2","currentX","currentT","i","newtonRaphsonIterate","aGuessT","currentSlope","BezierEasing","mY1","mY2","Error","sampleValues","Array","_preCompute","_getTForX","intervalStart","currentSample","lastSample","dist","guessForT","initialSlope","get","Tween","k","bezier","x1","y1","x2","y2","pow","sin","s","Bounce","Out","In","Transition","from","to","isUndefined","props","ease","Ease","InOut","linear","PathMotion","path","Curve","lengthMode","isBoolean","needClamp","attachTangent","position","getPointAt","getPoint","copy","getTangentAt","getTangent","lookAt","add","AnimateRunner","runners","cursor","queues","runner","animate","nextRunner","push","_","time","timeSnippet","initRunner","update","cc","topSpill","TimelineAnimations","animates","cache","slice","splice","clear","_addMove","Object3D","defineProperty","scale","y","z","timelineAnimations","initTimeline","motion","updateAnimations","updateTimeline","children","key","value","rawKeys","split","prop","pop","head","join","keysMaps","linkProp","Smooth","Vector3","now","clone","noise","set","space","sub","multiplyScalar","zee","euler","Euler","q0","Quaternion","q1","sqrt","ROTATE_ORDER","Orienter","_orient","_change","needFix","fix","timing","alpha","beta","gamma","lon","lat","quaternion","eared","nodce","connect","addEventListener","removeEventListener","event","DTR","setFromEuler","multiply","setFromAxisAngle","calculation","face","applyQuaternion","xzFace","cos","dot","nor","RTD","acos","orientation","Pass","enabled","needsSwap","renderToScreen","width","height","renderer","writeBuffer","readBuffer","delta","error","CopyShader","ConvolutionShader","Vector2","sigma","gauss","exp","sum","kMaxKernelSize","kernelSize","ceil","halfWidth","values","BloomPass","strength","resolution","undefined","pars","minFilter","LinearFilter","magFilter","format","RGBAFormat","renderTargetX","WebGLRenderTarget","texture","name","renderTargetY","console","copyShader","copyUniforms","UniformsUtils","uniforms","opacity","materialCopy","ShaderMaterial","vertexShader","fragmentShader","AdditiveBlending","convolutionShader","convolutionUniforms","uImageIncrement","blurX","cKernel","buildKernel","materialConvolution","toFixed","camera","OrthographicCamera","scene","Scene","quad","Mesh","PlaneBufferGeometry","frustumCulled","maskActive","context","disable","STENCIL_TEST","material","tDiffuse","render","blurY","enable","ClearMaskPass","state","buffers","stencil","setTest","FilmShader","FilmPass","noiseIntensity","scanlinesIntensity","scanlinesCount","grayscale","shader","nIntensity","sIntensity","sCount","DigitalGlitch","GlitchPass","dt_size","tDisp","generateHeightmap","goWild","curF","generateTrigger","seed","byp","randX","amount","angle","seed_x","seed_y","distortion_x","distortion_y","data_arr","DataTexture","RGBFormat","FloatType","needsUpdate","MaskPass","inverse","color","setMask","depth","setLocked","writeValue","clearValue","setOp","REPLACE","setFunc","ALWAYS","setClear","EQUAL","KEEP","MattingShader","EdgeBlurShader","MattingPass","primer","hueStart","hueEnd","lightnessStart","lightnessEnd","mattingUniforms","materialMatting","edgeBlurUniforms","EdgeBlur","frameSize","materialEdgeBlur","RenderPass","overrideMaterial","clearColor","clearAlpha","clearDepth","oldAutoClear","autoClear","oldClearColor","oldClearAlpha","getClearColor","getHex","getClearAlpha","setClearColor","ShaderPass","textureID","defines","FocusShader","ARGlue","autoHide","matrixAutoUpdate","type","matrix","isDetected","visible","fromArray","parameters","EffectComposer","renderTarget1","renderTarget2","copyPass","tmp","effectPack","toScreen","il","passes","renderTarget","pass","swapBuffers","setSize","fn","isFunction","interactive","off","once","cb","ev","_listeners","cbs","argument","apply","interactiveChildren","started","_trackedPointers","raycastTest","raycaster","result","raycast","InteractionData","global","target","originalEvent","identifier","isPrimary","button","buttons","tiltX","tiltY","pointerType","pressure","rotationAngle","twist","tangentialPressure","InteractionEvent","stopped","currentTarget","data","intersect","InteractionTrackingData","pointerId","_pointerId","_flags","FLAGS","NONE","flag","yn","flags","constructor","OVER","_doSet","RIGHT_DOWN","LEFT_DOWN","freeze","MOUSE_POINTER_ID","hitTestEvent","InteractionManager","autoPreventDefault","interactionFrequency","mouse","activeInteractionData","interactionDataPool","eventData","interactionDOMElement","moveWhenInside","eventsAdded","mouseOverRenderer","supportsTouchEvents","supportsPointerEvents","PointerEvent","onClick","processClick","onPointerUp","processPointerUp","onPointerCancel","processPointerCancel","onPointerDown","processPointerDown","onPointerMove","processPointerMove","onPointerOut","processPointerOverOut","onPointerOver","cursorStyles","currentCursorMode","Raycaster","_deltaTime","setTargetElement","domElement","globalPoint","root","processInteractive","element","removeEvents","addEvents","navigator","msPointerEnabled","style","document","didMove","hasOwnProperty","interactionData","interactionEvent","configureInteractionEventForDOMEvent","setCursorMode","mode","assign","displayObject","eventString","point","rect","parentElement","getBoundingClientRect","left","top","func","hitTest","hit","interactiveParent","child","childHit","parent","events","normalizeToPointerData","isNormalized","preventDefault","getInteractionDataForPointerId","triggerEvent","eventLen","isRightButton","trackedPointers","rightDown","leftDown","cancelled","eventAppend","releaseInteractionDataForPointerId","onPointerComplete","trackingData","isTouch","isMouse","test","isDown","over","none","_copyEvent","_reset","pointerEvent","mapPositionToPoint","clientX","clientY","setFromCamera","globalX","globalY","normalizedEvents","TouchEvent","li","changedTouches","touch","touches","radiusX","radiusY","force","layerX","offsetX","layerY","offsetY","MouseEvent","removeAllListeners","_tempPoint","LayerCompositor","arguments","remove","setRenderTarget","autoClearColor","autoClearDepth","autoClearStencil","setDefault","check","spare","ViewConfig","canvas","isString","getElementById","querySelector","precision","antialias","premultipliedAlpha","preserveDrawingBuffer","logarithmicDepthBuffer","EffectPack","index","Viewer","pixelRatio","updateStyle","vrmode","viewBox","WebGLRenderer","setPixelRatio","ticking","pt","fps","effectComposer","layerCompositor","layers","interactionManager","_vrmode","vrmodeOnChange","setComposerSize","setLayersSize","timeline","setScissor","setViewport","size","hw","setScissorTest","setSV","xrRender","eye","session","renderLayers","layerEffect","composition","needSort","_sortList","_sortLayerQuad","layer","isEmpty","ll","isAeOpen","viewEffect","This","loop","setInterval","tick","tickFixedFPS","j","temp","zIndex","quads","isLayer","setLayerSize","indexOf","addPass","insertPass","getPortSize","l","getDrawingBufferSize","layerClass","Layer","_zIndex","aeDelta","MeshBasicMaterial","ARLayer","frameWidth","frameHeight","updateViewport","PerspectiveCamera","ar_map","poses","forEach","glue","updatePose","projectionMatrix","getSize","rw","rh","ratio","rtw","rth","XRLayer","vrsensor","fov","aspect","near","far","stereo","StereoCamera","stereoAspect","sensorCTL","updateMatrixWorld","updateStereo","cameraL","cameraR","updateProjectionMatrix","_interactive","interactiveOnChange","LANDSCAPE_MAP","Primer","landscape","CW","flip","uvMatrix","Matrix3","isPrimer","pigmentGeo","autoCover","targetAspect","setTargetAspect","needsUpdateAttributes","_cs","_setPositions","attributes","positions","coefficient","count","item","itemSize","array","uv","v1","identity","translate","rotate","getX","getY","applyMatrix3","setXY","_autoCover","YUVShader","ss","LuminanceFormat","Color","YCbCrShader","LuminanceAlphaFormat","FORMAT_MAP","CameraPrimer","displayTarget","depthTest","depthWrite","_depthTest","_depthWrite","getFrames","dataArray","texOrder","tex","idx","diffuse","pigmentMat","pigment","_correctUv","_setAspect","image","_updateAttributes","isDirty","updateFrame","rednerTarget","TexturePrimer","frame","TextureLoader","load","tagName","VideoTexture","CanvasTexture","Texture","_gainFrameSize","AnchorBase","applyMatrix4","Matrix4","getInverse","matrixWorld","Group","AnchorRippling","segmentation","rippling","segmentationRip","map","waves","uiFace","transparent","initRippling","waitTime","last","circle","CircleBufferGeometry","scaleXYZ","Linear","None","RATIO","RANGE","PI2","START","END","UP","SphereWorld","url","segmentationX","segmentationY","flipX","flipY","draggable","rotateSpeed","rangeMin","rangeMax","driftX","driftY","needCamera","needMount","inner","background","SphereBufferGeometry","side","DoubleSide","_onStart","_onMove","_onEnd","_draggable","_dragX","updateTracking","cx","cy","updateDrag","Camera","hadStart","pageX","pageY","dragX","rotation","dragY","vector","crossVectors","onDragChange","radian","CylinderWorld","radiusSegments","heightSegments","openEnded","zoomIn","viscosity","CylinderBufferGeometry","gyro","drag","DIFF","breaking","compensate","BINARY_EXTENSION_HEADER_MAGIC","BINARY_EXTENSION_HEADER_LENGTH","BINARY_EXTENSION_CHUNK_TYPES","EXTENSIONS","GLTFLoader","manager","DefaultLoadingManager","onLoad","onProgress","onError","scope","Loader","extractUrlBase","loader","FileLoader","setResponseType","e","crossOrigin","content","extensions","magic","convertUint8ArrayToString","Uint8Array","KHR_BINARY_GLTF","GLTFBinaryExtension","asset","version","extensionsUsed","KHR_LIGHTS","GLTFLightsExtension","KHR_MATERIALS_COMMON","GLTFMaterialsCommonExtension","KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS","GLTFMaterialsPbrSpecularGlossinessExtension","parser","GLTFParser","scenes","cameras","animations","timeEnd","glTF","GLTFRegistry","objects","lights","extension","lightId","light","lightNode","DirectionalLight","PointLight","SpotLight","AmbientLight","constantAttenuation","intensity","linearAttenuation","distance","quadraticAttenuation","decay","fallOffAngle","fallOffExponent","getMaterialType","khrMaterial","MeshPhongMaterial","MeshLambertMaterial","extendParams","materialParams","pending","keys","materialValues","v","diffuseFactor","diffuseTexture","assignTexture","specularFactor","specular","specularTexture","shininessFactor","shininess","Promise","all","body","headerView","DataView","header","getUint32","chunkView","chunkIndex","byteLength","chunkLength","chunkType","contentArray","BIN","byteOffset","params","pbrSpecularGlossiness","ShaderLib","standard","specularMapParsFragmentChunk","glossinessMapParsFragmentChunk","specularMapFragmentChunk","glossinessMapFragmentChunk","lightPhysicalFragmentChunk","replace","roughness","metalness","roughnessMap","metalnessMap","setHex","glossiness","specularMap","glossinessMap","emissive","glossinessFactor","specularGlossinessTexture","specGlossIndex","isGLTFSpecularGlossinessMaterial","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalScale","displacementMap","displacementScale","displacementBias","alphaMap","envMap","envMapIntensity","refractionRatio","derivatives","geometry","uvScaleMap","isWebGLRenderTarget","offset","repeat","offsetRepeat","flipEnvMap","isCubeTexture","USE_GLOSSINESSMAP","USE_ROUGHNESSMAP","WEBGL_CONSTANTS","WEBGL_COMPONENT_TYPES","Int8Array","Int16Array","Uint16Array","Uint32Array","WEBGL_FILTERS","NearestFilter","NearestMipMapNearestFilter","LinearMipMapNearestFilter","NearestMipMapLinearFilter","LinearMipMapLinearFilter","WEBGL_WRAPPINGS","ClampToEdgeWrapping","MirroredRepeatWrapping","RepeatWrapping","WEBGL_TEXTURE_FORMATS","AlphaFormat","WEBGL_TEXTURE_DATATYPES","UnsignedByteType","UnsignedShort4444Type","UnsignedShort5551Type","UnsignedShort565Type","WEBGL_TYPE_SIZES","PATH_PROPERTIES","INTERPOLATION","InterpolateSmooth","InterpolateLinear","InterpolateDiscrete","ALPHA_MODES","_each","thisObj","resolve","results","fns","then","resolveURL","TextDecoder","decode","String","fromCharCode","createDefaultMaterial","MeshStandardMaterial","FrontSide","addMorphTargets","mesh","meshDef","primitiveDef","dependencies","targets","morphAttributes","normal","morphTargets","attributeName","positionAttribute","normalAttribute","POSITION","accessors","jl","setXYZ","getZ","NORMAL","morphNormals","TANGENT","updateMorphTargets","weights","morphTargetInfluences","_withDependencies","_dependencies","dependency","fnName","charAt","toUpperCase","cached","removeAll","catch","getDependency","cacheKey","loadBuffer","bufferIndex","bufferDef","uri","loadBufferView","bufferViewIndex","bufferViewDef","bufferViews","buffer","loadAccessors","accessor","bufferView","TypedArray","componentType","elementBytes","BYTES_PER_ELEMENT","itemBytes","byteStride","ib","InterleavedBuffer","InterleavedBufferAttribute","BufferAttribute","loadTexture","textureIndex","URL","webkitURL","textureDef","textures","source","images","sourceURI","isObjectURL","blob","Blob","mimeType","createObjectURL","textureLoader","Handlers","setCrossOrigin","reject","revokeObjectURL","internalFormat","samplers","sampler","wrapS","wrapT","textureName","loadMaterials","materials","materialType","materialExtensions","khcExtension","sgExtension","pbrMetallicRoughness","metallicRoughness","baseColorFactor","baseColorTexture","metallicFactor","roughnessFactor","metallicRoughnessTexture","doubleSided","alphaMode","OPAQUE","normalTexture","occlusionTexture","emissiveFactor","emissiveTexture","_material","createMaterial","userData","extras","loadGeometries","primitives","primitive","BufferGeometry","attributeId","attributeEntry","bufferAttribute","addAttribute","indices","setIndex","loadMeshes","meshes","group","geometries","uv2","log","vertexColors","VertexColors","flatShading","shading","FlatShading","TRIANGLES","TRIANGLE_STRIP","drawMode","TriangleStripDrawMode","TRIANGLE_FAN","TriangleFanDrawMode","LINES","LineSegments","LINE_STRIP","Line","LINE_LOOP","LineLoop","POINTS","Points","loadCameras","_camera","aspectRatio","xfov","yfov","radToDeg","znear","zfar","xmag","ymag","loadSkins","skins","skin","_skin","joints","inverseBindMatrices","loadAnimations","animation","animationId","tracks","channelId","channels","channel","node","input","output","inputAccessor","outputAccessor","nodes","updateMatrix","TypedKeyframeTrack","NumberKeyframeTrack","QuaternionKeyframeTrack","VectorKeyframeTrack","targetName","uuid","interpolation","targetNames","traverse","isMesh","AnimationUtils","arraySlice","AnimationClip","loadNodes","isBone","_node","Bone","PropertyBinding","sanitizeNodeName","applyMatrix","translation","__nodes","nodeId","meshId","clonedgroup","childrenId","originalChild","originalMaterial","originalGeometry","originalInfluences","originalUserData","originalName","castShadow","skinEntry","skinning","SkinnedMesh","bones","boneInverses","jointId","jointNode","mat","Skeleton","loadScenes","buildNodeHierachy","parentObject","allNodes","_scene","onBeforeRender","refreshUniforms","GltfMagic","glft","mixer","setup","gltf","setupMixer","switchScene","AnimationMixer","clip","clipAction","play"],"mappings":"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"}
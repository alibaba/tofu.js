{"version":3,"file":"tofu.js","sources":["../src/utils/Raf.js","../src/utils/Utils.js","../src/animation/Animate.js","../src/math/BezierEasing.js","../src/utils/Tween.js","../src/animation/Transition.js","../src/animation/PathMotion.js","../src/animation/AnimateRunner.js","../src/animation/TimelineAnimations.js","../src/patch/Object3D.js","../src/utils/Smooth.js","../src/utils/Orienter.js","../src/core/ARGlue.js","../src/core/ViewPort.js","../src/postprocessing/Pass.js","../src/shader/CopyShader.js","../src/shader/ConvolutionShader.js","../src/postprocessing/BloomPass.js","../src/postprocessing/ClearMaskPass.js","../src/shader/FilmShader.js","../src/postprocessing/FilmPass.js","../src/shader/DigitalGlitch.js","../src/postprocessing/GlitchPass.js","../src/postprocessing/MaskPass.js","../src/shader/MattingShader.js","../src/shader/EdgeBlur.js","../src/postprocessing/MattingPass.js","../src/postprocessing/RenderPass.js","../src/postprocessing/ShaderPass.js","../src/shader/FocusShader.js","../src/postprocessing/EffectComposer.js","../src/core/Layer.js","../src/core/GraphicsLayer.js","../src/core/PrimerLayer.js","../src/core/Compositor.js","../src/core/Viewer.js","../src/core/ARViewer.js","../node_modules/three.interaction/src/utils/Utils.js","../node_modules/three.interaction/src/patch/EventDispatcher.js","../node_modules/three.interaction/src/patch/Object3D.js","../node_modules/three.interaction/src/interaction/InteractionData.js","../node_modules/three.interaction/src/interaction/InteractionEvent.js","../node_modules/three.interaction/src/interaction/InteractionTrackingData.js","../node_modules/three.interaction/src/interaction/InteractionManager.js","../src/extras/panorama/SphereWorld.js","../src/extras/panorama/CylinderWorld.js","../src/core/XRViewer.js","../src/extras/primers/Primer.js","../src/shader/YUVShader.js","../src/shader/YCbCrShader.js","../src/extras/primers/CameraPrimer.js","../src/extras/primers/TexturePrimer.js","../src/extras/panorama/AnchorBase.js","../src/extras/panorama/AnchorRippling.js","../src/utils/GLTFLoader.js","../src/extras/GltfMagic.js"],"sourcesContent":["(function() {\n  let lastTime = 0;\n  const vendors = [ 'ms', 'moz', 'webkit', 'o' ];\n  for (let x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n    window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\n    window.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame'] ||\n            window[vendors[x] + 'CancelRequestAnimationFrame'];\n  }\n\n  if (!window.requestAnimationFrame) {\n    window.requestAnimationFrame = function(callback) {\n      const currTime = new Date().getTime();\n      const timeToCall = Math.max(0, 16 - (currTime - lastTime));\n      const id = window.setTimeout(function() {\n        callback(currTime + timeToCall);\n      }, timeToCall);\n      lastTime = currTime + timeToCall;\n      return id;\n    };\n  }\n\n  if (!window.cancelAnimationFrame) {\n    window.cancelAnimationFrame = function(id) {\n      clearTimeout(id);\n    };\n  }\n\n  window.RAF = window.requestAnimationFrame;\n  window.CAF = window.cancelAnimationFrame;\n})();\n","/**\n * 返回数据类型\n * @param {*} val 需要判定的类型\n * @return {String} 数据类型\n */\nfunction _rt(val) {\n  return Object.prototype.toString.call(val);\n}\n\n/**\n * Utils 常用工具箱\n *\n * @namespace Utils\n */\nconst Utils = {\n  /**\n   * 简单拷贝纯数据的JSON对象\n   *\n   * @static\n   * @memberof Utils\n   * @param {JSON} json 待拷贝的纯数据JSON\n   * @return {JSON} 拷贝后的纯数据JSON\n   */\n  copyJSON(json) {\n    return JSON.parse(JSON.stringify(json));\n  },\n\n  /**\n   * 将角度转化成弧度\n   *\n   * @static\n   * @memberof Utils\n   * @param {Number} degree 角度数\n   * @return {Number} 弧度数\n   */\n  DTR(degree) {\n    return degree * Math.PI / 180;\n  },\n\n  /**\n   * 将弧度转化成角度\n   *\n   * @static\n   * @memberof Utils\n   * @param {Number} radius 弧度数\n   * @return {Number} 角度数\n   */\n  RTD(radius) {\n    return radius * 180 / Math.PI;\n  },\n\n  /**\n   * 判断变量是否为数组类型\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Array} variable 待判断的变量\n   * @return {Boolean} 判断的结果\n   */\n  isArray: (function() {\n    const ks = _rt([]);\n    return function(variable) {\n      return _rt(variable) === ks;\n    };\n  })(),\n\n  /**\n   * 判断变量是否为对象类型\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Object} variable 待判断的变量\n   * @return {Boolean} 判断的结果\n   */\n  isObject: (function() {\n    const ks = _rt({});\n    return function(variable) {\n      return _rt(variable) === ks;\n    };\n  })(),\n\n  /**\n   * 判断变量是否为字符串类型\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {String} variable 待判断的变量\n   * @return {Boolean} 判断的结果\n   */\n  isString: (function() {\n    const ks = _rt('s');\n    return function(variable) {\n      return _rt(variable) === ks;\n    };\n  })(),\n\n  /**\n   * 判断变量是否为数字类型\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Number} variable 待判断的变量\n   * @return {Boolean} 判断的结果\n   */\n  isNumber: (function() {\n    const ks = _rt(1);\n    return function(variable) {\n      return _rt(variable) === ks;\n    };\n  })(),\n\n  /**\n   * 判断变量是否为函数类型\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Function} variable 待判断的变量\n   * @return {Boolean} 判断的结果\n   */\n  isFunction: (function() {\n    const ks = _rt(function() {});\n    return function(variable) {\n      return _rt(variable) === ks;\n    };\n  })(),\n\n\n  /**\n   * 判断变量是否为undefined\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Function} variable 待判断的变量\n   * @return {Boolean} 判断的结果\n   */\n  isUndefined(variable) {\n    return typeof variable === 'undefined';\n  },\n\n  /**\n   * 判断变量是否为布尔型\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Function} variable 待判断的变量\n   * @return {Boolean} 判断的结果\n   */\n  isBoolean: (function() {\n    const ks = _rt(true);\n    return function(variable) {\n      return _rt(variable) === ks;\n    };\n  })(),\n\n  /**\n   * 强化的随机数，可以随机产生给定区间内的数字、随机输出数字内的项\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Array | Number} min 当只传入一个变量时变量应该为数字，否则为所给定区间较小的数字\n   * @param {Number} max 所给定区间较大的数字\n   * @return {ArrayItem | Number} 返回数组中大一项或者给定区间内的数字\n   */\n  random(min, max) {\n    if (this.isArray(min)) return min[~~(Math.random() * min.length)];\n    if (!this.isNumber(max)) {\n      max = min || 1;\n      min = 0;\n    }\n    return min + Math.random() * (max - min);\n  },\n\n  /**\n   * 阿基米德求模\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Number} n 当前值\n   * @param {Number} m 模\n   * @return {Number} 映射到模长内的值\n   */\n  euclideanModulo(n, m) {\n    return ((n % m) + m) % m;\n  },\n\n  /**\n   * 边界值域镜像\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Number} n 当前值\n   * @param {Number} min 值域下边界\n   * @param {Number} max 值域上边界\n   * @return {Number} 值域内反射到的值\n   */\n  codomainBounce(n, min, max) {\n    if (n < min) return 2 * min - n;\n    if (n > max) return 2 * max - n;\n    return n;\n  },\n\n  /**\n   * 数字区间闭合，避免超出区间\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Number} x 待闭合到值\n   * @param {Number} a 闭合区间左边界\n   * @param {Number} b 闭合区间右边界\n   * @return {Number} 闭合后的值\n   */\n  clamp(x, a, b) {\n    return (x < a) ? a : ((x > b) ? b : x);\n  },\n\n  /**\n   * 线性插值\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Number} x 输入的值\n   * @param {Number} min 输入值的下区间\n   * @param {Number} max 输入值的上区间\n   * @return {Number} 返回的值在区间[0,1]内\n   */\n  linear(x, min, max) {\n    if (x <= min) return 0;\n    if (x >= max) return 1;\n    x = (x - min) / (max - min);\n    return x;\n  },\n\n  /**\n   * 平滑插值\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Number} x 输入的值\n   * @param {Number} min 输入值的下区间\n   * @param {Number} max 输入值的上区间\n   * @return {Number} 返回的值在区间[0,1]内\n   */\n  smoothstep(x, min, max) {\n    if (x <= min) return 0;\n    if (x >= max) return 1;\n    x = (x - min) / (max - min);\n    return x * x * (3 - 2 * x);\n  },\n\n  /**\n   * 更平滑的插值\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {Number} x 输入的值\n   * @param {Number} min 输入值的下区间\n   * @param {Number} max 输入值的上区间\n   * @return {Number} 返回的值在区间[0,1]内\n   */\n  smootherstep(x, min, max) {\n    if (x <= min) return 0;\n    if (x >= max) return 1;\n    x = (x - min) / (max - min);\n    return x * x * x * (x * (x * 6 - 15) + 10);\n  },\n};\n\nexport default Utils;\n","import { EventDispatcher } from 'three';\nimport Utils from '../utils/Utils';\n\n/**\n * an animate class, root class\n * @private\n */\nclass Animate extends EventDispatcher {\n  /**\n   * config your animation\n   * @param {Object} options animate config\n   * @private\n   */\n  constructor(options) {\n    super();\n    this.object = options.object || {};\n    this.duration = options.duration || 300;\n    this.living = true;\n    this.resident = options.resident || false;\n\n    this.infinite = options.infinite || false;\n    this.alternate = options.alternate || false;\n    this.repeats = options.repeats || 0;\n    this.delay = options.delay || 0;\n    this.wait = options.wait || 0;\n    this.timeScale = Utils.isNumber(options.timeScale) ?\n      options.timeScale :\n      1;\n\n    if (options.onComplete) {\n      this.on('complete', options.onComplete.bind(this));\n    }\n    if (options.onUpdate) {\n      this.on('update', options.onUpdate.bind(this));\n    }\n\n    this.init();\n\n    this.paused = false;\n  }\n\n  /**\n   * init animate state\n   * @private\n   */\n  init() {\n    this.direction = 1;\n    this.progress = 0;\n    this.repeatsCut = this.repeats;\n    this.delayCut = this.delay;\n    this.waitCut = this.wait;\n  }\n\n  /**\n   * update the timeline and get pose\n   *\n   * @private\n   * @param {Number} snippet time snippet\n   * @return {Object} pose state\n   */\n  update(snippet) {\n    const snippetCache = this.direction * this.timeScale * snippet;\n    if (this.waitCut > 0) {\n      this.waitCut -= Math.abs(snippetCache);\n      return;\n    }\n    if (this.paused || !this.living || this.delayCut > 0) {\n      if (this.delayCut > 0) this.delayCut -= Math.abs(snippetCache);\n      return;\n    }\n\n    this.progress += snippetCache;\n    let isEnd = false;\n    const progressCache = this.progress;\n\n    if (this.spill()) {\n      if (this.repeatsCut > 0 || this.infinite) {\n        if (this.repeatsCut > 0) --this.repeatsCut;\n        this.delayCut = this.delay;\n        if (this.alternate) {\n          this.direction *= -1;\n          this.progress = Utils.codomainBounce(this.progress, 0, this.duration);\n        } else {\n          this.direction = 1;\n          this.progress = Utils.euclideanModulo(this.progress, this.duration);\n        }\n      } else {\n        isEnd = true;\n      }\n    }\n\n    let pose;\n    if (!isEnd) {\n      pose = this.nextPose();\n      this.emit('update', pose, this.progress / this.duration);\n    } else {\n      if (!this.resident) this.living = false;\n      this.progress = Utils.clamp(progressCache, 0, this.duration);\n      pose = this.nextPose();\n      this.emit('complete', pose, Math.abs(progressCache - this.progress));\n    }\n    return pose;\n  }\n\n  /**\n   * check progress was spill\n   *\n   * @private\n   * @return {Boolean} whether spill or not\n   */\n  spill() {\n    const bSpill = this.progress <= 0 && this.direction === -1;\n    const tSpill = this.progress >= this.duration && this.direction === 1;\n    return bSpill || tSpill;\n  }\n\n  /**\n   * get next pose, should be overwrite by sub-class\n   * @private\n   */\n  nextPose() {\n    console.warn('should be overwrite');\n  }\n\n  /**\n   * linear interpolation\n   * @private\n   * @param {number} p0 start value\n   * @param {number} p1 end value\n   * @param {number} t  time rate\n   * @return {Number} interpolation value\n   */\n  linear(p0, p1, t) {\n    return (p1 - p0) * t + p0;\n  }\n\n  /**\n   * pause this animate\n   */\n  pause() {\n    this.paused = true;\n  }\n\n  /**\n   * restore this animate play\n   */\n  restart() {\n    this.paused = false;\n  }\n\n  /**\n   * stop this animate at last frame, will trigger `complete` event\n   */\n  stop() {\n    this.repeats = 0;\n    this.infinite = false;\n    this.progress = this.duration;\n  }\n\n  /**\n   * set this queue's timeScale\n   * @param {Number} speed set timescale\n   */\n  setSpeed(speed) {\n    this.timeScale = speed;\n  }\n\n  /**\n   * cancle this animate, will not trigger `complete` event\n   */\n  cancle() {\n    this.living = false;\n  }\n}\n\nexport default Animate;\n","/**\n * https://github.com/gre/bezier-easing\n * BezierEasing - use bezier curve for transition easing function\n * by Gaëtan Renaudeau 2014 - 2015 – MIT License\n */\n\nconst NEWTON_ITERATIONS = 4;\nconst NEWTON_MIN_SLOPE = 0.001;\nconst SUBDIVISION_PRECISION = 0.0000001;\nconst SUBDIVISION_MAX_ITERATIONS = 10;\n\n\nconst kSplineTableSize = 11;\nconst kSampleStepSize = 1.0 / (kSplineTableSize - 1.0);\n\nconst float32ArraySupported = typeof Float32Array === 'function';\n\n/* eslint new-cap: 0 */\n\n/**\n * 公因式A\n *\n * @param {number} aA1 控制分量\n * @param {number} aA2 控制分量\n * @return {number} 整个公式中的A公因式的值\n */\nfunction A(aA1, aA2) {\n  return 1.0 - 3.0 * aA2 + 3.0 * aA1;\n}\n\n/**\n * 公因式B\n *\n * @param {number} aA1 控制分量1\n * @param {number} aA2 控制分量2\n * @return {number} 整个公式中的B公因式的值\n */\nfunction B(aA1, aA2) {\n  return 3.0 * aA2 - 6.0 * aA1;\n}\n\n/**\n * 公因式C\n *\n * @param {number} aA1 控制分量1\n * @param {number} aA2 控制分量2\n * @return {number} 整个公式中的C公因式的值\n */\nfunction C(aA1) {\n  return 3.0 * aA1;\n}\n\n/**\n * 获取aT处的值\n *\n * @param {number} aT 三次贝塞尔曲线的t自变量\n * @param {number} aA1 控制分量1\n * @param {number} aA2 控制分量2\n * @return {number} 三次贝塞尔公式的因变量\n */\nfunction calcBezier(aT, aA1, aA2) {\n  return ((A(aA1, aA2) * aT + B(aA1, aA2)) * aT + C(aA1)) * aT;\n}\n\n/**\n * 获取aT处的斜率\n * @param {number} aT 三次贝塞尔曲线的t自变量\n * @param {number} aA1 控制分量1\n * @param {number} aA2 控制分量2\n * @return {number} 三次贝塞尔公式的导数\n */\nfunction getSlope(aT, aA1, aA2) {\n  return 3.0 * A(aA1, aA2) * aT * aT + 2.0 * B(aA1, aA2) * aT + C(aA1);\n}\n\n/**\n *\n * @param {number} aX x\n * @param {number} aA a\n * @param {number} aB b\n * @param {number} mX1 min x\n * @param {number} mX2 max x\n * @return {number} 二分法猜测t的值\n */\nfunction binarySubdivide(aX, aA, aB, mX1, mX2) {\n  let currentX;\n  let currentT;\n  let i = 0;\n  do {\n    currentT = aA + (aB - aA) / 2.0;\n    currentX = calcBezier(currentT, mX1, mX2) - aX;\n    if (currentX > 0.0) {\n      aB = currentT;\n    } else {\n      aA = currentT;\n    }\n  } while (\n    Math.abs(currentX) > SUBDIVISION_PRECISION\n    &&\n    ++i < SUBDIVISION_MAX_ITERATIONS\n  );\n  return currentT;\n}\n\n/**\n * 牛顿迭代算法，进一步的获取精确的T值\n * @param {number} aX x\n * @param {number} aGuessT guess t\n * @param {number} mX1 min x\n * @param {number} mX2 max x\n * @return {number} 获取更精确的T值\n */\nfunction newtonRaphsonIterate(aX, aGuessT, mX1, mX2) {\n  for (let i = 0; i < NEWTON_ITERATIONS; ++i) {\n    const currentSlope = getSlope(aGuessT, mX1, mX2);\n    if (currentSlope === 0.0) {\n      return aGuessT;\n    }\n    const currentX = calcBezier(aGuessT, mX1, mX2) - aX;\n    aGuessT -= currentX / currentSlope;\n  }\n  return aGuessT;\n}\n\n/**\n * cubic-bezier曲线的两个控制点，默认起始点为 0，结束点为 1\n *\n * @class\n * @param {number} mX1 控制点1的x分量\n * @param {number} mY1 控制点1的y分量\n * @param {number} mX2 控制点2的x分量\n * @param {number} mY2 控制点2的y分量\n */\nfunction BezierEasing(mX1, mY1, mX2, mY2) {\n  if (!(mX1 >= 0 && mX1 <= 1 && mX2 >= 0 && mX2 <= 1)) {\n    throw new Error('bezier x values must be in [0, 1] range');\n  }\n  this.mX1 = mX1;\n  this.mY1 = mY1;\n  this.mX2 = mX2;\n  this.mY2 = mY2;\n  this.sampleValues = float32ArraySupported ?\n    new Float32Array(kSplineTableSize) :\n    new Array(kSplineTableSize);\n\n  this._preCompute();\n}\n\nBezierEasing.prototype._preCompute = function() {\n  // Precompute samples table\n  if (this.mX1 !== this.mY1 || this.mX2 !== this.mY2) {\n    for (let i = 0; i < kSplineTableSize; ++i) {\n      this.sampleValues[i] = calcBezier(\n        i * kSampleStepSize,\n        this.mX1,\n        this.mX2\n      );\n    }\n  }\n};\n\nBezierEasing.prototype._getTForX = function(aX) {\n  let intervalStart = 0.0;\n  let currentSample = 1;\n  const lastSample = kSplineTableSize - 1;\n\n  for (\n    ;\n    currentSample !== lastSample && this.sampleValues[currentSample] <= aX;\n    ++currentSample\n  ) {\n    intervalStart += kSampleStepSize;\n  }\n  --currentSample;\n\n  // Interpolate to provide an initial guess for t\n  const dist = (aX - this.sampleValues[currentSample]) /\n  (this.sampleValues[currentSample + 1] - this.sampleValues[currentSample]);\n  const guessForT = intervalStart + dist * kSampleStepSize;\n\n  const initialSlope = getSlope(guessForT, this.mX1, this.mX2);\n  if (initialSlope >= NEWTON_MIN_SLOPE) {\n    return newtonRaphsonIterate(aX, guessForT, this.mX1, this.mX2);\n  } else if (initialSlope === 0.0) {\n    return guessForT;\n  }\n  return binarySubdivide(\n    aX,\n    intervalStart,\n    intervalStart + kSampleStepSize,\n    this.mX1,\n    this.mX2\n  );\n};\n\n/**\n * 通过x轴近似获取y的值\n *\n * @param {number} x x轴的偏移量\n * @return {number} 与输入值x对应的y值\n */\nBezierEasing.prototype.get = function(x) {\n  if (this.mX1 === this.mY1 && this.mX2 === this.mY2) return x;\n  if (x === 0) {\n    return 0;\n  }\n  if (x === 1) {\n    return 1;\n  }\n  return calcBezier(this._getTForX(x), this.mY1, this.mY2);\n};\n\nexport { BezierEasing };\n\n","import { BezierEasing } from '../math/BezierEasing';\n/* eslint no-cond-assign: \"off\" */\n/* eslint new-cap: 0 */\n/* eslint max-len: 0 */\n\n\n/**\n * Tween 缓动时间运动函数集合\n *\n * ```js\n * dispay.animate({\n *   from: {x: 100},\n *   to: {x: 200},\n *   ease: JC.Tween.Ease.In, // 配置要调用的运动函数\n * })\n * ```\n * @namespace Tween\n */\n\nconst Tween = {\n\n  Linear: {\n\n    None(k) {\n      return k;\n    },\n\n  },\n\n  Ease: {\n\n    In: (function() {\n      const bezier = new BezierEasing(0.42, 0, 1, 1);\n      return function(k) {\n        return bezier.get(k);\n      };\n    })(),\n\n    Out: (function() {\n      const bezier = new BezierEasing(0, 0, 0.58, 1);\n      return function(k) {\n        return bezier.get(k);\n      };\n    })(),\n\n    InOut: (function() {\n      const bezier = new BezierEasing(0.42, 0, 0.58, 1);\n      return function(k) {\n        return bezier.get(k);\n      };\n    })(),\n\n    Bezier(x1, y1, x2, y2) {\n      const bezier = new BezierEasing(x1, y1, x2, y2);\n      return function(k) {\n        return bezier.get(k);\n      };\n    },\n\n  },\n\n  Elastic: {\n\n    In(k) {\n      if (k === 0) {\n        return 0;\n      }\n      if (k === 1) {\n        return 1;\n      }\n      return -Math.pow(2, 10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI);\n    },\n\n    Out(k) {\n      if (k === 0) {\n        return 0;\n      }\n      if (k === 1) {\n        return 1;\n      }\n      return Math.pow(2, -10 * k) * Math.sin((k - 0.1) * 5 * Math.PI) + 1;\n    },\n\n    InOut(k) {\n      if (k === 0) {\n        return 0;\n      }\n      if (k === 1) {\n        return 1;\n      }\n      k *= 2;\n      if (k < 1) {\n        return -0.5 * Math.pow(2, 10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI);\n      }\n      return 0.5 * Math.pow(2, -10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI) + 1;\n    },\n\n  },\n\n  Back: {\n\n    In(k) {\n      const s = 1.70158;\n      return k * k * ((s + 1) * k - s);\n    },\n\n    Out(k) {\n      const s = 1.70158;\n      return --k * k * ((s + 1) * k + s) + 1;\n    },\n\n    InOut(k) {\n      const s = 1.70158 * 1.525;\n      if ((k *= 2) < 1) {\n        return 0.5 * (k * k * ((s + 1) * k - s));\n      }\n      return 0.5 * ((k -= 2) * k * ((s + 1) * k + s) + 2);\n    },\n\n  },\n\n  Bounce: {\n\n    In(k) {\n      return 1 - Tween.Bounce.Out(1 - k);\n    },\n\n    Out(k) {\n      if (k < (1 / 2.75)) {\n        return 7.5625 * k * k;\n      } else if (k < (2 / 2.75)) {\n        return 7.5625 * (k -= (1.5 / 2.75)) * k + 0.75;\n      } else if (k < (2.5 / 2.75)) {\n        return 7.5625 * (k -= (2.25 / 2.75)) * k + 0.9375;\n      }\n      return 7.5625 * (k -= (2.625 / 2.75)) * k + 0.984375;\n\n    },\n\n    InOut(k) {\n      if (k < 0.5) {\n        return Tween.Bounce.In(k * 2) * 0.5;\n      }\n      return Tween.Bounce.Out(k * 2 - 1) * 0.5 + 0.5;\n    },\n  },\n};\n\nexport default Tween;\n","import Animate from './Animate';\nimport Tween from '../utils/Tween';\nimport Utils from '../utils/Utils';\n\n/* eslint guard-for-in: \"off\" */\n\n/**\n * transition class\n * @private\n */\nclass Transition extends Animate {\n  constructor(options) {\n    super(options);\n\n    // collect from pose, when from was not complete\n    options.from = options.from || {};\n    for (const i in options.to) {\n      if (Utils.isUndefined(options.from[i])) options.from[i] = this.object.props(i);\n    }\n\n    /**\n     * timing function\n     */\n    this.ease = options.ease || Tween.Ease.InOut;\n\n    /**\n     * from pose\n     */\n    this.from = options.from;\n\n    /**\n     * to pose\n     */\n    this.to = options.to;\n  }\n\n  /**\n   * calculate next frame pose\n   * @private\n   * @return {object} pose state\n   */\n  nextPose() {\n    const pose = {};\n    const t = this.ease(this.progress / this.duration);\n    for (const i in this.to) {\n      pose[i] = this.linear(this.from[i], this.to[i], t);\n      this.object.props(i, pose[i]);\n    }\n    return pose;\n  }\n}\n\nexport default Transition;\n","import { Curve } from 'three';\nimport Animate from './Animate';\nimport Utils from '../utils/Utils';\nimport Tween from '../utils/Tween';\n\n/**\n * PathMotion class\n * @private\n */\nclass PathMotion extends Animate {\n  constructor(options) {\n    super(options);\n    if (!options.path || !(options.path instanceof Curve)) {\n      console.warn('path is not instanceof Curve');\n    }\n\n    /**\n     * path, extend curve\n     */\n    this.path = options.path;\n\n    /**\n     * timing function\n     */\n    this.ease = options.ease || Tween.Ease.InOut;\n\n    /**\n     * use lengthMode or not\n     */\n    this.lengthMode = Utils.isBoolean(options.lengthMode) ?\n      options.lengthMode :\n      false;\n\n    /**\n     * progress need clamp with [0, 1]\n     */\n    this.needClamp = Utils.isBoolean(options.needClamp) ?\n      options.needClamp :\n      true;\n\n    /**\n     * object need attach tangent\n     */\n    this.attachTangent = Utils.isBoolean(options.attachTangent) ?\n      options.attachTangent :\n      false;\n  }\n\n  /**\n   * caculation next pose\n   * @return {Vector3} position\n   */\n  nextPose() {\n    let t = this.ease(this.progress / this.duration);\n    if (this.needClamp) {\n      t = Utils.clamp(t, 0, 1);\n    }\n    const position = this.lengthMode ?\n      this.path.getPointAt(t) :\n      this.path.getPoint(t);\n\n    this.object.position.copy(position);\n    if (this.attachTangent) {\n      const direction = this.lengthMode ?\n        this.path.getTangentAt(t) :\n        this.path.getTangent(t);\n      this.object.lookAt(position.add(direction));\n    }\n    return position;\n  }\n}\n\nexport default PathMotion;\n","import Animate from './Animate';\nimport Transition from './Transition';\n// import Utils from '../utils/Utils';\nimport PathMotion from './PathMotion';\n\n/**\n * AnimateRunner, composer any animation type\n *\n * @private\n */\nclass AnimateRunner extends Animate {\n  /**\n   * config a runner animation\n   * @param {object} [options] runners config\n   */\n  constructor(options) {\n    super(options);\n    this.runners = options.runners;\n    this.cursor = 0;\n    this.queues = [];\n    this.alternate = false;\n\n    this.length = this.runners.length;\n\n    // TODO: Is it necessary to exist ?\n    // this.propsMap = [];\n    // this.prepare();\n  }\n\n  // prepare() {\n  //   let i = 0;\n  //   let j = 0;\n  //   for (i = 0; i < this.runners.length; i++) {\n  //     const runner = this.runners[i];\n  //     if (Utils.isUndefined(runner.to)) continue;\n  //     const keys = Object.keys(runner.to);\n  //     for (j = 0; j < keys.length; j++) {\n  //       const prop = keys[j];\n  //       if (this.propsMap.indexOf(prop) === -1) this.propsMap.push(prop);\n  //     }\n  //   }\n  //   for (i = 0; i < this.runners.length; i++) {\n  //     const runner = this.runners[i];\n  //     if (!runner.to) continue;\n  //     for (j = 0; j < this.propsMap.length; j++) {\n  //       const prop = this.propsMap[j];\n  //       if (Utils.isUndefined(runner.to[prop])) runner.to[prop] = this.object.props(prop);\n  //     }\n  //   }\n  // }\n\n  /**\n   * init a runner\n   * @private\n   */\n  initRunner() {\n    const runner = this.runners[this.cursor];\n    runner.infinite = false;\n    runner.resident = true;\n    runner.object = this.object;\n\n    let animate = null;\n    if (runner.path) {\n      animate = new PathMotion(runner);\n    } else if (runner.to) {\n      animate = new Transition(runner);\n    }\n    if (animate !== null) {\n      animate.on('complete', this.nextRunner.bind(this));\n      this.queues.push(animate);\n    }\n  }\n\n  /**\n   * step to next `runner`\n   * @param {Object} _ is hold for pose\n   * @param {Number} time time snippet\n   * @private\n   */\n  nextRunner(_, time) {\n    this.queues[this.cursor].init();\n    this.cursor += this.direction;\n    this.timeSnippet = time;\n  }\n\n  /**\n   * get next pose\n   * @param {Number} snippetCache time snippet\n   * @return {Object} pose\n   */\n  nextPose(snippetCache) {\n    if (!this.queues[this.cursor] && this.runners[this.cursor]) {\n      this.initRunner();\n    }\n    if (this.timeSnippet >= 0) {\n      snippetCache += this.timeSnippet;\n      this.timeSnippet = 0;\n    }\n    return this.queues[this.cursor].update(snippetCache);\n  }\n\n  /**\n   * update state\n   * @param {Number} snippet time snippet\n   * @return {Object} pose\n   */\n  update(snippet) {\n    if (this.wait > 0) {\n      this.wait -= Math.abs(snippet);\n      return;\n    }\n    if (this.paused || !this.living || this.delayCut > 0) {\n      if (this.delayCut > 0) this.delayCut -= Math.abs(snippet);\n      return;\n    }\n\n    const cc = this.cursor;\n\n    const pose = this.nextPose(this.direction * this.timeScale * snippet);\n\n    this.emit('update', {\n      index: cc,\n      pose,\n    }, this.progress / this.duration);\n\n    if (this.spill()) {\n      if (this.repeats > 0 || this.infinite) {\n        if (this.repeats > 0) --this.repeats;\n        this.delayCut = this.delay;\n        this.direction = 1;\n        this.cursor = 0;\n      } else {\n        if (!this.resident) this.living = false;\n        this.emit('complete', pose);\n      }\n    }\n    return pose;\n  }\n\n  /**\n   * check progress is spill?\n   * @return {Boolean} is spill\n   */\n  spill() {\n    // TODO: 这里应该保留溢出，不然会导致时间轴上的误差\n    const topSpill = this.cursor >= this.length;\n    return topSpill;\n  }\n}\n\nexport default AnimateRunner;\n","import Transition from './Transition';\nimport AnimateRunner from './AnimateRunner';\nimport PathMotion from './PathMotion';\n\n/**\n * timeline animations class\n * @private\n */\nclass TimelineAnimations {\n  constructor(object) {\n    /**\n     * display object cache it for use after\n     */\n    this.object = object;\n\n    /**\n     * object's all animates queue\n     *\n     * @member {Array}\n     */\n    this.animates = [];\n\n    /**\n     * object's timeline update time-scale\n     *\n     * @member {Number}\n     */\n    this.timeScale = 1;\n\n    /**\n     * pause the object's timeline update\n     *\n     * @member {Boolean}\n     */\n    this.paused = false;\n  }\n\n  /**\n   * update this object animates queue\n   * @param {Number} snippet time snippet\n   */\n  update(snippet) {\n    if (this.paused) return;\n    snippet = this.timeScale * snippet;\n    const cache = this.animates.slice(0);\n    for (let i = 0; i < cache.length; i++) {\n      if (!cache[i].living && !cache[i].resident) {\n        this.animates.splice(i, 1);\n      }\n      cache[i].update(snippet);\n    }\n  }\n\n  /**\n   * create a `animate` animation\n   *\n   * @private\n   * @param {object} options config for animate\n   * @param {boolean} clear whether clear all animation at before\n   * @return {Transition} transition animator\n   */\n  animate(options, clear) {\n    options.object = this.object;\n    return this._addMove(new Transition(options), clear);\n  }\n\n  /**\n   * create a `motion` animation\n   *\n   * @private\n   * @param {object} options config for motion\n   * @param {boolean} clear whether clear all animation at before\n   * @return {PathMotion} pathMotion animator\n   */\n  motion(options, clear) {\n    options.object = this.object;\n    return this._addMove(new PathMotion(options), clear);\n  }\n\n  /**\n   * create a `runners` animation\n   * @private\n   * @param {object} options config for motion\n   * @param {boolean} clear whether clear all animation at before\n   * @return {AnimateRunner} animateRunner animator\n   */\n  runners(options, clear) {\n    options.object = this.object;\n    return this._addMove(new AnimateRunner(options), clear);\n  }\n\n  /**\n   * create a `keyFrames` animation\n   * @private\n   * @param {object} options config for motion\n   * @param {boolean} clear whether clear all animation at before\n   * @return {KeyFrames} keyFrames animator\n   */\n  // keyFrames(options, clear) {\n  //   options.object = this.object;\n  //   return this._addMove(new KeyFrames(options), clear);\n  // }\n\n  /**\n   * add animator into animates queue\n   * @private\n   * @param {object} animate animator\n   * @param {boolean} clear whether clear all animation at before\n   * @return {Transition} animator\n   */\n  _addMove(animate, clear) {\n    if (clear) this.clear();\n    this.animates.push(animate);\n    return animate;\n  }\n\n  /**\n   * pause animates\n   */\n  pause() {\n    this.paused = true;\n  }\n\n  /**\n   * restore animates play\n   */\n  restart() {\n    this.paused = false;\n  }\n\n  /**\n   * set this queue's timeScale\n   * @param {Number} speed set timescale\n   */\n  setSpeed(speed) {\n    this.timeScale = speed;\n  }\n\n  /**\n   * clear all animates\n   * @private\n   */\n  clear() {\n    this.animates.length = 0;\n  }\n}\n\nexport { TimelineAnimations };\n","import { Object3D } from 'three';\nimport { TimelineAnimations } from '../animation/TimelineAnimations';\nimport Utils from '../utils/Utils';\n\n/**\n * timeline scale, effect this display-node and it's children\n */\nObject3D.prototype.timeScale = 1;\n\n/**\n * whether pause the timeline update with this display-node and it's children\n */\nObject3D.prototype.paused = false;\n\n/**\n * scale display-object with xyz together\n *\n */\nObject.defineProperty(Object3D.prototype, 'scaleXYZ', {\n  get() {\n    return this.scale.x;\n  },\n  set(scale) {\n    this.scale.x = this.scale.y = this.scale.z = scale;\n  },\n});\n\n/**\n * animate animation, let a display-object move from a pose to another pose\n *\n * ```js\n * model.animate({\n *   from: { 'position.x': 100 },\n *   to: { 'position.x': 200 },\n *   ease: Tween.Bounce.Out, // use which timing-function default: `Tween.Ease.InOut`\n *   repeats: 10, // repeat 10 times, after compelete this animation loop\n *   infinite: true, // infinite repeat forevery\n *   alternate: true, // repeat with alternate, just like yoyo\n *   duration: 1000, // animation duration 1000ms\n *   wait: 100, // animation await sometime\n *   onUpdate: function(state,rate){}, // will be invoked when update pose\n *   onComplete: function(){ console.log('end'); } // will be invoked when update last pose (complete)\n * });\n * ```\n *\n * @param {Object} options animate animation config\n * @param {Object} [options.from] which pose state this animate start with\n * @param {Object} options.to which pose state this animate to\n * @param {Tween} [options.ease=Tween.Ease.InOut] use which timing-function\n * @param {Number} [options.repeats=0] whether animate repeat some times, it's weight lower than `options.infinite`\n * @param {Number} [options.duration=300] animate duration\n * @param {Number} [options.wait=0] animate wait time before first start, not effect next repeat\n * @param {Number} [options.delay=0] animate delay time before start or restart, effect at repeat if it have\n * @param {Boolean} [options.infinite=false] whether animate infinite repeat, it's weight higher than `options.repeats`\n * @param {Boolean} [options.alternate=false] whether animate paly with alternate, just like yoyo\n * @param {Function} [options.onUpdate] will be invoked when update pose\n * @param {Function} [options.onComplete] will be invoked when update last pose (complete)\n * @param {Boolean} clear whether clear display-object's animation queue\n * @return {Animate} animate object\n */\nObject3D.prototype.animate = function(options, clear) {\n  if (!this.timelineAnimations) this.initTimeline();\n  return this.timelineAnimations.animate(options, clear);\n};\n\n/**\n * combine animation, let a display-object do animate one by one\n *\n * ```js\n * display.runners({\n *   runners: [\n *     { from: {}, to: {} },\n *     { path: JC.BezierCurve([ point1, point2, point3, point4 ]) },\n *   ],\n *   repeats: 10, // repeat 10 times, after compelete this animation loop\n *   infinite: true, // infinite repeat forevery\n *   alternate: true, // repeat with alternate, just like yoyo\n *   duration: 1000, // animation duration 1000ms\n *   onUpdate: function(state,rate){}, // will be invoked when update pose\n *   onComplete: function(){ console.log('end'); } // will be invoked when update last pose (complete)\n * });\n * ```\n *\n * @param {Object} options combine animation config\n * @param {Array} options.runners combine animation, support `animate`、`motion`\n * @param {Number} [options.repeats=0] whether animate repeat some times, it's weight lower than `options.infinite`\n * @param {Number} [options.duration=300] animate duration\n * @param {Number} [options.wait=0] animate wait time before first start, not effect next repeat\n * @param {Number} [options.delay=0] animate delay time before start or restart, effect at repeat if it have\n * @param {Boolean} [options.infinite=false] whether animate infinite repeat, it's weight higher than `options.repeats`\n * @param {Boolean} [options.alternate=false] whether animate paly with alternate, just like yoyo\n * @param {Function} [options.onUpdate] will be invoked when update pose\n * @param {Function} [options.onComplete] will be invoked when update last pose (complete)\n * @param {Boolean} clear whether clear display-object's animation queue\n * @return {Animate} Animate\n */\nObject3D.prototype.runners = function(options, clear) {\n  if (!this.timelineAnimations) this.initTimeline();\n  return this.timelineAnimations.runners(options, clear);\n};\n\n/**\n * motion animation, let a display-object move along with the path\n *\n * ```js\n * display.motion({\n *   path: new SvgCurve('M10 10 H 90 V 90 H 10 L 10 10), // path, should instance of Curve\n *   attachTangent: true, // whether display-object should attach tangent or not\n *   ease: Tween.Bounce.Out, // use which timing-function default: `Tween.Ease.InOut`\n *   repeats: 10, // repeat 10 times, after compelete this animation loop\n *   infinite: true, // infinite repeat forevery\n *   alternate: true, // repeat with alternate, just like yoyo\n *   duration: 1000, // animation duration 1000ms\n *   wait: 100, // animation await sometime\n *   onUpdate: function(state,rate){}, // will be invoked when update pose\n *   onComplete: function(){ console.log('end'); } // will be invoked when update last pose (complete)\n * });\n * ```\n * @param {Object} options motion animation config\n * @param {Curve} options.path path, should instance of Curve\n * @param {Boolean} [options.attachTangent=false] whether display-object should attach tangent or not\n * @param {Boolean} [options.lengthMode=false] whether move with length-mode or not\n * @param {Tween} [options.ease=Tween.Ease.InOut] use which timing-function\n * @param {Number} [options.repeats=0] whether animate repeat some times, it's weight lower than `options.infinite`\n * @param {Number} [options.duration=300] animate duration\n * @param {Number} [options.wait=0] animate wait time before first start, not effect next repeat\n * @param {Number} [options.delay=0] animate delay time before start or restart, effect at repeat if it have\n * @param {Boolean} [options.infinite=false] whether animate infinite repeat, it's weight higher than `options.repeats`\n * @param {Boolean} [options.alternate=false] whether animate paly with alternate, just like yoyo\n * @param {Function} [options.onUpdate] will be invoked when update pose\n * @param {Function} [options.onComplete] will be invoked when update last pose (complete)\n * @param {Boolean} clear whether clear display-object's animation queue\n * @return {Animate} Animate\n */\nObject3D.prototype.motion = function(options, clear) {\n  if (!this.timelineAnimations) this.initTimeline();\n  return this.timelineAnimations.motion(options, clear);\n};\n\n/**\n * initial timeline when it was not created\n *\n * @private\n */\nObject3D.prototype.initTimeline = function() {\n  this.timelineAnimations = new TimelineAnimations(this);\n};\n\n/**\n * update display-object animation\n *\n * @private\n * @param {Number} snippet time snippet\n */\nObject3D.prototype.updateAnimations = function(snippet) {\n  if (!this.timelineAnimations) return;\n  this.timelineAnimations.update(snippet);\n};\n\n/**\n * update display-object timeline\n *\n * @param {Number} snippet time snippet\n */\nObject3D.prototype.updateTimeline = function(snippet) {\n  if (this.paused) return;\n  snippet = this.timeScale * snippet;\n\n  this.emit('pretimeline', {\n    snippet,\n  });\n\n  this.updateAnimations(snippet);\n\n  let i = 0;\n  const children = this.children;\n  const length = children.length;\n  while (i < length) {\n    children[i].updateTimeline(snippet);\n    i++;\n  }\n\n  this.emit('posttimeline', {\n    snippet,\n  });\n};\n\n/**\n * get depth property from this object\n *\n * @private\n * @param {String} key property chain\n * @param {Number} value want set which value\n * @return {Number} return number\n */\nObject3D.prototype.props = function(key, value) {\n  if (!key) return;\n\n  const rawKeys = key.split('.');\n\n  if (rawKeys.length === 0) {\n    if (Utils.isUndefined(value)) {\n      return this[key];\n    }\n    this[key] = value;\n    return value;\n  }\n\n  const prop = rawKeys.pop();\n  const head = rawKeys.join('.');\n\n  if (!this.keysMaps || !this.keysMaps[head]) {\n    this.linkProp(head, rawKeys);\n  }\n\n  if (Utils.isUndefined(value)) {\n    return this.keysMaps[head][prop];\n  }\n  this.keysMaps[head][prop] = value;\n  return value;\n};\n\nObject3D.prototype.linkProp = function(head, rawKeys) {\n  if (!this.keysMaps) this.keysMaps = {};\n  let prop = this;\n  for (let i = 0; i < rawKeys.length; i++) {\n    const key = rawKeys[i];\n    prop = prop[key];\n  }\n  this.keysMaps[head] = prop;\n};\n\n","import { Vector3 } from 'three';\n\nexport default class Smooth {\n  constructor(object, options) {\n    options = options || {};\n    this.object = object;\n    this.to = new Vector3().copy(object);\n    this.now = this.to.clone();\n    this.speed = options.speed || 0.02;\n    this.noise = options.noise || 0.000001;\n  }\n  goto(x, y, z) {\n    this.to.set(x, y, z);\n  }\n  update() {\n    const space = this.to.clone().sub(this.now).multiplyScalar(this.speed);\n    if (space.length() < this.noise) return;\n    this.now.add(space);\n    this.object.x = this.now.x;\n    this.object.y = this.now.y;\n    this.object.z = this.now.z;\n  }\n}\n","import { EventDispatcher, Quaternion, Vector3, Euler } from 'three';\nimport Utils from './Utils';\n\nconst zee = new Vector3(0, 0, 1);\n\nconst euler = new Euler();\n\nconst q0 = new Quaternion();\n\nconst q1 = new Quaternion(-Math.sqrt(0.5), 0, 0, Math.sqrt(0.5)); // - PI/2 around the x-axis\n\nconst ROTATE_ORDER = 'YXZ';\n\nclass Orienter extends EventDispatcher {\n  constructor(options) {\n    super();\n    options = options || {};\n\n    this._orient = this._orient.bind(this);\n    this._change = this._change.bind(this);\n\n    this.needFix = Utils.isBoolean(options.needFix) ? options.needFix : true;\n    this.fix = 0;\n    this.timing = 8;\n\n    this.alpha = 0;\n    this.beta = 0;\n    this.gamma = 0;\n    this.lon = 0;\n    this.lat = 0;\n    this.direction = 0;\n    this.quaternion = new Quaternion();\n\n    this.eared = false;\n    this.nodce = true;\n    this.connect();\n  }\n\n  connect() {\n    this._change();\n    if (this.eared) return;\n    this.eared = true;\n    window.addEventListener('deviceorientation', this._orient, false);\n    window.addEventListener('orientationchange', this._change, false);\n  }\n\n  disconnect() {\n    this.eared = false;\n    window.removeEventListener('deviceorientation', this._orient, false);\n    window.removeEventListener('orientationchange', this._change, false);\n  }\n\n  _orient(event) {\n    if (!Utils.isNumber(event.alpha) || !Utils.isNumber(event.beta) || !Utils.isNumber(event.gamma)) {\n      this.nodce = true;\n      return;\n    }\n    if (this.needFix) {\n      if (this.timing === 0) {\n        this.needFix = false;\n        this.fix = event.alpha;\n      }\n      this.timing--;\n    } else {\n      this.alpha = Utils.euclideanModulo(event.alpha - this.fix, 360);\n    }\n    this.nodce = false;\n\n    this.beta = event.beta;\n    this.gamma = event.gamma;\n\n    this.update();\n\n    this.emit('deviceorientation', {\n      alpha: this.alpha,\n      beta: this.beta,\n      gamma: this.gamma,\n      lon: this.lon,\n      lat: this.lat,\n      quaternion: this.quaternion,\n    });\n  }\n\n  update() {\n    if (!this.eared || this.nodce) return;\n    const alpha = Utils.DTR(this.alpha);\n    const beta = Utils.DTR(this.beta);\n    const gamma = Utils.DTR(this.gamma);\n    euler.set(beta, alpha, -gamma, ROTATE_ORDER); // 'ZXY' for the device, but 'YXZ' for us\n\n    this.quaternion.setFromEuler(euler); // orient the device\n    this.quaternion.multiply(q1); // camera looks out the back of the device, not the top\n    this.quaternion.multiply(q0.setFromAxisAngle(zee, -this.direction)); // adjust for screen orientation\n\n    this.calculation();\n  }\n\n  calculation() {\n    this.lon = Utils.euclideanModulo(this.alpha + this.gamma, 360);\n\n    const face = new Vector3(0, 0, -1);\n    face.applyQuaternion(this.quaternion);\n    const xzFace = new Vector3(face.x, 0, face.z);\n    const cos = Utils.clamp(xzFace.dot(face), -1, 1);\n    const nor = face.y >= 0 ? 1 : -1;\n    const degree = Utils.RTD(Math.acos(cos));\n    this.lat = this.beta < 0 ? nor * (180 - degree) : nor * degree;\n  }\n\n  _change() {\n    this.direction = window.orientation || 0;\n    this.update();\n  }\n}\n\nexport default Orienter;\n","import {\n  Object3D,\n} from 'three';\nimport Utils from '../utils/Utils';\n\n/**\n * used to link 3d-model with reality world, an ar-glue\n *\n * @param {Object} options config\n * @param {String} options.name ar-glue name, same with `setMarkers` name-id\n * @param {Boolean} [options.autoHide=true] whether auto-hide when marker have not detected\n */\nclass ARGlue extends Object3D {\n  constructor(options) {\n    super();\n    options = options || {};\n\n    /**\n     * unique name in all ar-glue object\n     *\n     * @member {String}\n     */\n    this.name = options.name;\n\n    /**\n     * whether auto-hide when marker have not detected\n     *\n     * @member {Boolean}\n     */\n    this.autoHide = Utils.isBoolean(options.autoHide) ? options.autoHide : true;\n\n    /**\n     * close this object matrixAutoUpdate, just recive matrix from `UC-AR`\n     *\n     * @member {Boolean}\n     */\n    this.matrixAutoUpdate = false;\n\n    /**\n     * class type, a mark to distinguish ar-glue and normal display-object\n     *\n     * @member {String}\n     */\n    this.type = 'ARGlue';\n\n    if (!options.name) {\n      console.error('ARGlue: this glue must have a name');\n    }\n  }\n\n  /**\n   * update this glue pose matrix\n   * @param {Array} matrix pose matrix\n   * @param {Boolean} isDetected whether detected at this tick\n   */\n  updatePose(matrix, isDetected) {\n    if (this.autoHide && !isDetected) {\n      this.visible = false;\n    } else {\n      this.visible = true;\n    }\n    this.matrix.fromArray(matrix);\n  }\n}\n\nexport default ARGlue;\n","import Utils from '../utils/Utils';\n\nfunction setDefault(check, value, spare) {\n  return check(value) ? value : spare;\n}\n\n/**\n * ViewPort class, a default config for WebGLRenderer with-in UC-AR\n *\n * @private\n * @param {Object} options custom config for WebGLRenderer\n * @param {String|canvas} options.canvas `canvas-dom` or canvas `css-selector`\n * @param {Boolean} [options.alpha=false] whether the canvas contains an alpha (transparency) buffer or not.\n * @param {Boolean} [options.antialias=false] whether to perform antialiasing.\n * @param {String} [options.precision='highp'] Shader precision, Can be `highp`, `mediump` or `lowp`.\n * @param {Boolean} [options.premultipliedAlpha=true] whether the renderer will assume that colors have premultiplied alpha.\n * @param {Boolean} [options.stencil=true] whether the drawing buffer has a stencil buffer of at least 8 bits.\n * @param {Boolean} [options.preserveDrawingBuffer=false] whether to preserve the buffers until manually cleared or overwritten.\n * @param {Boolean} [options.depth=true] whether the drawing buffer has a depth buffer of at least 16 bits.\n * @param {Boolean} [options.logarithmicDepthBuffer] whether to use a logarithmic depth buffer.\n */\nexport default class ViewPort {\n  constructor(options) {\n    /**\n     * canvas dom element\n     *\n     * @member {canvas}\n     */\n    this.canvas = Utils.isString(options.canvas) ?\n      document.getElementById(options.canvas) ||\n      document.querySelector(options.canvas) :\n      options.canvas;\n\n    /**\n     * Shader precision\n     *\n     * @member {String}\n     */\n    this.precision = options.precision;\n\n    /**\n     * canvas contains an alpha (transparency) buffer or not\n     *\n     * @member {Boolean}\n     */\n    this.alpha = setDefault(Utils.isBoolean, options.alpha, true);\n\n    /**\n     * whether to perform antialiasing\n     *\n     * @member {Boolean}\n     */\n    this.antialias = setDefault(Utils.isBoolean, options.antialias, true);\n\n    /**\n     * whether the renderer will assume that colors have premultiplied alpha.\n     *\n     * @member {Boolean}\n     */\n    this.premultipliedAlpha = options.premultipliedAlpha;\n\n    /**\n     * whether the drawing buffer has a stencil buffer of at least 8 bits.\n     *\n     * @member {Boolean}\n     */\n    this.stencil = options.stencil;\n\n    /**\n     * whether to preserve the buffers until manually cleared or overwritten.\n     *\n     * @member {Boolean}\n     */\n    this.preserveDrawingBuffer = options.preserveDrawingBuffer;\n\n    /**\n     * whether the drawing buffer has a depth buffer of at least 16 bits.\n     *\n     * @member {Boolean}\n     */\n    this.depth = options.depth;\n\n    /**\n     * whether to use a logarithmic depth buffer.\n     *\n     * @member {Boolean}\n     */\n    this.logarithmicDepthBuffer = options.logarithmicDepthBuffer;\n  }\n}\n","/* eslint no-unused-vars: 0 */\n\nexport default class Pass {\n  constructor() {\n    // if set to true, the pass is processed by the composer\n    this.enabled = true;\n\n    // if set to true, the pass indicates to swap read and write buffer after rendering\n    this.needsSwap = true;\n\n    // if set to true, the pass clears its buffer before rendering\n    this.clear = false;\n\n    // if set to true, the result of the pass is rendered to screen\n    this.renderToScreen = false;\n  }\n\n  setSize(width, height) {}\n\n  render(renderer, writeBuffer, readBuffer, delta, maskActive) {\n    console.error('Pass: .render() must be implemented in derived pass.');\n  }\n}\n","/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Full-screen textured quad shader\n * @private\n */\n\nconst CopyShader = {\n\n  uniforms: {\n\n    tDiffuse: { value: null },\n    opacity: { value: 1.0 },\n\n  },\n\n  vertexShader: `\n  varying vec2 vUv;\n  void main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  }`,\n\n  fragmentShader: `\n  uniform float opacity;\n  uniform sampler2D tDiffuse;\n  varying vec2 vUv;\n  void main() {\n    vec4 texel = texture2D( tDiffuse, vUv );\n    gl_FragColor = opacity * texel;\n  }`,\n\n};\n\nexport default CopyShader;\n","import { Vector2 } from 'three';\n/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Convolution shader\n * ported from o3d sample to WebGL / GLSL\n * http://o3d.googlecode.com/svn/trunk/samples/convolution.html\n * @private\n */\nconst ConvolutionShader = {\n\n  defines: {\n\n    KERNEL_SIZE_FLOAT: '25.0',\n    KERNEL_SIZE_INT: '25',\n\n  },\n\n  uniforms: {\n\n    tDiffuse: { value: null },\n    uImageIncrement: { value: new Vector2(0.001953125, 0.0) },\n    cKernel: { value: [] },\n\n  },\n\n  vertexShader: `\n  uniform vec2 uImageIncrement;\n  varying vec2 vUv;\n  void main() {\n    vUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  }`,\n\n  fragmentShader: `\n  uniform float cKernel[ KERNEL_SIZE_INT ];\n  uniform sampler2D tDiffuse;\n  uniform vec2 uImageIncrement;\n  varying vec2 vUv;\n  void main() {\n    vec2 imageCoord = vUv;\n    vec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );\n    for( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {\n      sum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];\n      imageCoord += uImageIncrement;\n    }\n    gl_FragColor = sum;\n  }`,\n\n  buildKernel(sigma) {\n\n    // We lop off the sqrt(2 * pi) * sigma term, since we're going to normalize anyway.\n\n    function gauss(x, sigma) {\n\n      return Math.exp(-(x * x) / (2.0 * sigma * sigma));\n\n    }\n\n    let i;\n    let sum;\n    const kMaxKernelSize = 25;\n    let kernelSize = 2 * Math.ceil(sigma * 3.0) + 1;\n\n    if (kernelSize > kMaxKernelSize) kernelSize = kMaxKernelSize;\n    const halfWidth = (kernelSize - 1) * 0.5;\n\n    const values = new Array(kernelSize);\n    sum = 0.0;\n    for (i = 0; i < kernelSize; ++i) {\n\n      values[ i ] = gauss(i - halfWidth, sigma);\n      sum += values[ i ];\n\n    }\n\n    // normalize the kernel\n\n    for (i = 0; i < kernelSize; ++i) values[ i ] /= sum;\n\n    return values;\n\n  },\n\n};\n\nexport default ConvolutionShader;\n","import {\n  LinearFilter,\n  RGBAFormat,\n  WebGLRenderTarget,\n  UniformsUtils,\n  ShaderMaterial,\n  AdditiveBlending,\n  Vector2,\n  OrthographicCamera,\n  Scene,\n  Mesh,\n  PlaneBufferGeometry,\n} from 'three';\nimport Pass from './Pass';\nimport CopyShader from '../shader/CopyShader';\nimport ConvolutionShader from '../shader/ConvolutionShader';\n\nexport default class BloomPass extends Pass {\n  constructor(strength, kernelSize, sigma, resolution) {\n    super();\n    strength = (strength !== undefined) ? strength : 1;\n    kernelSize = (kernelSize !== undefined) ? kernelSize : 25;\n    sigma = (sigma !== undefined) ? sigma : 4.0;\n    resolution = (resolution !== undefined) ? resolution : 256;\n\n    // render targets\n\n    const pars = { minFilter: LinearFilter, magFilter: LinearFilter, format: RGBAFormat };\n\n    this.renderTargetX = new WebGLRenderTarget(resolution, resolution, pars);\n    this.renderTargetX.texture.name = 'BloomPass.x';\n    this.renderTargetY = new WebGLRenderTarget(resolution, resolution, pars);\n    this.renderTargetY.texture.name = 'BloomPass.y';\n\n    // copy material\n\n    if (CopyShader === undefined) console.error('BloomPass relies on CopyShader');\n\n    const copyShader = CopyShader;\n\n    this.copyUniforms = UniformsUtils.clone(copyShader.uniforms);\n\n    this.copyUniforms.opacity.value = strength;\n\n    this.materialCopy = new ShaderMaterial({\n      uniforms: this.copyUniforms,\n      vertexShader: copyShader.vertexShader,\n      fragmentShader: copyShader.fragmentShader,\n      blending: AdditiveBlending,\n      transparent: true,\n    });\n\n    // convolution material\n\n    if (ConvolutionShader === undefined) console.error('BloomPass relies on ConvolutionShader');\n\n    const convolutionShader = ConvolutionShader;\n\n    this.convolutionUniforms = UniformsUtils.clone(convolutionShader.uniforms);\n\n    this.convolutionUniforms.uImageIncrement.value = BloomPass.blurX;\n    this.convolutionUniforms.cKernel.value = ConvolutionShader.buildKernel(sigma);\n\n    this.materialConvolution = new ShaderMaterial({\n      uniforms: this.convolutionUniforms,\n      vertexShader: convolutionShader.vertexShader,\n      fragmentShader: convolutionShader.fragmentShader,\n      defines: {\n        KERNEL_SIZE_FLOAT: kernelSize.toFixed(1),\n        KERNEL_SIZE_INT: kernelSize.toFixed(0),\n      },\n    });\n\n    this.needsSwap = false;\n\n    this.camera = new OrthographicCamera(-1, 1, 1, -1, 0, 1);\n    this.scene = new Scene();\n\n    this.quad = new Mesh(new PlaneBufferGeometry(2, 2), null);\n    this.quad.frustumCulled = false; // Avoid getting clipped\n    this.scene.add(this.quad);\n  }\n\n  render(renderer, writeBuffer, readBuffer, delta, maskActive) {\n\n    if (maskActive) renderer.context.disable(renderer.context.STENCIL_TEST);\n\n    // Render quad with blured scene into texture (convolution pass 1)\n\n    this.quad.material = this.materialConvolution;\n\n    this.convolutionUniforms.tDiffuse.value = readBuffer.texture;\n    this.convolutionUniforms.uImageIncrement.value = BloomPass.blurX;\n\n    renderer.render(this.scene, this.camera, this.renderTargetX, true);\n\n\n    // Render quad with blured scene into texture (convolution pass 2)\n\n    this.convolutionUniforms.tDiffuse.value = this.renderTargetX.texture;\n    this.convolutionUniforms.uImageIncrement.value = BloomPass.blurY;\n\n    renderer.render(this.scene, this.camera, this.renderTargetY, true);\n\n    // Render original scene with superimposed blur to texture\n\n    this.quad.material = this.materialCopy;\n\n    this.copyUniforms.tDiffuse.value = this.renderTargetY.texture;\n\n    if (maskActive) renderer.context.enable(renderer.context.STENCIL_TEST);\n\n    renderer.render(this.scene, this.camera, readBuffer, this.clear);\n\n  }\n}\n\nBloomPass.blurX = new Vector2(0.001953125, 0.0);\nBloomPass.blurY = new Vector2(0.0, 0.001953125);\n","import Pass from './Pass';\n\nexport default class ClearMaskPass extends Pass {\n  constructor() {\n    super();\n    this.needsSwap = false;\n  }\n\n  render(renderer) {\n    renderer.state.buffers.stencil.setTest(false);\n  }\n}\n","/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Film grain & scanlines shader\n *\n * - ported from HLSL to WebGL / GLSL\n * http://www.truevision3d.com/forums/showcase/staticnoise_colorblackwhite_scanline_shaders-t18698.0.html\n *\n * Screen Space Static Postprocessor\n *\n * Produces an analogue noise overlay similar to a film grain / TV static\n *\n * Original implementation and noise algorithm\n * Pat 'Hawthorne' Shearon\n *\n * Optimized scanlines + noise version with intensity scaling\n * Georg 'Leviathan' Steinrohder\n *\n * This version is provided under a Creative Commons Attribution 3.0 License\n * http://creativecommons.org/licenses/by/3.0/\n * @private\n */\nconst FilmShader = {\n  uniforms: {\n    tDiffuse: { value: null },\n    time: { value: 0.0 },\n    nIntensity: { value: 0.5 },\n    sIntensity: { value: 0.05 },\n    sCount: { value: 4096 },\n    grayscale: { value: 1 },\n  },\n\n  vertexShader: `\n  varying vec2 vUv;\n  void main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  }`,\n\n  fragmentShader: `\n  #include <common>\n  // control parameter\n  uniform float time;\n\n  uniform bool grayscale;\n\n  // noise effect intensity value (0 = no effect, 1 = full effect)\n  uniform float nIntensity;\n\n  // scanlines effect intensity value (0 = no effect, 1 = full effect)\n  uniform float sIntensity;\n\n  // scanlines effect count value (0 = no effect, 4096 = full effect)\n  uniform float sCount;\n\n  uniform sampler2D tDiffuse;\n\n  varying vec2 vUv;\n\n  void main() {\n    // sample the source\n    vec4 cTextureScreen = texture2D( tDiffuse, vUv );\n\n    // make some noise\n    float dx = rand( vUv + time );\n\n    // add noise\n    vec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx, 0.0, 1.0 );\n\n    // get us a sine and cosine\n    vec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );\n\n    // add scanlines\n    cResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;\n\n    // interpolate between source and result by intensity\n    cResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );\n\n    // convert to grayscale if desired\n    if( grayscale ) {\n\n      cResult = vec3( cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 );\n\n    }\n\n    gl_FragColor =  vec4( cResult, cTextureScreen.a );\n\n  }`,\n\n};\n\nexport default FilmShader;\n","import {\n  UniformsUtils,\n  ShaderMaterial,\n  OrthographicCamera,\n  Scene,\n  Mesh,\n  PlaneBufferGeometry,\n} from 'three';\nimport Pass from './Pass';\nimport FilmShader from '../shader/FilmShader';\n\n/**\n * @author alteredq / http://alteredqualia.com/\n * @private\n */\nexport default class FilmPass extends Pass {\n  constructor(noiseIntensity, scanlinesIntensity, scanlinesCount, grayscale) {\n    super();\n\n    if (FilmShader === undefined) console.error('FilmPass relies on FilmShader');\n\n    const shader = FilmShader;\n\n    this.uniforms = UniformsUtils.clone(shader.uniforms);\n\n    this.material = new ShaderMaterial({\n\n      uniforms: this.uniforms,\n      vertexShader: shader.vertexShader,\n      fragmentShader: shader.fragmentShader,\n\n    });\n\n    if (grayscale !== undefined)\tthis.uniforms.grayscale.value = grayscale;\n    if (noiseIntensity !== undefined) this.uniforms.nIntensity.value = noiseIntensity;\n    if (scanlinesIntensity !== undefined) this.uniforms.sIntensity.value = scanlinesIntensity;\n    if (scanlinesCount !== undefined) this.uniforms.sCount.value = scanlinesCount;\n\n    this.camera = new OrthographicCamera(-1, 1, 1, -1, 0, 1);\n    this.scene = new Scene();\n\n    this.quad = new Mesh(new PlaneBufferGeometry(2, 2), null);\n    this.quad.frustumCulled = false; // Avoid getting clipped\n    this.scene.add(this.quad);\n  }\n\n  render(renderer, writeBuffer, readBuffer, delta) {\n\n    this.uniforms.tDiffuse.value = readBuffer.texture;\n    this.uniforms.time.value += delta;\n\n    this.quad.material = this.material;\n\n    if (this.renderToScreen) {\n\n      renderer.render(this.scene, this.camera);\n\n    } else {\n\n      renderer.render(this.scene, this.camera, writeBuffer, this.clear);\n\n    }\n\n  }\n}\n","/**\n * @author felixturner / http://airtight.cc/\n *\n * RGB Shift Shader\n * Shifts red and blue channels from center in opposite directions\n * Ported from http://kriss.cx/tom/2009/05/rgb-shift/\n * by Tom Butterworth / http://kriss.cx/tom/\n *\n * amount: shift distance (1 is width of input)\n * angle: shift angle in radians\n * @private\n */\nconst DigitalGlitch = {\n\n  uniforms: {\n\n    tDiffuse: { value: null }, // diffuse texture\n    tDisp: { value: null }, // displacement texture for digital glitch squares\n    byp: { value: 0 }, // apply the glitch ?\n    amount: { value: 0.08 },\n    angle: { value: 0.02 },\n    seed: { value: 0.02 },\n    seed_x: { value: 0.02 }, // -1,1\n    seed_y: { value: 0.02 }, // -1,1\n    distortion_x:\t{ value: 0.5 },\n    distortion_y:\t{ value: 0.6 },\n    col_s: { value: 0.05 },\n  },\n\n  vertexShader: `\n  varying vec2 vUv;\n  void main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  }`,\n\n  fragmentShader: `\n  uniform int byp; // should we apply the glitch ?\n\n  uniform sampler2D tDiffuse;\n  uniform sampler2D tDisp;\n\n  uniform float amount;\n  uniform float angle;\n  uniform float seed;\n  uniform float seed_x;\n  uniform float seed_y;\n  uniform float distortion_x;\n  uniform float distortion_y;\n  uniform float col_s;\n\n  varying vec2 vUv;\n\n\n  float rand(vec2 co){\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n  }\n\n  void main() {\n    if(byp<1) {\n      vec2 p = vUv;\n      float xs = floor(gl_FragCoord.x / 0.5);\n      float ys = floor(gl_FragCoord.y / 0.5);\n      // based on staffantans glitch shader for unity https://github.com/staffantan/unityglitch\n      vec4 normal = texture2D (tDisp, p*seed*seed);\n      if(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {\n        if(seed_x>0.){\n          p.y = 1. - (p.y + distortion_y);\n        }\n        else {\n          p.y = distortion_y;\n        }\n      }\n      if(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {\n        if(seed_y>0.){\n          p.x=distortion_x;\n        }\n        else {\n          p.x = 1. - (p.x + distortion_x);\n        }\n      }\n      p.x+=normal.x*seed_x*(seed/5.);\n      p.y+=normal.y*seed_y*(seed/5.);\n      // base from RGB shift shader\n      vec2 offset = amount * vec2( cos(angle), sin(angle));\n      vec4 cr = texture2D(tDiffuse, p + offset);\n      vec4 cga = texture2D(tDiffuse, p);\n      vec4 cb = texture2D(tDiffuse, p - offset);\n      gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);\n      // add noise\n      vec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);\n      gl_FragColor = gl_FragColor+ snow;\n    }\n    else {\n      gl_FragColor=texture2D (tDiffuse, vUv);\n    }\n  }`,\n\n};\n\nexport default DigitalGlitch;\n","import {\n  UniformsUtils,\n  ShaderMaterial,\n  OrthographicCamera,\n  Scene,\n  Mesh,\n  PlaneBufferGeometry,\n  DataTexture,\n  RGBFormat,\n  FloatType,\n} from 'three';\nimport Pass from './Pass';\nimport DigitalGlitch from '../shader/DigitalGlitch';\nimport Utils from '../utils/Utils';\n\n/**\n * @author alteredq / http://alteredqualia.com/\n * @private\n */\nexport default class GlitchPass extends Pass {\n  constructor(dt_size) {\n    super();\n    if (DigitalGlitch === undefined) console.error('GlitchPass relies on DigitalGlitch');\n\n    const shader = DigitalGlitch;\n    this.uniforms = UniformsUtils.clone(shader.uniforms);\n\n    if (dt_size === undefined) dt_size = 64;\n\n\n    this.uniforms.tDisp.value = this.generateHeightmap(dt_size);\n\n\n    this.material = new ShaderMaterial({\n      uniforms: this.uniforms,\n      vertexShader: shader.vertexShader,\n      fragmentShader: shader.fragmentShader,\n    });\n\n    this.camera = new OrthographicCamera(-1, 1, 1, -1, 0, 1);\n    this.scene = new Scene();\n\n    this.quad = new Mesh(new PlaneBufferGeometry(2, 2), null);\n    this.quad.frustumCulled = false; // Avoid getting clipped\n    this.scene.add(this.quad);\n\n    this.goWild = false;\n    this.curF = 0;\n    this.generateTrigger();\n  }\n  render(renderer, writeBuffer, readBuffer) {\n\n    this.uniforms.tDiffuse.value = readBuffer.texture;\n    this.uniforms.seed.value = Math.random(); // default seeding\n    this.uniforms.byp.value = 0;\n\n    if (this.curF % this.randX === 0 || this.goWild === true) {\n\n      this.uniforms.amount.value = Math.random() / 30;\n      this.uniforms.angle.value = Utils.random(-Math.PI, Math.PI);\n      this.uniforms.seed_x.value = Utils.random(-1, 1);\n      this.uniforms.seed_y.value = Utils.random(-1, 1);\n      this.uniforms.distortion_x.value = Utils.random(0, 1);\n      this.uniforms.distortion_y.value = Utils.random(0, 1);\n      this.curF = 0;\n      this.generateTrigger();\n\n    } else if (this.curF % this.randX < this.randX / 5) {\n\n      this.uniforms.amount.value = Math.random() / 90;\n      this.uniforms.angle.value = Utils.random(-Math.PI, Math.PI);\n      this.uniforms.distortion_x.value = Utils.random(0, 1);\n      this.uniforms.distortion_y.value = Utils.random(0, 1);\n      this.uniforms.seed_x.value = Utils.random(-0.3, 0.3);\n      this.uniforms.seed_y.value = Utils.random(-0.3, 0.3);\n\n    } else if (this.goWild === false) {\n\n      this.uniforms.byp.value = 1;\n\n    }\n\n    this.curF++;\n    this.quad.material = this.material;\n\n    if (this.renderToScreen) {\n\n      renderer.render(this.scene, this.camera);\n\n    } else {\n\n      renderer.render(this.scene, this.camera, writeBuffer, this.clear);\n\n    }\n\n  }\n\n  generateTrigger() {\n\n    this.randX = Utils.random(120, 240) >> 0;\n\n  }\n\n  generateHeightmap(dt_size) {\n\n    const data_arr = new Float32Array(dt_size * dt_size * 3);\n    const length = dt_size * dt_size;\n\n    for (let i = 0; i < length; i++) {\n\n      const val = Utils.random(0, 1);\n      data_arr[ i * 3 + 0 ] = val;\n      data_arr[ i * 3 + 1 ] = val;\n      data_arr[ i * 3 + 2 ] = val;\n\n    }\n\n    const texture = new DataTexture(data_arr, dt_size, dt_size, RGBFormat, FloatType);\n    texture.needsUpdate = true;\n    return texture;\n\n  }\n}\n","import Pass from './Pass';\n\n/**\n * @author alteredq / http://alteredqualia.com/\n * @private\n */\nexport default class MaskPass extends Pass {\n  constructor(scene, camera) {\n    super();\n    this.scene = scene;\n    this.camera = camera;\n\n    this.clear = true;\n    this.needsSwap = false;\n    this.inverse = false;\n  }\n\n  render(renderer, writeBuffer, readBuffer) {\n\n    const context = renderer.context;\n    const state = renderer.state;\n\n    // don't update color or depth\n\n    state.buffers.color.setMask(false);\n    state.buffers.depth.setMask(false);\n\n    // lock buffers\n\n    state.buffers.color.setLocked(true);\n    state.buffers.depth.setLocked(true);\n\n    // set up stencil\n\n    let writeValue;\n    let clearValue;\n\n    if (this.inverse) {\n\n      writeValue = 0;\n      clearValue = 1;\n\n    } else {\n\n      writeValue = 1;\n      clearValue = 0;\n\n    }\n\n    state.buffers.stencil.setTest(true);\n    state.buffers.stencil.setOp(context.REPLACE, context.REPLACE, context.REPLACE);\n    state.buffers.stencil.setFunc(context.ALWAYS, writeValue, 0xffffffff);\n    state.buffers.stencil.setClear(clearValue);\n\n    // draw into the stencil buffer\n\n    renderer.render(this.scene, this.camera, readBuffer, this.clear);\n    renderer.render(this.scene, this.camera, writeBuffer, this.clear);\n\n    // unlock color and depth buffer for subsequent rendering\n\n    state.buffers.color.setLocked(false);\n    state.buffers.depth.setLocked(false);\n\n    // only render where stencil is set to 1\n\n    state.buffers.stencil.setFunc(context.EQUAL, 1, 0xffffffff); // draw if == 1\n    state.buffers.stencil.setOp(context.KEEP, context.KEEP, context.KEEP);\n\n  }\n\n}\n","/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Focus shader\n * based on PaintEffect postprocess from ro.me\n * http://code.google.com/p/3-dreams-of-black/source/browse/deploy/js/effects/PaintEffect.js\n * @private\n */\nconst MattingShader = {\n\n  uniforms: {\n\n    tDiffuse: { value: null },\n\n    hueStart: { value: 0.0 },\n    hueEnd: { value: 1.0 },\n    lightnessStart: { value: 0.4 },\n    lightnessEnd: { value: 1.0 },\n\n  },\n\n  vertexShader: `\n  varying vec2 vUv;\n  void main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  }`,\n\n  fragmentShader: `\n  uniform float hueStart;\n  uniform float hueEnd;\n  uniform float lightnessStart;\n  uniform float lightnessEnd;\n\n  uniform sampler2D tDiffuse;\n\n  varying vec2 vUv;\n\n  vec3 rgb2hsv(vec3 c){\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n  }\n\n  void main() {\n    float lightnessCenter = (lightnessStart + lightnessEnd) / 2.0;\n    float lightnessRadius = (lightnessEnd - lightnessStart) / 2.0;\n\n    vec4 rgbColor = texture2D( tDiffuse, vUv );\n\n    vec3 hsv = rgb2hsv(rgbColor.rgb);\n\n    float alpha = 1.0;\n\n    // if (hsv.x > hueStart && hsv.x < hueEnd) {\n      float distance = abs(hsv.z - lightnessCenter) / lightnessRadius;\n      alpha = clamp(distance, 0.0, 1.0);\n    // }\n    gl_FragColor = vec4(rgbColor.rgb, alpha * alpha);\n\n  }`,\n};\n\nexport default MattingShader;\n","import {\n  Color,\n} from 'three';\n\n/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Focus shader\n * based on PaintEffect postprocess from ro.me\n * http://code.google.com/p/3-dreams-of-black/source/browse/deploy/js/effects/PaintEffect.js\n * @private\n */\nconst EdgeBlurShader = {\n\n  uniforms: {\n\n    tDiffuse: { value: null },\n\n    frameSize: { value: [] },\n\n    cKernel: { value: [\n      0.045, 0.122, 0.045,\n      0.122, 0.332, 0.122,\n      0.045, 0.122, 0.045,\n    ] },\n\n  },\n\n  vertexShader: `\n  varying vec2 vUv;\n  void main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  }`,\n\n  fragmentShader: `\n  uniform float cKernel[9];\n\n  uniform vec2 frameSize;\n\n  uniform sampler2D tDiffuse;\n\n  varying vec2 vUv;\n\n  void main() {\n    vec2 onePixel = vec2(1.0, 1.0) / frameSize;\n\n    vec4 rgbColor =\n      texture2D(tDiffuse, vUv + onePixel * vec2(-1, -1)) * cKernel[0] +\n      texture2D(tDiffuse, vUv + onePixel * vec2( 0, -1)) * cKernel[1] +\n      texture2D(tDiffuse, vUv + onePixel * vec2( 1, -1)) * cKernel[2] +\n      texture2D(tDiffuse, vUv + onePixel * vec2(-1,  0)) * cKernel[3] +\n      texture2D(tDiffuse, vUv + onePixel * vec2( 0,  0)) * cKernel[4] +\n      texture2D(tDiffuse, vUv + onePixel * vec2( 1,  0)) * cKernel[5] +\n      texture2D(tDiffuse, vUv + onePixel * vec2(-1,  1)) * cKernel[6] +\n      texture2D(tDiffuse, vUv + onePixel * vec2( 0,  1)) * cKernel[7] +\n      texture2D(tDiffuse, vUv + onePixel * vec2( 1,  1)) * cKernel[8] ;\n\n    gl_FragColor = rgbColor;\n  }`,\n};\n\nexport default EdgeBlurShader;\n","import {\n  LinearFilter,\n  RGBAFormat,\n  WebGLRenderTarget,\n  UniformsUtils,\n  ShaderMaterial,\n  AdditiveBlending,\n  Vector2,\n  OrthographicCamera,\n  Scene,\n  Mesh,\n  PlaneBufferGeometry,\n} from 'three';\nimport Pass from './Pass';\nimport CopyShader from '../shader/CopyShader';\nimport MattingShader from '../shader/MattingShader';\nimport EdgeBlur from '../shader/EdgeBlur';\n\nexport default class MattingPass extends Pass {\n  constructor(primer, options) {\n    super();\n\n    const { width, height, strength = 1.0, hueStart = 0.0, hueEnd = 1.0, lightnessStart = 0.6, lightnessEnd = 1.0 } = options || {};\n\n    this.primer = primer;\n\n    // render targets\n\n    const pars = { minFilter: LinearFilter, magFilter: LinearFilter, format: RGBAFormat };\n\n    this.renderTargetX = new WebGLRenderTarget(width, height, pars);\n    this.renderTargetX.texture.name = 'MattingPass.x';\n    this.renderTargetY = new WebGLRenderTarget(width, height, pars);\n    this.renderTargetY.texture.name = 'MattingPass.y';\n\n    // copy material\n\n    if (CopyShader === undefined) console.error('MattingPass relies on CopyShader');\n\n    const copyShader = CopyShader;\n\n    this.copyUniforms = UniformsUtils.clone(copyShader.uniforms);\n\n    this.copyUniforms.opacity.value = strength;\n\n    this.materialCopy = new ShaderMaterial({\n      uniforms: this.copyUniforms,\n      vertexShader: copyShader.vertexShader,\n      fragmentShader: copyShader.fragmentShader,\n      blending: AdditiveBlending,\n      transparent: true,\n    });\n\n    // matting material\n\n    if (MattingShader === undefined) console.error('MattingPass relies on MattingShader');\n\n    this.mattingUniforms = UniformsUtils.clone(MattingShader.uniforms);\n\n    this.mattingUniforms.hueStart.value = hueStart;\n    this.mattingUniforms.hueEnd.value = hueEnd;\n    this.mattingUniforms.lightnessStart.value = lightnessStart;\n    this.mattingUniforms.lightnessEnd.value = lightnessEnd;\n\n    this.materialMatting = new ShaderMaterial({\n      uniforms: this.mattingUniforms,\n      vertexShader: MattingShader.vertexShader,\n      fragmentShader: MattingShader.fragmentShader,\n      blending: AdditiveBlending,\n      transparent: true,\n    });\n\n    this.edgeBlurUniforms = UniformsUtils.clone(EdgeBlur.uniforms);\n    this.edgeBlurUniforms.frameSize.value = new Vector2(width, height);\n\n\n    this.materialEdgeBlur = new ShaderMaterial({\n      uniforms: this.edgeBlurUniforms,\n      vertexShader: EdgeBlur.vertexShader,\n      fragmentShader: EdgeBlur.fragmentShader,\n      blending: AdditiveBlending,\n      transparent: true,\n    });\n\n    this.needsSwap = false;\n\n    this.camera = new OrthographicCamera(-1, 1, 1, -1, 0, 1);\n    this.scene = new Scene();\n\n    this.quad = new Mesh(new PlaneBufferGeometry(2, 2), null);\n    this.quad.frustumCulled = false; // Avoid getting clipped\n    this.scene.add(this.quad);\n  }\n\n  render(renderer, writeBuffer, readBuffer, delta, maskActive) {\n\n    if (maskActive) renderer.context.disable(renderer.context.STENCIL_TEST);\n\n    this.primer.render(renderer, this.renderTargetX);\n\n    this.quad.material = this.materialMatting;\n    this.mattingUniforms.tDiffuse.value = this.renderTargetX.texture;\n    renderer.render(this.scene, this.camera, this.renderTargetY, true);\n\n\n    this.quad.material = this.materialEdgeBlur;\n    this.edgeBlurUniforms.tDiffuse.value = this.renderTargetY.texture;\n    renderer.render(this.scene, this.camera, null, this.clear);\n\n    // Render quad with blured scene into texture (convolution pass 2)\n\n    // this.convolutionUniforms.tDiffuse.value = this.renderTargetX.texture;\n    // this.convolutionUniforms.uImageIncrement.value = MattingPass.blurY;\n\n    // renderer.render(this.scene, this.camera, this.renderTargetY, true);\n\n    // // Render original scene with superimposed blur to texture\n\n    // this.quad.material = this.materialCopy;\n\n    // this.copyUniforms.tDiffuse.value = this.renderTargetY.texture;\n\n    if (maskActive) renderer.context.enable(renderer.context.STENCIL_TEST);\n\n    // renderer.render(this.scene, this.camera, readBuffer, this.clear);\n\n  }\n}\n","import Pass from './Pass';\n\nexport default class RenderPass extends Pass {\n  constructor(scene, camera, overrideMaterial, clearColor, clearAlpha) {\n    super();\n    this.scene = scene;\n    this.camera = camera;\n\n    this.overrideMaterial = overrideMaterial;\n\n    this.clearColor = clearColor;\n    this.clearAlpha = (clearAlpha !== undefined) ? clearAlpha : 0;\n\n    this.clear = false;\n    this.clearDepth = false;\n    this.needsSwap = false;\n  }\n\n  render(renderer, writeBuffer, readBuffer) {\n\n    const oldAutoClear = renderer.autoClear;\n    renderer.autoClear = false;\n\n    this.scene.overrideMaterial = this.overrideMaterial;\n\n    let oldClearColor;\n    let oldClearAlpha;\n\n    if (this.clearColor) {\n\n      oldClearColor = renderer.getClearColor().getHex();\n      oldClearAlpha = renderer.getClearAlpha();\n\n      renderer.setClearColor(this.clearColor, this.clearAlpha);\n\n    }\n\n    if (this.clearDepth) {\n\n      renderer.clearDepth();\n\n    }\n\n    renderer.render(this.scene, this.camera, this.renderToScreen ? null : readBuffer, this.clear);\n\n    if (this.clearColor) {\n\n      renderer.setClearColor(oldClearColor, oldClearAlpha);\n\n    }\n\n    this.scene.overrideMaterial = null;\n    renderer.autoClear = oldAutoClear;\n  }\n}\n","import { ShaderMaterial, UniformsUtils, OrthographicCamera, Scene, Mesh, PlaneBufferGeometry } from 'three';\nimport Pass from './Pass';\n/**\n * @author alteredq / http://alteredqualia.com/\n * @private\n */\nexport default class ShaderPass extends Pass {\n  constructor(shader, textureID) {\n    super();\n    this.textureID = (textureID !== undefined) ? textureID : 'tDiffuse';\n\n    if (shader instanceof ShaderMaterial) {\n\n      this.uniforms = shader.uniforms;\n\n      this.material = shader;\n\n    } else if (shader) {\n\n      this.uniforms = UniformsUtils.clone(shader.uniforms);\n\n      this.material = new ShaderMaterial({\n\n        defines: shader.defines || {},\n        uniforms: this.uniforms,\n        vertexShader: shader.vertexShader,\n        fragmentShader: shader.fragmentShader,\n\n      });\n\n    }\n\n    this.camera = new OrthographicCamera(-1, 1, 1, -1, 0, 1);\n    this.scene = new Scene();\n\n    this.quad = new Mesh(new PlaneBufferGeometry(2, 2), null);\n    this.quad.frustumCulled = false; // Avoid getting clipped\n    this.scene.add(this.quad);\n  }\n\n  render(renderer, writeBuffer, readBuffer) {\n\n    if (this.uniforms[ this.textureID ]) {\n      this.uniforms[ this.textureID ].value = readBuffer.texture;\n    }\n\n    this.quad.material = this.material;\n\n    if (this.renderToScreen) {\n      renderer.render(this.scene, this.camera);\n    } else {\n      renderer.render(this.scene, this.camera, writeBuffer, this.clear);\n    }\n  }\n}\n","/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Focus shader\n * based on PaintEffect postprocess from ro.me\n * http://code.google.com/p/3-dreams-of-black/source/browse/deploy/js/effects/PaintEffect.js\n * @private\n */\nconst FocusShader = {\n\n  uniforms: {\n\n    tDiffuse: { value: null },\n    screenWidth: { value: 1024 },\n    screenHeight: { value: 1024 },\n    sampleDistance: { value: 0.94 },\n    waveFactor: { value: 0.00125 },\n\n  },\n\n  vertexShader: `\n  varying vec2 vUv;\n  void main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  }`,\n\n  fragmentShader: `\n  uniform float screenWidth;\n  uniform float screenHeight;\n  uniform float sampleDistance;\n  uniform float waveFactor;\n\n  uniform sampler2D tDiffuse;\n\n  varying vec2 vUv;\n\n  void main() {\n\n    vec4 color, org, tmp, add;\n    float sample_dist, f;\n    vec2 vin;\n    vec2 uv = vUv;\n\n    add = color = org = texture2D( tDiffuse, uv );\n\n    vin = ( uv - vec2( 0.5 ) ) * vec2( 1.4 );\n    sample_dist = dot( vin, vin ) * 2.0;\n\n    f = ( waveFactor * 100.0 + sample_dist ) * sampleDistance * 4.0;\n\n    vec2 sampleSize = vec2(  1.0 / screenWidth, 1.0 / screenHeight ) * vec2( f );\n\n    add += tmp = texture2D( tDiffuse, uv + vec2( 0.111964, 0.993712 ) * sampleSize );\n    if( tmp.b < color.b ) color = tmp;\n\n    add += tmp = texture2D( tDiffuse, uv + vec2( 0.846724, 0.532032 ) * sampleSize );\n    if( tmp.b < color.b ) color = tmp;\n\n    add += tmp = texture2D( tDiffuse, uv + vec2( 0.943883, -0.330279 ) * sampleSize );\n    if( tmp.b < color.b ) color = tmp;\n\n    add += tmp = texture2D( tDiffuse, uv + vec2( 0.330279, -0.943883 ) * sampleSize );\n    if( tmp.b < color.b ) color = tmp;\n\n    add += tmp = texture2D( tDiffuse, uv + vec2( -0.532032, -0.846724 ) * sampleSize );\n    if( tmp.b < color.b ) color = tmp;\n\n    add += tmp = texture2D( tDiffuse, uv + vec2( -0.993712, -0.111964 ) * sampleSize );\n    if( tmp.b < color.b ) color = tmp;\n\n    add += tmp = texture2D( tDiffuse, uv + vec2( -0.707107, 0.707107 ) * sampleSize );\n    if( tmp.b < color.b ) color = tmp;\n\n    color = color * vec4( 2.0 ) - ( add / vec4( 8.0 ) );\n    color = color + ( add / vec4( 8.0 ) - color ) * ( vec4( 1.0 ) - vec4( sample_dist * 0.5 ) );\n\n    gl_FragColor = vec4( color.rgb * color.rgb * vec3( 0.95 ) + color.rgb, 1.0 );\n\n  }`,\n};\n\nexport default FocusShader;\n","import { LinearFilter, RGBAFormat, WebGLRenderTarget } from 'three';\nimport CopyShader from '../shader/CopyShader';\nimport ShaderPass from './ShaderPass';\nimport MaskPass from './MaskPass';\nimport ClearMaskPass from './ClearMaskPass';\n\nconst parameters = {\n  minFilter: LinearFilter,\n  magFilter: LinearFilter,\n  format: RGBAFormat,\n  stencilBuffer: false,\n};\n\n/**\n * @author alteredq / http://alteredqualia.com/\n * @private\n */\nexport default class EffectComposer {\n  constructor(renderer, autoToScreen) {\n    this.cw = 0;\n    this.ch = 0;\n\n    this.renderer = renderer;\n\n    this.autoToScreen = autoToScreen || false;\n\n    const size = renderer.getDrawingBufferSize();\n    this.cw = size.width;\n    this.ch = size.height;\n    this.renderTarget1 = new WebGLRenderTarget(size.width, size.height, parameters);\n    this.renderTarget1.texture.name = 'EffectComposer.rt1';\n\n    this.renderTarget2 = this.renderTarget1.clone();\n    this.renderTarget2.texture.name = 'EffectComposer.rt2';\n\n    this.writeBuffer = this.renderTarget1;\n    this.readBuffer = this.renderTarget2;\n\n    this.passes = [];\n\n    // dependencies\n\n    if (CopyShader === undefined) {\n      console.error('EffectComposer relies on CopyShader');\n    }\n\n    if (ShaderPass === undefined) {\n      console.error('EffectComposer relies on ShaderPass');\n    }\n\n    this.copyPass = new ShaderPass(CopyShader);\n\n  }\n\n  swapBuffers() {\n    const tmp = this.readBuffer;\n    this.readBuffer = this.writeBuffer;\n    this.writeBuffer = tmp;\n  }\n\n  addPass(pass) {\n    this.passes.push(pass);\n\n    const size = this.renderer.getDrawingBufferSize();\n    pass.setSize(size.width, size.height);\n  }\n\n  insertPass(pass, index) {\n    this.passes.splice(index, 0, pass);\n  }\n\n  render(delta) {\n    let maskActive = false;\n    const il = this.passes.length;\n\n    this.setRTS();\n\n    for (let i = 0; i < il; i++) {\n      const pass = this.passes[i];\n      if (pass.enabled === false) continue;\n      pass.render(this.renderer, this.writeBuffer, this.readBuffer, delta, maskActive);\n\n      if (pass.needsSwap) {\n        if (maskActive) {\n          const context = this.renderer.context;\n          context.stencilFunc(context.NOTEQUAL, 1, 0xffffffff);\n          this.copyPass.render(this.renderer, this.writeBuffer, this.readBuffer, delta);\n          context.stencilFunc(context.EQUAL, 1, 0xffffffff);\n        }\n        this.swapBuffers();\n      }\n\n      if (MaskPass !== undefined) {\n        if (pass instanceof MaskPass) {\n          maskActive = true;\n        } else if (pass instanceof ClearMaskPass) {\n          maskActive = false;\n        }\n      }\n    }\n  }\n\n  setRTS() {\n    let l = this.passes.length - 1;\n    let first = true;\n\n    for (; l >= 0; l--) {\n      const pass = this.passes[l];\n      if (pass.enabled && first) {\n        pass.renderToScreen = true;\n        first = false;\n      } else {\n        pass.renderToScreen = false;\n      }\n    }\n  }\n\n  reset(renderTarget) {\n    if (renderTarget === undefined) {\n      const size = this.renderer.getDrawingBufferSize();\n      renderTarget = this.renderTarget1.clone();\n      renderTarget.setSize(size.width, size.height);\n    }\n\n    this.renderTarget1.dispose();\n    this.renderTarget2.dispose();\n    this.renderTarget1 = renderTarget;\n    this.renderTarget2 = renderTarget.clone();\n\n    this.writeBuffer = this.renderTarget1;\n    this.readBuffer = this.renderTarget2;\n\n  }\n\n  setSize(width, height) {\n    if (width === this.cw && height === this.ch) return;\n\n    this.renderTarget1.setSize(width, height);\n    this.renderTarget2.setSize(width, height);\n\n    for (let i = 0; i < this.passes.length; i++) {\n      this.passes[i].setSize(width, height);\n    }\n    this.cw = width;\n    this.ch = height;\n  }\n\n  get isActive() {\n    const length = this.passes.length;\n    const hasPass = length > 0;\n    let invalid = false;\n    for (let i = 0; i < length; i++) {\n      if (this.passes[i].enabled) {\n        invalid = true;\n        break;\n      }\n    }\n    return hasPass && invalid;\n  }\n}\n","import { OrthographicCamera, Scene, Mesh, PlaneBufferGeometry, MeshBasicMaterial } from 'three';\nimport EffectComposer from '../postprocessing/EffectComposer';\n\n/**\n * render layer, for multi-function render pipeline, support after-effects\n */\nclass Layer {\n  /**\n   * layer required a renderer\n   * @param {WebGLRenderer} renderer webgl renderer\n   * @param {Object} options options\n   */\n  constructor(renderer) {\n    /**\n     * the parent of this layer, sometime was compositor\n     * @member {Compositor}\n     */\n    this.parent = null;\n\n    /**\n     * zIndex order, for render list\n     * @member {Number}\n     * @private\n     */\n    this._zIndex = 0;\n\n    /**\n     * layer tag, fast check isLayer\n     * @member {Boolean}\n     */\n    this.isLayer = true;\n\n    /**\n     * cache renderer object in local\n     * @member {WebGLRenderer}\n     */\n    this.renderer = renderer;\n\n    /**\n     * Not Recommend set it to true, if it was true, this layer will forced rendering to the screen,\n     * you should make sure why you set renderToScreen with true.\n     * @member {Boolean}\n     */\n    this.renderToScreen = false;\n\n    /**\n     * framebuffer will auto clear\n     * @member {Boolean}\n     */\n    this.autoClear = true;\n\n    /**\n     * effect composer, for postprogressing\n     * @member {EffectComposer}\n     */\n    this.afterEffects = new EffectComposer(this.renderer);\n\n    /**\n     * after effect update delta\n     * @member {Number}\n     */\n    this.aeDelta = 0;\n\n    /**\n     * orthographic camera, for composite draw\n     * @member {OrthographicCamera}\n     */\n    this.camera = new OrthographicCamera(-1, 1, 1, -1, 0, 1);\n\n    /**\n     * scene, for composite draw\n     * @member {Scene}\n     */\n    this.scene = new Scene();\n\n    const readBuffer = this.afterEffects.readBuffer;\n    /**\n     * quad, for composite draw\n     * @member {Mesh}\n     */\n    this.quad = new Mesh(\n      new PlaneBufferGeometry(2, 2),\n      new MeshBasicMaterial({\n        transparent: true,\n        map: readBuffer.texture,\n        depthTest: false,\n        depthWrite: false,\n      }));\n\n    this.scene.add(this.quad);\n  }\n\n  /**\n   * clear framebuffer\n   */\n  clear() {\n    this.renderer.setRenderTarget(this.afterEffects.readBuffer);\n    this.renderer.clear(this.renderer.autoClearColor, this.renderer.autoClearDepth, this.renderer.autoClearStencil);\n  }\n\n  /**\n   * composite draw, use it when need composition\n   * @param {WebGLRenderTarget} renderTarget render to which buffer\n   * @private\n   */\n  draw(renderTarget) {\n    this.renderer.render(this.scene, this.camera, renderTarget);\n  }\n\n  /**\n   * add a after-effects pass to this layer\n   * @param {Pass} pass pass process\n   */\n  addPass(pass) {\n    this.afterEffects.addPass(pass);\n  }\n\n  /**\n   * insert a after-effects pass to this layer\n   * @param {Pass} pass pass process\n   * @param {Number} index insert which position\n   */\n  insertPass(pass, index) {\n    this.afterEffects.insertPass(pass, index);\n  }\n\n  /**\n   * get zIndex\n   * @return {Number} zIndex\n   */\n  get zIndex() {\n    return this._zIndex;\n  }\n\n  /**\n   * set zIndex\n   * @param {Number} index zIndex\n   */\n  set zIndex(index) {\n    if (this._zIndex !== index) {\n      this._zIndex = index;\n      if (this.parent) {\n        this.parent.needSort = true;\n      }\n    }\n  }\n\n  /**\n   * get after-effects was active\n   * @return {Boolean} active or not\n   */\n  get isAeOpen() {\n    return this.afterEffects.isActive;\n  }\n}\n\nexport default Layer;\n","import { Scene } from 'three';\nimport Layer from './Layer';\n\n/**\n * graphicsLayer, use to display 3d scene, support after-effects\n */\nclass GraphicsLayer extends Layer {\n  /**\n   * required renderer, and you can set config for WebGLRenderTarget\n   * @param {WebGLRenderer} renderer webgl renderer\n   * @param {Object} options config for renderTarget\n   */\n  constructor(renderer, options) {\n    super(renderer, options);\n\n    /**\n     * graphics 3d scene\n     * @member {Scene}\n     */\n    this.graphics = new Scene();\n  }\n\n  /**\n   * update timeline\n   * @param {Number} snippet time snippet\n   * @private\n   */\n  updateTimeline(snippet) {\n    this.scene.updateTimeline(snippet);\n    this.graphics.updateTimeline(snippet);\n  }\n\n  /**\n   * render graphicsLayer to buffer\n   * @param {PerspectiveCamera} camera use which Perspective-Camera to look the world\n   */\n  render(camera) {\n    const renderTarget = this.renderToScreen ? null : this.afterEffects.readBuffer;\n\n    if (this.autoClear) this.clear();\n\n    this.renderer.render(this.graphics, camera, renderTarget);\n\n    if (this.isAeOpen) {\n      this.afterEffects.render(this.aeDelta);\n    }\n  }\n\n  /**\n   * push a display object into graphics\n   *\n   * @param {THREE.Object3D} child display object, which will be rendering\n   * @return {this} this\n   */\n  add() {\n    this.graphics.add.apply(this.graphics, arguments);\n    return this;\n  }\n\n  /**\n   * remove a display object from graphics\n   *\n   * @param {THREE.Object3D} child display object, which you had push it at before\n   * @return {this} this\n   */\n  remove() {\n    this.graphics.remove.apply(this.graphics, arguments);\n    return this;\n  }\n}\n\nexport default GraphicsLayer;\n\n","import Layer from './Layer';\n\n/**\n * primerLayer, use to display primers content, support after-effects\n */\nclass PrimerLayer extends Layer {\n  /**\n   * required renderer, and you can set config for WebGLRenderTarget\n   * @param {WebGLRenderer} renderer webgl renderer\n   * @param {Object} options config for renderTarget\n   */\n  constructor(renderer, options) {\n    super(renderer, options);\n\n    this.primers = [];\n  }\n\n  /**\n   * update timeline\n   * @param {Number} snippet time snippet\n   * @private\n   */\n  updateTimeline(snippet) {\n    this.scene.updateTimeline(snippet);\n\n    this.primers.forEach(primer => {\n      primer.updateTimeline(snippet);\n    });\n  }\n\n  /**\n   * render primerLayer to buffer\n   * @param {PerspectiveCamera} camera use which Perspective-Camera to look around the world\n   */\n  render() {\n    const renderTarget = this.renderToScreen ? null : this.afterEffects.readBuffer;\n\n    if (this.autoClear) this.clear();\n\n    const length = this.primers.length;\n    for (let i = 0; i < length; i++) {\n      const primer = this.primers[i];\n      if (primer.enabled) primer.render(this.renderer, renderTarget);\n    }\n\n    if (this.isAeOpen) {\n      this.afterEffects.render(this.aeDelta);\n    }\n  }\n\n  /**\n   * push a display object into primerLayer scene\n   *\n   * @param {THREE.Object3D} object display object, which will be rendering\n   * @return {this} this\n   */\n  add(object) {\n    if (arguments.length > 1) {\n      for (let i = 0; i < arguments.length; i++) {\n        this.add(arguments[ i ]);\n      }\n      return this;\n    }\n\n    if ((object && object.isPrimer)) {\n      if (object.parent !== null) {\n        object.parent.remove(object);\n      }\n\n      object.parent = this;\n\n      this.primers.push(object);\n    } else {\n      console.error('PrimerLayer.add: object not an instance of Primer.', object);\n    }\n    return this;\n  }\n\n  /**\n   * remove a display object from primerLayer scene\n   *\n   * @param {THREE.Object3D} object display object, which will be rendering\n   * @return {this} this\n   */\n  remove(object) {\n    if (arguments.length > 1) {\n      for (let i = 0; i < arguments.length; i++) {\n        this.remove(arguments[ i ]);\n      }\n      return this;\n    }\n    const index = this.primers.indexOf(object);\n\n    if (index !== -1) {\n      object.parent = null;\n      this.primers.splice(index, 1);\n    }\n    return this;\n  }\n\n  /**\n   * get primers status\n   */\n  get isEmpty() {\n    const length = this.primers.length;\n    const none = length === 0;\n    let invalid = true;\n    for (let i = 0; i < length; i++) {\n      if (this.primers[i].enabled) {\n        invalid = false;\n        break;\n      }\n    }\n    return none || invalid;\n  }\n}\n\nexport default PrimerLayer;\n","import EffectComposer from '../postprocessing/EffectComposer';\n\n/**\n * compositor, use to merge primerLayer and graphicsLayer\n */\nclass Compositor {\n  /**\n   * compositor required a renderer\n   * @param {WebGLRenderer} renderer webgl renderer\n   */\n  constructor(renderer) {\n    /**\n     * cache renderer object in local\n     * @member {WebGLRenderer}\n     */\n    this.renderer = renderer;\n\n    /**\n     * whether sort layers or not\n     * @member {Boolean}\n     */\n    this.needSort = false;\n\n    /**\n     * framebuffer will auto clear\n     * @member {Boolean}\n     */\n    this.autoClear = true;\n\n    /**\n     * store layers\n     * @member {Array}\n     */\n    this.layers = [];\n\n    /**\n     * effect composer, for postprogressing\n     * @member {EffectComposer}\n     */\n    this.afterEffects = new EffectComposer(this.renderer, true);\n\n    /**\n     * after effect update delta\n     * @member {Number}\n     */\n    this.aeDelta = 0;\n  }\n\n  /**\n   * merge layer with zIndex order, and add after effects\n   * @param {PerspectiveCamera} camera use which Perspective-Camera to look the world\n   */\n  render(camera) {\n    if (this.needSort) this._sortList();\n    this.renderLayers(camera);\n    this.composition();\n  }\n\n  renderLayers(camera) {\n    for (let i = 0; i < this.layers.length; i++) {\n      const layer = this.layers[i];\n      layer.render(camera);\n    }\n  }\n\n  composition() {\n    const isAeOpen = this.isAeOpen;\n\n    const renderTarget = isAeOpen ? this.afterEffects.readBuffer : null;\n\n    if (this.autoClear) this.clear(renderTarget);\n\n    for (let i = 0; i < this.layers.length; i++) {\n      const layer = this.layers[i];\n      layer.draw(renderTarget);\n    }\n\n    if (isAeOpen) {\n      this.afterEffects.render(this.aeDelta);\n    }\n  }\n\n  /**\n   * clear framebuffer\n   * @param {WebGLRenderTarget} renderTarget clear which render target\n   */\n  clear(renderTarget) {\n    this.renderer.setRenderTarget(renderTarget);\n    this.renderer.clear(this.renderer.autoClearColor, this.renderer.autoClearDepth, this.renderer.autoClearStencil);\n  }\n\n  /**\n   * add a layer into compositor\n   *\n   * @param {Layer} layer primerLayer or graphicsLayer\n   * @return {this} this\n   */\n  add(layer) {\n    if (arguments.length > 1) {\n      for (let i = 0; i < arguments.length; i++) {\n        this.add(arguments[ i ]);\n      }\n      return this;\n    }\n\n    if ((layer && layer.isLayer)) {\n      if (layer.parent !== null) {\n        layer.parent.remove(layer);\n      }\n\n      layer.parent = this;\n\n      this.layers.push(layer);\n      this.needSort = true;\n    } else {\n      console.error('Compositor.add: layer not an instance of PrimerLayer or GraphicsLayer.', layer);\n    }\n    return this;\n  }\n\n  /**\n   * remove a layer from compositor\n   *\n   * @param {Layer} layer primerLayer or graphicsLayer\n   * @return {this} this\n   */\n  remove(layer) {\n    if (arguments.length > 1) {\n      for (let i = 0; i < arguments.length; i++) {\n        this.remove(arguments[ i ]);\n      }\n      return this;\n    }\n    const index = this.layers.indexOf(layer);\n\n    if (index !== -1) {\n      layer.parent = null;\n      this.layers.splice(index, 1);\n    }\n    return this;\n  }\n\n  /**\n   * add a after-effects pass to this compositor\n   * @param {Pass} pass pass process\n   */\n  addPass(pass) {\n    this.afterEffects.addPass(pass);\n  }\n\n  /**\n   * insert a after-effects pass to this compositor\n   * @param {Pass} pass pass process\n   * @param {Number} index insert to which position\n   */\n  insertPass(pass, index) {\n    this.afterEffects.insertPass(pass, index);\n  }\n\n  /**\n   * sort layer, because array.sort was not stable-sort, so use bubble sort\n   * @private\n   */\n  _sortList() {\n    const layers = this.layers;\n    const length = layers.length;\n    let i;\n    let j;\n    let temp;\n    for (i = 0; i < length - 1; i++) {\n      for (j = 0; j < length - 1 - i; j++) {\n        if (layers[j].zIndex > layers[j + 1].zIndex) {\n          temp = layers[j];\n          layers[j] = layers[j + 1];\n          layers[j + 1] = temp;\n        }\n      }\n    }\n    this.needSort = false;\n  }\n\n  /**\n   * get after-effects was active\n   * @return {Boolean} active or not\n   */\n  get isAeOpen() {\n    return this.afterEffects.isActive;\n  }\n}\n\nexport default Compositor;\n","import { WebGLRenderer, EventDispatcher } from 'three';\nimport GraphicsLayer from './GraphicsLayer';\nimport PrimerLayer from './PrimerLayer';\nimport Compositor from './Compositor';\nimport ViewPort from './ViewPort';\nimport Utils from '../utils/Utils';\n\n/**\n * a `UC-AR` renderer framework, help you building AR-APP fastly\n * @extends EventDispatcher\n * @param {Object} options config for `Viewer` render view-port\n * @param {canvas} options.canvas `canvas-dom` or canvas `css-selector`\n * @param {Boolean} [options.autoClear=true] whether the renderer should automatically clear its output before rendering a frame.\n * @param {Boolean} [options.alpha=false] whether the canvas contains an alpha (transparency) buffer or not.\n * @param {Boolean} [options.antialias=false] whether to perform antialiasing.\n * @param {String} [options.precision='highp'] Shader precision, Can be `highp`, `mediump` or `lowp`.\n * @param {Boolean} [options.premultipliedAlpha=true] whether the renderer will assume that colors have premultiplied alpha.\n * @param {Boolean} [options.stencil=true] whether the drawing buffer has a stencil buffer of at least 8 bits.\n * @param {Boolean} [options.preserveDrawingBuffer=false] whether to preserve the buffers until manually cleared or overwritten.\n * @param {Boolean} [options.depth=true] whether the drawing buffer has a depth buffer of at least 16 bits.\n * @param {Boolean} [options.logarithmicDepthBuffer] whether to use a logarithmic depth buffer.\n */\nclass Viewer extends EventDispatcher {\n  constructor(options) {\n\n    const { width = 300, height = 150, updateStyle = false } = options;\n\n    super();\n\n    /**\n     * view-port camera object, a perspective camera\n     *\n     * @member {Camera}\n     */\n    this.camera = null;\n\n    /**\n     * `WebGL` renderer object, base on `three.js` gl context\n     * @member {WebGLRenderer}\n     */\n    this.renderer = new WebGLRenderer(new ViewPort(options));\n\n    /**\n     * init set renderer size\n     * @private\n     */\n    this.renderer.setSize(width, height, updateStyle);\n\n    /**\n     * close auto-clear, and change\n     * @private\n     */\n    this.renderer.autoClear = false;\n\n    /**\n     * whether the renderer should automatically clear its output before rendering a frame.\n     *\n     * @member {Boolean}\n     */\n    this.autoClear = Utils.isBoolean(options.autoClear) ? options.autoClear : true;\n\n    /**\n     * whether update is working or not\n     *\n     * @member {Boolean}\n     */\n    this.ticking = false;\n\n    /**\n     * pre-time cache\n     *\n     * @member {Number}\n     * @private\n     */\n    this.pt = 0;\n\n    /**\n     * how long the time through, at this tick\n     *\n     * @member {Number}\n     * @private\n     */\n    this.snippet = 0;\n\n    /**\n     * set it when you hope engine update at a fixed fps, default 60/fps\n     *\n     * @member {Number}\n     */\n    this.fps = options.fps || 60;\n\n    /**\n     * time-scale for timeline\n     *\n     * @member {Number}\n     */\n    this.timeScale = 1;\n\n    /**\n     * primer paint a plane as a background or foreground\n     * @member {PrimerLayer}\n     */\n    this.primerLayer = new PrimerLayer(this.renderer);\n\n    /**\n     * 3d Graphics layer, for render 3d scene\n     * @member {GraphicsLayer}\n     */\n    this.graphicsLayer = new GraphicsLayer(this.renderer);\n\n    /**\n     * compositor primerLayer and graphicsLayer with zIndex order\n     * @member {Compositor}\n     */\n    this.compositor = new Compositor(this.renderer);\n\n    /**\n     * add primerLayer and graphicsLayer to compositor\n     */\n    this.compositor.add(this.primerLayer, this.graphicsLayer);\n  }\n\n  /**\n   * update timeline and update render\n   */\n  update() {\n    this.timeline();\n    const snippet = this.snippet;\n\n    this.emit('pretimeline', {\n      snippet,\n    });\n    this.updateTimeline(snippet);\n    this.emit('posttimeline', {\n      snippet,\n    });\n\n    this.emit('prerender', {\n      snippet,\n    });\n    this.render();\n    this.emit('postrender', {\n      snippet,\n    });\n  }\n\n  /**\n   * update timeline\n   * @param {Number} snippet time snippet\n   * @private\n   */\n  updateTimeline(snippet) {\n    this.primerLayer.updateTimeline(snippet);\n    this.graphicsLayer.updateTimeline(snippet);\n  }\n\n  /**\n   * render all 3d stage, should be overwrite by sub-class\n   */\n  render() {\n    console.warn('should be overwrite by sub-class');\n  }\n\n  /**\n   * render primerLayer and graphicsLayer, if you have not use primerLayer, we will direct render graphicsLayer\n   * @param {PerspectiveCamera} camera use which perspective-camera\n   */\n  renderLayer(camera) {\n    this.compositor.render(camera);\n  }\n\n  /**\n   * render loop, trigger one and one tick\n   *\n   * @private\n   */\n  tick() {\n    const This = this;\n    /**\n     * render loop\n     */\n    (function render() {\n      This.update();\n      This.loop = RAF(render);\n    })();\n  }\n\n  /**\n   * update loop with fixed fps, maybe case a performance problem\n   *\n   * @private\n   */\n  tickFixedFPS() {\n    const This = this;\n    this.loop = setInterval(function() {\n      This.update();\n    }, 1000 / this.fps);\n    This.update();\n  }\n\n  /**\n   * get timeline snippet\n   *\n   * @private\n   */\n  timeline() {\n    const snippet = Date.now() - this.pt;\n    this.pt += snippet;\n    this.snippet = snippet * this.timeScale;\n  }\n\n  /**\n   * start update engine\n   * @return {this} this\n   */\n  start() {\n    if (this.ticking) return;\n    this.ticking = true;\n    this.pt = Date.now();\n    if (this.fps === 60) {\n      this.tick();\n    } else {\n      this.tickFixedFPS();\n    }\n    return this;\n  }\n\n  /**\n   * stop update engine\n   * @return {this} this\n   */\n  stop() {\n    CAF(this.loop);\n    clearInterval(this.loop);\n    this.ticking = false;\n    return this;\n  }\n\n  /**\n   * add a primer to primerLayer\n   * @return {this} this\n   */\n  addPrimer() {\n    this.primerLayer.add.apply(this.primerLayer, arguments);\n    return this;\n  }\n\n  /**\n   * remove a primer from primerLayer\n   * @return {this} this\n   */\n  removePrimer() {\n    this.primerLayer.remove.apply(this.primerLayer, arguments);\n    return this;\n  }\n}\n\nexport default Viewer;\n","import { PerspectiveCamera } from 'three';\nimport Viewer from './Viewer';\n\n/**\n * AR-Viewer a UC-AR renderer framework\n * @extends Viewer\n * @param {Object} options config for `AR-Viewer` render view-port\n * @param {canvas} options.canvas `canvas-dom` or canvas `css-selector`\n * @param {Number} [options.width=300] init renderer width.\n * @param {Number} [options.height=150] init renderer height.\n * @param {Number} [options.frameWidth=480] set ar-video-frame width.\n * @param {Number} [options.frameHeight=640] set ar-video-frame height.\n * @param {Number} [options.updateStyle=false] auto update css style when setSize.\n * @param {Boolean} [options.interactive=true] whether interactive with scene.\n * @param {Number} [options.fps=60] render frame rate.\n * @param {Boolean} [options.autoClear=true] whether the renderer should automatically clear its output before rendering a frame.\n * @param {Boolean} [options.alpha=false] whether the canvas contains an alpha (transparency) buffer or not.\n * @param {Boolean} [options.antialias=false] whether to perform antialiasing.\n * @param {String} [options.precision='highp'] Shader precision, Can be `highp`, `mediump` or `lowp`.\n * @param {Boolean} [options.premultipliedAlpha=true] whether the renderer will assume that colors have premultiplied alpha.\n * @param {Boolean} [options.stencil=true] whether the drawing buffer has a stencil buffer of at least 8 bits.\n * @param {Boolean} [options.preserveDrawingBuffer=false] whether to preserve the buffers until manually cleared or overwritten.\n * @param {Boolean} [options.depth=true] whether the drawing buffer has a depth buffer of at least 16 bits.\n * @param {Boolean} [options.logarithmicDepthBuffer] whether to use a logarithmic depth buffer.\n */\nclass ARViewer extends Viewer {\n  constructor(options) {\n    super(options);\n\n    const { frameWidth = 480, frameHeight = 640 } = options;\n\n    /**\n     * video frame width\n     * @member {Number}\n     */\n    this.frameWidth = frameWidth;\n\n    /**\n     * video frame height\n     * @member {Number}\n     */\n    this.frameHeight = frameHeight;\n\n    // init update viewport for ar-video-frame\n    this.updateViewport();\n\n    /**\n     * view-port camera object, a perspective camera\n     *\n     * @member {PerspectiveCamera}\n     */\n    this.camera = new PerspectiveCamera();\n    this.camera.matrixAutoUpdate = false;\n\n    /**\n     * tracking object `<markerName-arGlue>` map\n     *\n     * @member {Object}\n     */\n    this.ar_map = {};\n  }\n\n  /**\n   * render layers\n   */\n  render() {\n    if (this.autoClear) {\n      this.renderer.setRenderTarget(null);\n      this.renderer.clear(this.renderer.autoClearColor, this.renderer.autoClearDepth, this.renderer.autoClearStencil);\n    }\n\n    this.renderLayer(this.camera);\n  }\n\n  /**\n   * add display-object like `ARGlue` or `THREE.Object3D` object\n   *\n   * @param {ARGlue|THREE.Object3D} object display-object which you want show\n   * @return {this} this\n   */\n  add(object) {\n    if (arguments.length > 1) {\n      for (let i = 0; i < arguments.length; i++) {\n        this.add(arguments[i]);\n      }\n      return this;\n    }\n\n    if (object.type === 'ARGlue') {\n      const name = object.name;\n      this.ar_map[name] = object;\n    }\n    this.graphicsLayer.add(object);\n    return this;\n  }\n\n  /**\n   * remove `ARGlue` or `THREE.Object3D` object\n   *\n   * @param {ARGlue|THREE.Object3D} object display-object which you had add before\n   * @return {this} this\n   */\n  remove(object) {\n    if (arguments.length > 1) {\n      for (let i = 0; i < arguments.length; i++) {\n        this.remove(arguments[i]);\n      }\n      return this;\n    }\n\n    if (object.type === 'ARGlue') {\n      const name = object.name;\n      this.ar_map[name] = null;\n    }\n    this.graphicsLayer.remove(object);\n    return this;\n  }\n\n  /**\n   * update tracking-display-object's pose state, poses get from `UC-AR`\n   *\n   * @param {Array} poses poses matrix array\n   */\n  updatePoses(poses) {\n    poses.forEach(({ name, matrix, isDetected }) => {\n      const glue = this.ar_map[name];\n      if (glue) {\n        glue.updatePose(matrix, isDetected);\n      }\n    });\n  }\n\n  /**\n   * update camera internal parama matrix, this matrix get from `UC-AR`\n   *\n   * @param {Array} matrix 4*4 matrix\n   */\n  updateCameraMatrix(matrix) {\n    this.camera.projectionMatrix.fromArray(matrix);\n  }\n\n  /**\n   * adjust viewport, when frameWidth frameHeight or renderer.getSize had change\n   */\n  updateViewport() {\n    const { width, height } = this.renderer.getSize();\n    const rw = width / this.frameWidth;\n    const rh = height / this.frameHeight;\n    const ratio = Math.max(rw, rh);\n    const rtw = this.frameWidth * ratio;\n    const rth = this.frameHeight * ratio;\n\n    let x = 0;\n    let y = 0;\n\n    if (rw < rh) {\n      x = -(rtw - width) / 2;\n    } else if (rw > rh) {\n      y = -(rth - height) / 2;\n    }\n\n    this.renderer.setViewport(x, y, rtw, rth);\n  }\n}\n\nexport default ARViewer;\n","/**\n * get variable type\n * @param {*} val a variable which you want to get the type\n * @return {String} variable-type\n */\nfunction _rt(val) {\n  return Object.prototype.toString.call(val);\n}\n\n/**\n * Utils tool box\n *\n * @namespace Utils\n */\nexport const Utils = {\n  /**\n   * determine whether it is a `Function`\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {*} variable a variable which you want to determine\n   * @return {Boolean} type result\n   */\n  isFunction: (function() {\n    const ks = _rt(function() {});\n    return function(variable) {\n      return _rt(variable) === ks;\n    };\n  })(),\n\n\n  /**\n   * determine whether it is a `undefined`\n   *\n   * @static\n   * @method\n   * @memberof Utils\n   * @param {*} variable a variable which you want to determine\n   * @return {Boolean} type result\n   */\n  isUndefined(variable) {\n    return typeof variable === 'undefined';\n  },\n};\n","import { EventDispatcher, Object3D } from 'three';\nimport { Utils } from '../utils/Utils.js';\n\n/**\n * proxy `addEventListener` function\n *\n * @param {String} type event type, evnet name\n * @param {Function} fn callback\n * @return {this} this\n */\nEventDispatcher.prototype.on = function(type, fn) {\n  if (!Utils.isFunction(fn)) return;\n  if (this instanceof Object3D) this.interactive = true;\n  this.addEventListener(type, fn);\n  return this;\n};\n\n/**\n * proxy `removeEventListener` function\n *\n * @param {String} type event type, evnet name\n * @param {Function} fn callback, which you had bind before\n * @return {this} this\n */\nEventDispatcher.prototype.off = function(type, fn) {\n  this.removeEventListener(type, fn);\n  return this;\n};\n\n/**\n * binding a once event, just emit once time\n *\n * @param {String} type event type, evnet name\n * @param {Function} fn callback\n * @return {this} this\n */\nEventDispatcher.prototype.once = function(type, fn) {\n  if (!Utils.isFunction(fn)) return;\n  const cb = (ev) => {\n    fn(ev);\n    this.off(type, cb);\n  };\n  this.on(type, cb);\n  return this;\n};\n\n/**\n * emit a event\n *\n * @param {String} type event type, evnet name\n * @return {this} this\n */\nEventDispatcher.prototype.emit = function(type, ...argument) {\n  if (this._listeners === undefined || Utils.isUndefined(this._listeners[type])) return;\n  const cbs = this._listeners[type] || [];\n  const cache = cbs.slice(0);\n\n  for (let i = 0; i < cache.length; i++) {\n    cache[i].apply(this, argument);\n  }\n  return this;\n};\n\n","import { Object3D } from 'three';\n\n/**\n * whether displayObject is interactively\n */\nObject3D.prototype.interactive = false;\n\n/**\n * whether displayObject's children is interactively\n */\nObject3D.prototype.interactiveChildren = true;\n\n/**\n * whether displayObject had touchstart\n * @private\n */\nObject3D.prototype.started = false;\n\n/**\n * tracked event cache, like: touchend、mouseout、pointerout which decided by primary-event\n */\nObject.defineProperty(Object3D.prototype, 'trackedPointers', {\n  get() {\n    if (!this._trackedPointers) this._trackedPointers = {};\n    return this._trackedPointers;\n  },\n});\n\n/**\n * dispatch a raycast\n *\n * @param {Raycaster} raycaster Raycaster object, get from THREE.Raycaster\n * @return {Object|Boolean} had pass hit-test\n */\nObject3D.prototype.raycastTest = function(raycaster) {\n  const result = [];\n  this.raycast(raycaster, result);\n\n  if (result.length > 0) {\n    return result[0];\n  }\n\n  return false;\n};\n","import { Vector2 } from 'three';\n\n/**\n * Holds all information related to an Interaction event\n *\n * @class\n */\nclass InteractionData {\n  /**\n   * InteractionData constructor\n   */\n  constructor() {\n    /**\n     * This point stores the global coords of where the touch/mouse event happened\n     *\n     * @member {Vector2}\n     */\n    this.global = new Vector2();\n\n    /**\n     * The target DisplayObject that was interacted with\n     *\n     * @member {Object3D}\n     */\n    this.target = null;\n\n    /**\n     * When passed to an event handler, this will be the original DOM Event that was captured\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/TouchEvent\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent\n     * @member {MouseEvent|TouchEvent|PointerEvent}\n     */\n    this.originalEvent = null;\n\n    /**\n     * Unique identifier for this interaction\n     *\n     * @member {number}\n     */\n    this.identifier = null;\n\n    /**\n     * Indicates whether or not the pointer device that created the event is the primary pointer.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/isPrimary\n     * @type {Boolean}\n     */\n    this.isPrimary = false;\n\n    /**\n     * Indicates which button was pressed on the mouse or pointer device to trigger the event.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/button\n     * @type {number}\n     */\n    this.button = 0;\n\n    /**\n     * Indicates which buttons are pressed on the mouse or pointer device when the event is triggered.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/buttons\n     * @type {number}\n     */\n    this.buttons = 0;\n\n    /**\n     * The width of the pointer's contact along the x-axis, measured in CSS pixels.\n     * radiusX of TouchEvents will be represented by this value.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/width\n     * @type {number}\n     */\n    this.width = 0;\n\n    /**\n     * The height of the pointer's contact along the y-axis, measured in CSS pixels.\n     * radiusY of TouchEvents will be represented by this value.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/height\n     * @type {number}\n     */\n    this.height = 0;\n\n    /**\n     * The angle, in degrees, between the pointer device and the screen.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/tiltX\n     * @type {number}\n     */\n    this.tiltX = 0;\n\n    /**\n     * The angle, in degrees, between the pointer device and the screen.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/tiltY\n     * @type {number}\n     */\n    this.tiltY = 0;\n\n    /**\n     * The type of pointer that triggered the event.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/pointerType\n     * @type {string}\n     */\n    this.pointerType = null;\n\n    /**\n     * Pressure applied by the pointing device during the event. A Touch's force property\n     * will be represented by this value.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/pressure\n     * @type {number}\n     */\n    this.pressure = 0;\n\n    /**\n     * From TouchEvents (not PointerEvents triggered by touches), the rotationAngle of the Touch.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Touch/rotationAngle\n     * @type {number}\n     */\n    this.rotationAngle = 0;\n\n    /**\n     * Twist of a stylus pointer.\n     * @see https://w3c.github.io/pointerevents/#pointerevent-interface\n     * @type {number}\n     */\n    this.twist = 0;\n\n    /**\n     * Barrel pressure on a stylus pointer.\n     * @see https://w3c.github.io/pointerevents/#pointerevent-interface\n     * @type {number}\n     */\n    this.tangentialPressure = 0;\n  }\n\n  /**\n   * The unique identifier of the pointer. It will be the same as `identifier`.\n   * @readonly\n   * @member {number}\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/pointerId\n   */\n  get pointerId() {\n    return this.identifier;\n  }\n\n  /**\n   * Copies properties from normalized event data.\n   *\n   * @param {Touch|MouseEvent|PointerEvent} event The normalized event data\n   * @private\n   */\n  _copyEvent(event) {\n    // isPrimary should only change on touchstart/pointerdown, so we don't want to overwrite\n    // it with \"false\" on later events when our shim for it on touch events might not be\n    // accurate\n    if (event.isPrimary) {\n      this.isPrimary = true;\n    }\n    this.button = event.button;\n    this.buttons = event.buttons;\n    this.width = event.width;\n    this.height = event.height;\n    this.tiltX = event.tiltX;\n    this.tiltY = event.tiltY;\n    this.pointerType = event.pointerType;\n    this.pressure = event.pressure;\n    this.rotationAngle = event.rotationAngle;\n    this.twist = event.twist || 0;\n    this.tangentialPressure = event.tangentialPressure || 0;\n  }\n\n  /**\n   * Resets the data for pooling.\n   *\n   * @private\n   */\n  _reset() {\n    // isPrimary is the only property that we really need to reset - everything else is\n    // guaranteed to be overwritten\n    this.isPrimary = false;\n  }\n}\n\nexport default InteractionData;\n","/**\n * Event class that mimics native DOM events.\n *\n * @class\n */\nclass InteractionEvent {\n  /**\n   * InteractionEvent constructor\n   */\n  constructor() {\n    /**\n     * Whether this event will continue propagating in the tree\n     *\n     * @member {boolean}\n     */\n    this.stopped = false;\n\n    /**\n     * The object which caused this event to be dispatched.\n     *\n     * @member {Object3D}\n     */\n    this.target = null;\n\n    /**\n     * The object whose event listener’s callback is currently being invoked.\n     *\n     * @member {Object3D}\n     */\n    this.currentTarget = null;\n\n    /**\n     * Type of the event\n     *\n     * @member {string}\n     */\n    this.type = null;\n\n    /**\n     * InteractionData related to this event\n     *\n     * @member {InteractionData}\n     */\n    this.data = null;\n\n    /**\n     * ray caster detial from 3d-mesh\n     *\n     * @member {Intersect}\n     */\n    this.intersect = null;\n  }\n\n  /**\n   * Prevents event from reaching any objects other than the current object.\n   *\n   */\n  stopPropagation() {\n    this.stopped = true;\n  }\n\n  /**\n   * Resets the event.\n   *\n   * @private\n   */\n  _reset() {\n    this.stopped = false;\n    this.currentTarget = null;\n    this.target = null;\n    this.intersect = null;\n  }\n}\n\nexport default InteractionEvent;\n","/**\n * DisplayObjects with the `trackedPointers` property use this class to track interactions\n *\n * @class\n * @private\n */\nexport default class InteractionTrackingData {\n  /**\n   * @param {number} pointerId - Unique pointer id of the event\n   */\n  constructor(pointerId) {\n    this._pointerId = pointerId;\n    this._flags = InteractionTrackingData.FLAGS.NONE;\n  }\n\n  /**\n   *\n   * @private\n   * @param {number} flag - The interaction flag to set\n   * @param {boolean} yn - Should the flag be set or unset\n   */\n  _doSet(flag, yn) {\n    if (yn) {\n      this._flags = this._flags | flag;\n    } else {\n      this._flags = this._flags & (~flag);\n    }\n  }\n\n  /**\n   * Unique pointer id of the event\n   *\n   * @readonly\n   * @member {number}\n   */\n  get pointerId() {\n    return this._pointerId;\n  }\n\n  /**\n   * State of the tracking data, expressed as bit flags\n   *\n   * @member {number}\n   */\n  get flags() {\n    return this._flags;\n  }\n\n  /**\n   * Set the flags for the tracking data\n   *\n   * @param {number} flags - Flags to set\n   */\n  set flags(flags) {\n    this._flags = flags;\n  }\n\n  /**\n   * Is the tracked event inactive (not over or down)?\n   *\n   * @member {number}\n   */\n  get none() {\n    return this._flags === this.constructor.FLAGS.NONE;\n  }\n\n  /**\n   * Is the tracked event over the DisplayObject?\n   *\n   * @member {boolean}\n   */\n  get over() {\n    return (this._flags & this.constructor.FLAGS.OVER) !== 0;\n  }\n\n  /**\n   * Set the over flag\n   *\n   * @param {boolean} yn - Is the event over?\n   */\n  set over(yn) {\n    this._doSet(this.constructor.FLAGS.OVER, yn);\n  }\n\n  /**\n   * Did the right mouse button come down in the DisplayObject?\n   *\n   * @member {boolean}\n   */\n  get rightDown() {\n    return (this._flags & this.constructor.FLAGS.RIGHT_DOWN) !== 0;\n  }\n\n  /**\n   * Set the right down flag\n   *\n   * @param {boolean} yn - Is the right mouse button down?\n   */\n  set rightDown(yn) {\n    this._doSet(this.constructor.FLAGS.RIGHT_DOWN, yn);\n  }\n\n  /**\n   * Did the left mouse button come down in the DisplayObject?\n   *\n   * @member {boolean}\n   */\n  get leftDown() {\n    return (this._flags & this.constructor.FLAGS.LEFT_DOWN) !== 0;\n  }\n\n  /**\n   * Set the left down flag\n   *\n   * @param {boolean} yn - Is the left mouse button down?\n   */\n  set leftDown(yn) {\n    this._doSet(this.constructor.FLAGS.LEFT_DOWN, yn);\n  }\n}\n\nInteractionTrackingData.FLAGS = Object.freeze({\n  NONE: 0,\n  OVER: 1 << 0,\n  LEFT_DOWN: 1 << 1,\n  RIGHT_DOWN: 1 << 2,\n});\n","import '../patch/EventDispatcher';\nimport '../patch/Object3D';\n\nimport { EventDispatcher, Raycaster } from 'three';\nimport InteractionData from './InteractionData';\nimport InteractionEvent from './InteractionEvent';\nimport InteractionTrackingData from './InteractionTrackingData';\n\nconst MOUSE_POINTER_ID = 'MOUSE';\n\n// helpers for hitTest() - only used inside hitTest()\nconst hitTestEvent = {\n  target: null,\n  data: {\n    global: null,\n  },\n};\n\n/**\n * The interaction manager deals with mouse, touch and pointer events. Any DisplayObject can be interactive\n * if its interactive parameter is set to true\n * This manager also supports multitouch.\n *\n * reference to [pixi.js](http://www.pixijs.com/) impl\n *\n * @private\n * @class\n * @extends EventDispatcher\n */\nclass InteractionManager extends EventDispatcher {\n  /**\n   * @param {WebGLRenderer} renderer - A reference to the current renderer\n   * @param {Scene} scene - A reference to the current scene\n   * @param {Camera} camera - A reference to the current camera\n   * @param {Object} [options] - The options for the manager.\n   * @param {Boolean} [options.autoPreventDefault=false] - Should the manager automatically prevent default browser actions.\n   * @param {Boolean} [options.autoAttach=true] - Should the manager automatically attach target element.\n   * @param {Number} [options.interactionFrequency=10] - Frequency increases the interaction events will be checked.\n   */\n  constructor(renderer, scene, camera, options) {\n    super();\n\n    options = options || {};\n\n    /**\n     * The renderer this interaction manager works for.\n     *\n     * @member {WebGLRenderer}\n     */\n    this.renderer = renderer;\n\n    /**\n     * The renderer this interaction manager works for.\n     *\n     * @member {Scene}\n     */\n    this.scene = scene;\n\n    /**\n     * The renderer this interaction manager works for.\n     *\n     * @member {Camera}\n     */\n    this.camera = camera;\n\n    /**\n     * Should default browser actions automatically be prevented.\n     * Does not apply to pointer events for backwards compatibility\n     * preventDefault on pointer events stops mouse events from firing\n     * Thus, for every pointer event, there will always be either a mouse of touch event alongside it.\n     *\n     * @member {boolean}\n     * @default false\n     */\n    this.autoPreventDefault = options.autoPreventDefault || false;\n\n    /**\n     * Frequency in milliseconds that the mousemove, moveover & mouseout interaction events will be checked.\n     *\n     * @member {number}\n     * @default 10\n     */\n    this.interactionFrequency = options.interactionFrequency || 10;\n\n    /**\n     * The mouse data\n     *\n     * @member {InteractionData}\n     */\n    this.mouse = new InteractionData();\n    this.mouse.identifier = MOUSE_POINTER_ID;\n\n    // setting the mouse to start off far off screen will mean that mouse over does\n    //  not get called before we even move the mouse.\n    this.mouse.global.set(-999999);\n\n    /**\n     * Actively tracked InteractionData\n     *\n     * @private\n     * @member {Object.<number,InteractionData>}\n     */\n    this.activeInteractionData = {};\n    this.activeInteractionData[MOUSE_POINTER_ID] = this.mouse;\n\n    /**\n     * Pool of unused InteractionData\n     *\n     * @private\n     * @member {InteractionData[]}\n     */\n    this.interactionDataPool = [];\n\n    /**\n     * An event data object to handle all the event tracking/dispatching\n     *\n     * @member {object}\n     */\n    this.eventData = new InteractionEvent();\n\n    /**\n     * The DOM element to bind to.\n     *\n     * @private\n     * @member {HTMLElement}\n     */\n    this.interactionDOMElement = null;\n\n    /**\n     * This property determines if mousemove and touchmove events are fired only when the cursor\n     * is over the object.\n     * Setting to true will make things work more in line with how the DOM verison works.\n     * Setting to false can make things easier for things like dragging\n     * It is currently set to false as this is how three.js used to work.\n     *\n     * @member {boolean}\n     * @default true\n     */\n    this.moveWhenInside = true;\n\n    /**\n     * Have events been attached to the dom element?\n     *\n     * @private\n     * @member {boolean}\n     */\n    this.eventsAdded = false;\n\n    /**\n     * Is the mouse hovering over the renderer?\n     *\n     * @private\n     * @member {boolean}\n     */\n    this.mouseOverRenderer = false;\n\n    /**\n     * Does the device support touch events\n     * https://www.w3.org/TR/touch-events/\n     *\n     * @readonly\n     * @member {boolean}\n     */\n    this.supportsTouchEvents = 'ontouchstart' in window;\n\n    /**\n     * Does the device support pointer events\n     * https://www.w3.org/Submission/pointer-events/\n     *\n     * @readonly\n     * @member {boolean}\n     */\n    this.supportsPointerEvents = !!window.PointerEvent;\n\n    // this will make it so that you don't have to call bind all the time\n\n    /**\n     * @private\n     * @member {Function}\n     */\n    this.onClick = this.onClick.bind(this);\n    this.processClick = this.processClick.bind(this);\n\n    /**\n     * @private\n     * @member {Function}\n     */\n    this.onPointerUp = this.onPointerUp.bind(this);\n    this.processPointerUp = this.processPointerUp.bind(this);\n\n    /**\n     * @private\n     * @member {Function}\n     */\n    this.onPointerCancel = this.onPointerCancel.bind(this);\n    this.processPointerCancel = this.processPointerCancel.bind(this);\n\n    /**\n     * @private\n     * @member {Function}\n     */\n    this.onPointerDown = this.onPointerDown.bind(this);\n    this.processPointerDown = this.processPointerDown.bind(this);\n\n    /**\n     * @private\n     * @member {Function}\n     */\n    this.onPointerMove = this.onPointerMove.bind(this);\n    this.processPointerMove = this.processPointerMove.bind(this);\n\n    /**\n     * @private\n     * @member {Function}\n     */\n    this.onPointerOut = this.onPointerOut.bind(this);\n    this.processPointerOverOut = this.processPointerOverOut.bind(this);\n\n    /**\n     * @private\n     * @member {Function}\n     */\n    this.onPointerOver = this.onPointerOver.bind(this);\n\n    /**\n     * Dictionary of how different cursor modes are handled. Strings are handled as CSS cursor\n     * values, objects are handled as dictionaries of CSS values for interactionDOMElement,\n     * and functions are called instead of changing the CSS.\n     * Default CSS cursor values are provided for 'default' and 'pointer' modes.\n     * @member {Object.<string, (string|Function|Object.<string, string>)>}\n     */\n    this.cursorStyles = {\n      default: 'inherit',\n      pointer: 'pointer',\n    };\n\n    /**\n     * The mode of the cursor that is being used.\n     * The value of this is a key from the cursorStyles dictionary.\n     *\n     * @member {string}\n     */\n    this.currentCursorMode = null;\n\n    /**\n     * Internal cached let.\n     *\n     * @private\n     * @member {string}\n     */\n    this.cursor = null;\n\n    /**\n     * ray caster, for survey intersects from 3d-scene\n     *\n     * @private\n     * @member {Raycaster}\n     */\n    this.raycaster = new Raycaster();\n\n    /**\n     * snippet time\n     *\n     * @private\n     * @member {Number}\n     */\n    this._deltaTime = 0;\n\n    this.setTargetElement(this.renderer.domElement);\n\n    /**\n     * Fired when a pointer device button (usually a mouse left-button) is pressed on the display\n     * object.\n     *\n     * @event InteractionManager#mousedown\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device secondary button (usually a mouse right-button) is pressed\n     * on the display object.\n     *\n     * @event InteractionManager#rightdown\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button (usually a mouse left-button) is released over the display\n     * object.\n     *\n     * @event InteractionManager#mouseup\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device secondary button (usually a mouse right-button) is released\n     * over the display object.\n     *\n     * @event InteractionManager#rightup\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button (usually a mouse left-button) is pressed and released on\n     * the display object.\n     *\n     * @event InteractionManager#click\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device secondary button (usually a mouse right-button) is pressed\n     * and released on the display object.\n     *\n     * @event InteractionManager#rightclick\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button (usually a mouse left-button) is released outside the\n     * display object that initially registered a\n     * [mousedown]{@link InteractionManager#event:mousedown}.\n     *\n     * @event InteractionManager#mouseupoutside\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device secondary button (usually a mouse right-button) is released\n     * outside the display object that initially registered a\n     * [rightdown]{@link InteractionManager#event:rightdown}.\n     *\n     * @event InteractionManager#rightupoutside\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device (usually a mouse) is moved while over the display object\n     *\n     * @event InteractionManager#mousemove\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device (usually a mouse) is moved onto the display object\n     *\n     * @event InteractionManager#mouseover\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device (usually a mouse) is moved off the display object\n     *\n     * @event InteractionManager#mouseout\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button is pressed on the display object.\n     *\n     * @event InteractionManager#pointerdown\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button is released over the display object.\n     *\n     * @event InteractionManager#pointerup\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when the operating system cancels a pointer event\n     *\n     * @event InteractionManager#pointercancel\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button is pressed and released on the display object.\n     *\n     * @event InteractionManager#pointertap\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button is released outside the display object that initially\n     * registered a [pointerdown]{@link InteractionManager#event:pointerdown}.\n     *\n     * @event InteractionManager#pointerupoutside\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device is moved while over the display object\n     *\n     * @event InteractionManager#pointermove\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device is moved onto the display object\n     *\n     * @event InteractionManager#pointerover\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device is moved off the display object\n     *\n     * @event InteractionManager#pointerout\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a touch point is placed on the display object.\n     *\n     * @event InteractionManager#touchstart\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a touch point is removed from the display object.\n     *\n     * @event InteractionManager#touchend\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when the operating system cancels a touch\n     *\n     * @event InteractionManager#touchcancel\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a touch point is placed and removed from the display object.\n     *\n     * @event InteractionManager#tap\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a touch point is removed outside of the display object that initially\n     * registered a [touchstart]{@link InteractionManager#event:touchstart}.\n     *\n     * @event InteractionManager#touchendoutside\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a touch point is moved along the display object.\n     *\n     * @event InteractionManager#touchmove\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button (usually a mouse left-button) is pressed on the display.\n     * object. DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#mousedown\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device secondary button (usually a mouse right-button) is pressed\n     * on the display object. DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#rightdown\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button (usually a mouse left-button) is released over the display\n     * object. DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#mouseup\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device secondary button (usually a mouse right-button) is released\n     * over the display object. DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#rightup\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button (usually a mouse left-button) is pressed and released on\n     * the display object. DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#click\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device secondary button (usually a mouse right-button) is pressed\n     * and released on the display object. DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#rightclick\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button (usually a mouse left-button) is released outside the\n     * display object that initially registered a\n     * [mousedown]{@link Object3D#event:mousedown}.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#mouseupoutside\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device secondary button (usually a mouse right-button) is released\n     * outside the display object that initially registered a\n     * [rightdown]{@link Object3D#event:rightdown}.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#rightupoutside\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device (usually a mouse) is moved while over the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#mousemove\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device (usually a mouse) is moved onto the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#mouseover\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device (usually a mouse) is moved off the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#mouseout\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button is pressed on the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#pointerdown\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button is released over the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#pointerup\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when the operating system cancels a pointer event.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#pointercancel\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button is pressed and released on the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#pointertap\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device button is released outside the display object that initially\n     * registered a [pointerdown]{@link Object3D#event:pointerdown}.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#pointerupoutside\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device is moved while over the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#pointermove\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device is moved onto the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#pointerover\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a pointer device is moved off the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#pointerout\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a touch point is placed on the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#touchstart\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a touch point is removed from the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#touchend\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when the operating system cancels a touch.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#touchcancel\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a touch point is placed and removed from the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#tap\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a touch point is removed outside of the display object that initially\n     * registered a [touchstart]{@link Object3D#event:touchstart}.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#touchendoutside\n     * @param {InteractionEvent} event - Interaction event\n     */\n\n    /**\n     * Fired when a touch point is moved along the display object.\n     * DisplayObject's `interactive` property must be set to `true` to fire event.\n     *\n     * @event Object3D#touchmove\n     * @param {InteractionEvent} event - Interaction event\n     */\n  }\n\n  /**\n   * Hit tests a point against the display tree, returning the first interactive object that is hit.\n   *\n   * @param {Point} globalPoint - A point to hit test with, in global space.\n   * @param {Object3D} [root] - The root display object to start from. If omitted, defaults\n   * to the last rendered root of the associated renderer.\n   * @return {Object3D} The hit display object, if any.\n   */\n  hitTest(globalPoint, root) {\n    // clear the target for our hit test\n    hitTestEvent.target = null;\n    // assign the global point\n    hitTestEvent.data.global = globalPoint;\n    // ensure safety of the root\n    if (!root) {\n      root = this.scene;\n    }\n    // run the hit test\n    this.processInteractive(hitTestEvent, root, null, true);\n    // return our found object - it'll be null if we didn't hit anything\n\n    return hitTestEvent.target;\n  }\n\n  /**\n   * Sets the DOM element which will receive mouse/touch events. This is useful for when you have\n   * other DOM elements on top of the renderers Canvas element. With this you'll be bale to deletegate\n   * another DOM element to receive those events.\n   *\n   * @param {HTMLCanvasElement} element - the DOM element which will receive mouse and touch events.\n   */\n  setTargetElement(element) {\n    this.removeEvents();\n\n    this.interactionDOMElement = element;\n\n    this.addEvents();\n  }\n\n  /**\n   * Registers all the DOM events\n   *\n   * @private\n   */\n  addEvents() {\n    if (!this.interactionDOMElement || this.eventsAdded) {\n      return;\n    }\n\n    this.emit('addevents');\n\n    this.interactionDOMElement.addEventListener('click', this.onClick, true);\n\n    if (window.navigator.msPointerEnabled) {\n      this.interactionDOMElement.style['-ms-content-zooming'] = 'none';\n      this.interactionDOMElement.style['-ms-touch-action'] = 'none';\n    } else if (this.supportsPointerEvents) {\n      this.interactionDOMElement.style['touch-action'] = 'none';\n    }\n\n    /**\n     * These events are added first, so that if pointer events are normalised, they are fired\n     * in the same order as non-normalised events. ie. pointer event 1st, mouse / touch 2nd\n     */\n    if (this.supportsPointerEvents) {\n      window.document.addEventListener('pointermove', this.onPointerMove, true);\n      this.interactionDOMElement.addEventListener('pointerdown', this.onPointerDown, true);\n      // pointerout is fired in addition to pointerup (for touch events) and pointercancel\n      // we already handle those, so for the purposes of what we do in onPointerOut, we only\n      // care about the pointerleave event\n      this.interactionDOMElement.addEventListener('pointerleave', this.onPointerOut, true);\n      this.interactionDOMElement.addEventListener('pointerover', this.onPointerOver, true);\n      window.addEventListener('pointercancel', this.onPointerCancel, true);\n      window.addEventListener('pointerup', this.onPointerUp, true);\n    } else {\n      window.document.addEventListener('mousemove', this.onPointerMove, true);\n      this.interactionDOMElement.addEventListener('mousedown', this.onPointerDown, true);\n      this.interactionDOMElement.addEventListener('mouseout', this.onPointerOut, true);\n      this.interactionDOMElement.addEventListener('mouseover', this.onPointerOver, true);\n      window.addEventListener('mouseup', this.onPointerUp, true);\n    }\n\n    // always look directly for touch events so that we can provide original data\n    // In a future version we should change this to being just a fallback and rely solely on\n    // PointerEvents whenever available\n    if (this.supportsTouchEvents) {\n      this.interactionDOMElement.addEventListener('touchstart', this.onPointerDown, true);\n      this.interactionDOMElement.addEventListener('touchcancel', this.onPointerCancel, true);\n      this.interactionDOMElement.addEventListener('touchend', this.onPointerUp, true);\n      this.interactionDOMElement.addEventListener('touchmove', this.onPointerMove, true);\n    }\n\n    this.eventsAdded = true;\n  }\n\n  /**\n   * Removes all the DOM events that were previously registered\n   *\n   * @private\n   */\n  removeEvents() {\n    if (!this.interactionDOMElement) {\n      return;\n    }\n\n    this.emit('removeevents');\n\n    this.interactionDOMElement.removeEventListener('click', this.onClick, true);\n\n    if (window.navigator.msPointerEnabled) {\n      this.interactionDOMElement.style['-ms-content-zooming'] = '';\n      this.interactionDOMElement.style['-ms-touch-action'] = '';\n    } else if (this.supportsPointerEvents) {\n      this.interactionDOMElement.style['touch-action'] = '';\n    }\n\n    if (this.supportsPointerEvents) {\n      window.document.removeEventListener('pointermove', this.onPointerMove, true);\n      this.interactionDOMElement.removeEventListener('pointerdown', this.onPointerDown, true);\n      this.interactionDOMElement.removeEventListener('pointerleave', this.onPointerOut, true);\n      this.interactionDOMElement.removeEventListener('pointerover', this.onPointerOver, true);\n      window.removeEventListener('pointercancel', this.onPointerCancel, true);\n      window.removeEventListener('pointerup', this.onPointerUp, true);\n    } else {\n      window.document.removeEventListener('mousemove', this.onPointerMove, true);\n      this.interactionDOMElement.removeEventListener('mousedown', this.onPointerDown, true);\n      this.interactionDOMElement.removeEventListener('mouseout', this.onPointerOut, true);\n      this.interactionDOMElement.removeEventListener('mouseover', this.onPointerOver, true);\n      window.removeEventListener('mouseup', this.onPointerUp, true);\n    }\n\n    if (this.supportsTouchEvents) {\n      this.interactionDOMElement.removeEventListener('touchstart', this.onPointerDown, true);\n      this.interactionDOMElement.removeEventListener('touchcancel', this.onPointerCancel, true);\n      this.interactionDOMElement.removeEventListener('touchend', this.onPointerUp, true);\n      this.interactionDOMElement.removeEventListener('touchmove', this.onPointerMove, true);\n    }\n\n    this.interactionDOMElement = null;\n\n    this.eventsAdded = false;\n  }\n\n  /**\n   * Updates the state of interactive objects.\n   * Invoked by a throttled ticker.\n   *\n   * @param {number} deltaTime - time delta since last tick\n   */\n  update({ snippet }) {\n    this._deltaTime += snippet;\n\n    if (this._deltaTime < this.interactionFrequency) {\n      return;\n    }\n\n    this._deltaTime = 0;\n\n    if (!this.interactionDOMElement) {\n      return;\n    }\n\n    // if the user move the mouse this check has already been done using the mouse move!\n    if (this.didMove) {\n      this.didMove = false;\n\n      return;\n    }\n\n    this.cursor = null;\n\n    // Resets the flag as set by a stopPropagation call. This flag is usually reset by a user interaction of any kind,\n    // but there was a scenario of a display object moving under a static mouse cursor.\n    // In this case, mouseover and mouseevents would not pass the flag test in triggerEvent function\n    for (const k in this.activeInteractionData) {\n      // eslint-disable-next-line no-prototype-builtins\n      if (this.activeInteractionData.hasOwnProperty(k)) {\n        const interactionData = this.activeInteractionData[k];\n\n        if (interactionData.originalEvent && interactionData.pointerType !== 'touch') {\n          const interactionEvent = this.configureInteractionEventForDOMEvent(\n            this.eventData,\n            interactionData.originalEvent,\n            interactionData\n          );\n\n          this.processInteractive(\n            interactionEvent,\n            this.scene,\n            this.processPointerOverOut,\n            true\n          );\n        }\n      }\n    }\n\n    this.setCursorMode(this.cursor);\n\n    // TODO\n  }\n\n  /**\n   * Sets the current cursor mode, handling any callbacks or CSS style changes.\n   *\n   * @param {string} mode - cursor mode, a key from the cursorStyles dictionary\n   */\n  setCursorMode(mode) {\n    mode = mode || 'default';\n    // if the mode didn't actually change, bail early\n    if (this.currentCursorMode === mode) {\n      return;\n    }\n    this.currentCursorMode = mode;\n    const style = this.cursorStyles[mode];\n\n    // only do things if there is a cursor style for it\n    if (style) {\n      switch (typeof style) {\n        case 'string':\n          // string styles are handled as cursor CSS\n          this.interactionDOMElement.style.cursor = style;\n          break;\n        case 'function':\n          // functions are just called, and passed the cursor mode\n          style(mode);\n          break;\n        case 'object':\n          // if it is an object, assume that it is a dictionary of CSS styles,\n          // apply it to the interactionDOMElement\n          Object.assign(this.interactionDOMElement.style, style);\n          break;\n        default:\n          break;\n      }\n    } else if (typeof mode === 'string' && !Object.prototype.hasOwnProperty.call(this.cursorStyles, mode)) {\n      // if it mode is a string (not a Symbol) and cursorStyles doesn't have any entry\n      // for the mode, then assume that the dev wants it to be CSS for the cursor.\n      this.interactionDOMElement.style.cursor = mode;\n    }\n  }\n\n  /**\n   * Dispatches an event on the display object that was interacted with\n   *\n   * @param {Object3D} displayObject - the display object in question\n   * @param {string} eventString - the name of the event (e.g, mousedown)\n   * @param {object} eventData - the event data object\n   * @private\n   */\n  triggerEvent(displayObject, eventString, eventData) {\n    if (!eventData.stopped) {\n      eventData.currentTarget = displayObject;\n      eventData.type = eventString;\n\n      displayObject.emit(eventString, eventData);\n\n      if (displayObject[eventString]) {\n        displayObject[eventString](eventData);\n      }\n    }\n  }\n\n  /**\n   * Maps x and y coords from a DOM object and maps them correctly to the three.js view. The\n   * resulting value is stored in the point. This takes into account the fact that the DOM\n   * element could be scaled and positioned anywhere on the screen.\n   *\n   * @param  {Vector2} point - the point that the result will be stored in\n   * @param  {number} x - the x coord of the position to map\n   * @param  {number} y - the y coord of the position to map\n   */\n  mapPositionToPoint(point, x, y) {\n    let rect;\n\n    // IE 11 fix\n    if (!this.interactionDOMElement.parentElement) {\n      rect = {\n        x: 0,\n        y: 0,\n        left: 0,\n        top: 0,\n        width: 0,\n        height: 0,\n      };\n    } else {\n      rect = this.interactionDOMElement.getBoundingClientRect();\n    }\n\n    point.x = ((x - rect.left) / rect.width) * 2 - 1;\n    point.y = -((y - rect.top) / rect.height) * 2 + 1;\n  }\n\n  /**\n   * This function is provides a neat way of crawling through the scene graph and running a\n   * specified function on all interactive objects it finds. It will also take care of hit\n   * testing the interactive objects and passes the hit across in the function.\n   *\n   * @private\n   * @param {InteractionEvent} interactionEvent - event containing the point that\n   *  is tested for collision\n   * @param {Object3D} displayObject - the displayObject\n   *  that will be hit test (recursively crawls its children)\n   * @param {Function} [func] - the function that will be called on each interactive object. The\n   *  interactionEvent, displayObject and hit will be passed to the function\n   * @param {boolean} [hitTest] - this indicates if the objects inside should be hit test against the point\n   * @param {boolean} [interactive] - Whether the displayObject is interactive\n   * @return {boolean} returns true if the displayObject hit the point\n   */\n  processInteractive(interactionEvent, displayObject, func, hitTest, interactive) {\n    if (!displayObject || !displayObject.visible) {\n      return false;\n    }\n\n    // Took a little while to rework this function correctly! But now it is done and nice and optimised. ^_^\n    //\n    // This function will now loop through all objects and then only hit test the objects it HAS\n    // to, not all of them. MUCH faster..\n    // An object will be hit test if the following is true:\n    //\n    // 1: It is interactive.\n    // 2: It belongs to a parent that is interactive AND one of the parents children have not already been hit.\n    //\n    // As another little optimisation once an interactive object has been hit we can carry on\n    // through the scenegraph, but we know that there will be no more hits! So we can avoid extra hit tests\n    // A final optimisation is that an object is not hit test directly if a child has already been hit.\n\n    interactive = displayObject.interactive || interactive;\n\n    let hit = false;\n    let interactiveParent = interactive;\n\n    if (displayObject.interactiveChildren && displayObject.children) {\n      const children = displayObject.children;\n\n      for (let i = children.length - 1; i >= 0; i--) {\n        const child = children[i];\n\n        // time to get recursive.. if this function will return if something is hit..\n        const childHit = this.processInteractive(interactionEvent, child, func, hitTest, interactiveParent);\n\n        if (childHit) {\n          // its a good idea to check if a child has lost its parent.\n          // this means it has been removed whilst looping so its best\n          if (!child.parent) {\n            continue;\n          }\n\n          // we no longer need to hit test any more objects in this container as we we\n          // now know the parent has been hit\n          interactiveParent = false;\n\n          // If the child is interactive , that means that the object hit was actually\n          // interactive and not just the child of an interactive object.\n          // This means we no longer need to hit test anything else. We still need to run\n          // through all objects, but we don't need to perform any hit tests.\n\n          if (childHit) {\n            if (interactionEvent.target) {\n              hitTest = false;\n            }\n            hit = true;\n          }\n        }\n      }\n    }\n\n    // no point running this if the item is not interactive or does not have an interactive parent.\n    if (interactive) {\n      // if we are hit testing (as in we have no hit any objects yet)\n      // We also don't need to worry about hit testing if once of the displayObjects children\n      // has already been hit - but only if it was interactive, otherwise we need to keep\n      // looking for an interactive child, just in case we hit one\n      if (hitTest && !interactionEvent.target) {\n        const intersect = displayObject.raycastTest(this.raycaster);\n        if (intersect) {\n          interactionEvent.intersect = intersect;\n          hit = true;\n        }\n      }\n\n      if (displayObject.interactive) {\n        if (hit && !interactionEvent.target) {\n          interactionEvent.data.target = interactionEvent.target = displayObject;\n        }\n\n        if (func) {\n          func(interactionEvent, displayObject, !!hit);\n        }\n      }\n    }\n\n    return hit;\n  }\n\n\n  /**\n   * Is called when the click is pressed down on the renderer element\n   *\n   * @private\n   * @param {MouseEvent} originalEvent - The DOM event of a click being pressed down\n   */\n  onClick(originalEvent) {\n    if (originalEvent.type !== 'click') return;\n\n    const events = this.normalizeToPointerData(originalEvent);\n\n    if (this.autoPreventDefault && events[0].isNormalized) {\n      originalEvent.preventDefault();\n    }\n\n    const interactionData = this.getInteractionDataForPointerId(events[0]);\n\n    const interactionEvent = this.configureInteractionEventForDOMEvent(this.eventData, event, interactionData);\n\n    interactionEvent.data.originalEvent = originalEvent;\n\n    this.processInteractive(interactionEvent, this.scene, this.processClick, true);\n\n    this.emit('click', interactionEvent);\n  }\n\n  /**\n   * Processes the result of the click check and dispatches the event if need be\n   *\n   * @private\n   * @param {InteractionEvent} interactionEvent - The interaction event wrapping the DOM event\n   * @param {Object3D} displayObject - The display object that was tested\n   * @param {boolean} hit - the result of the hit test on the display object\n   */\n  processClick(interactionEvent, displayObject, hit) {\n    if (hit) {\n      this.triggerEvent(displayObject, 'click', interactionEvent);\n    }\n  }\n\n  /**\n   * Is called when the pointer button is pressed down on the renderer element\n   *\n   * @private\n   * @param {PointerEvent} originalEvent - The DOM event of a pointer button being pressed down\n   */\n  onPointerDown(originalEvent) {\n    // if we support touch events, then only use those for touch events, not pointer events\n    if (this.supportsTouchEvents && originalEvent.pointerType === 'touch') return;\n\n    const events = this.normalizeToPointerData(originalEvent);\n\n    /**\n     * No need to prevent default on natural pointer events, as there are no side effects\n     * Normalized events, however, may have the double mousedown/touchstart issue on the native android browser,\n     * so still need to be prevented.\n     */\n\n    // Guaranteed that there will be at least one event in events, and all events must have the same pointer type\n\n    if (this.autoPreventDefault && events[0].isNormalized) {\n      originalEvent.preventDefault();\n    }\n\n    const eventLen = events.length;\n\n    for (let i = 0; i < eventLen; i++) {\n      const event = events[i];\n\n      const interactionData = this.getInteractionDataForPointerId(event);\n\n      const interactionEvent = this.configureInteractionEventForDOMEvent(this.eventData, event, interactionData);\n\n      interactionEvent.data.originalEvent = originalEvent;\n\n      this.processInteractive(interactionEvent, this.scene, this.processPointerDown, true);\n\n      this.emit('pointerdown', interactionEvent);\n      if (event.pointerType === 'touch') {\n        this.emit('touchstart', interactionEvent);\n      } else if (event.pointerType === 'mouse' || event.pointerType === 'pen') {\n        const isRightButton = event.button === 2;\n\n        this.emit(isRightButton ? 'rightdown' : 'mousedown', this.eventData);\n      }\n    }\n  }\n\n  /**\n   * Processes the result of the pointer down check and dispatches the event if need be\n   *\n   * @private\n   * @param {InteractionEvent} interactionEvent - The interaction event wrapping the DOM event\n   * @param {Object3D} displayObject - The display object that was tested\n   * @param {boolean} hit - the result of the hit test on the display object\n   */\n  processPointerDown(interactionEvent, displayObject, hit) {\n    const data = interactionEvent.data;\n    const id = interactionEvent.data.identifier;\n\n    if (hit) {\n      if (!displayObject.trackedPointers[id]) {\n        displayObject.trackedPointers[id] = new InteractionTrackingData(id);\n      }\n      this.triggerEvent(displayObject, 'pointerdown', interactionEvent);\n\n      if (data.pointerType === 'touch') {\n        displayObject.started = true;\n        this.triggerEvent(displayObject, 'touchstart', interactionEvent);\n      } else if (data.pointerType === 'mouse' || data.pointerType === 'pen') {\n        const isRightButton = data.button === 2;\n\n        if (isRightButton) {\n          displayObject.trackedPointers[id].rightDown = true;\n        } else {\n          displayObject.trackedPointers[id].leftDown = true;\n        }\n\n        this.triggerEvent(displayObject, isRightButton ? 'rightdown' : 'mousedown', interactionEvent);\n      }\n    }\n  }\n\n  /**\n   * Is called when the pointer button is released on the renderer element\n   *\n   * @private\n   * @param {PointerEvent} originalEvent - The DOM event of a pointer button being released\n   * @param {boolean} cancelled - true if the pointer is cancelled\n   * @param {Function} func - Function passed to {@link processInteractive}\n   */\n  onPointerComplete(originalEvent, cancelled, func) {\n    const events = this.normalizeToPointerData(originalEvent);\n\n    const eventLen = events.length;\n\n    // if the event wasn't targeting our canvas, then consider it to be pointerupoutside\n    // in all cases (unless it was a pointercancel)\n    const eventAppend = originalEvent.target !== this.interactionDOMElement ? 'outside' : '';\n\n    for (let i = 0; i < eventLen; i++) {\n      const event = events[i];\n\n      const interactionData = this.getInteractionDataForPointerId(event);\n\n      const interactionEvent = this.configureInteractionEventForDOMEvent(this.eventData, event, interactionData);\n\n      interactionEvent.data.originalEvent = originalEvent;\n\n      // perform hit testing for events targeting our canvas or cancel events\n      this.processInteractive(interactionEvent, this.scene, func, cancelled || !eventAppend);\n\n      this.emit(cancelled ? 'pointercancel' : `pointerup${eventAppend}`, interactionEvent);\n\n      if (event.pointerType === 'mouse' || event.pointerType === 'pen') {\n        const isRightButton = event.button === 2;\n\n        this.emit(isRightButton ? `rightup${eventAppend}` : `mouseup${eventAppend}`, interactionEvent);\n      } else if (event.pointerType === 'touch') {\n        this.emit(cancelled ? 'touchcancel' : `touchend${eventAppend}`, interactionEvent);\n        this.releaseInteractionDataForPointerId(event.pointerId, interactionData);\n      }\n    }\n  }\n\n  /**\n   * Is called when the pointer button is cancelled\n   *\n   * @private\n   * @param {PointerEvent} event - The DOM event of a pointer button being released\n   */\n  onPointerCancel(event) {\n    // if we support touch events, then only use those for touch events, not pointer events\n    if (this.supportsTouchEvents && event.pointerType === 'touch') return;\n\n    this.onPointerComplete(event, true, this.processPointerCancel);\n  }\n\n  /**\n   * Processes the result of the pointer cancel check and dispatches the event if need be\n   *\n   * @private\n   * @param {InteractionEvent} interactionEvent - The interaction event wrapping the DOM event\n   * @param {Object3D} displayObject - The display object that was tested\n   */\n  processPointerCancel(interactionEvent, displayObject) {\n    const data = interactionEvent.data;\n\n    const id = interactionEvent.data.identifier;\n\n    if (displayObject.trackedPointers[id] !== undefined) {\n      delete displayObject.trackedPointers[id];\n      this.triggerEvent(displayObject, 'pointercancel', interactionEvent);\n\n      if (data.pointerType === 'touch') {\n        this.triggerEvent(displayObject, 'touchcancel', interactionEvent);\n      }\n    }\n  }\n\n  /**\n   * Is called when the pointer button is released on the renderer element\n   *\n   * @private\n   * @param {PointerEvent} event - The DOM event of a pointer button being released\n   */\n  onPointerUp(event) {\n    // if we support touch events, then only use those for touch events, not pointer events\n    if (this.supportsTouchEvents && event.pointerType === 'touch') return;\n\n    this.onPointerComplete(event, false, this.processPointerUp);\n  }\n\n  /**\n   * Processes the result of the pointer up check and dispatches the event if need be\n   *\n   * @private\n   * @param {InteractionEvent} interactionEvent - The interaction event wrapping the DOM event\n   * @param {Object3D} displayObject - The display object that was tested\n   * @param {boolean} hit - the result of the hit test on the display object\n   */\n  processPointerUp(interactionEvent, displayObject, hit) {\n    const data = interactionEvent.data;\n\n    const id = interactionEvent.data.identifier;\n\n    const trackingData = displayObject.trackedPointers[id];\n\n    const isTouch = data.pointerType === 'touch';\n\n    const isMouse = (data.pointerType === 'mouse' || data.pointerType === 'pen');\n\n    // Mouse only\n    if (isMouse) {\n      const isRightButton = data.button === 2;\n\n      const flags = InteractionTrackingData.FLAGS;\n\n      const test = isRightButton ? flags.RIGHT_DOWN : flags.LEFT_DOWN;\n\n      const isDown = trackingData !== undefined && (trackingData.flags & test);\n\n      if (hit) {\n        this.triggerEvent(displayObject, isRightButton ? 'rightup' : 'mouseup', interactionEvent);\n\n        if (isDown) {\n          this.triggerEvent(displayObject, isRightButton ? 'rightclick' : 'leftclick', interactionEvent);\n        }\n      } else if (isDown) {\n        this.triggerEvent(displayObject, isRightButton ? 'rightupoutside' : 'mouseupoutside', interactionEvent);\n      }\n      // update the down state of the tracking data\n      if (trackingData) {\n        if (isRightButton) {\n          trackingData.rightDown = false;\n        } else {\n          trackingData.leftDown = false;\n        }\n      }\n    }\n\n    // Pointers and Touches, and Mouse\n    if (isTouch && displayObject.started) {\n      displayObject.started = false;\n      this.triggerEvent(displayObject, 'touchend', interactionEvent);\n    }\n    if (hit) {\n      this.triggerEvent(displayObject, 'pointerup', interactionEvent);\n\n      if (trackingData) {\n        this.triggerEvent(displayObject, 'pointertap', interactionEvent);\n        if (isTouch) {\n          this.triggerEvent(displayObject, 'tap', interactionEvent);\n          // touches are no longer over (if they ever were) when we get the touchend\n          // so we should ensure that we don't keep pretending that they are\n          trackingData.over = false;\n        }\n      }\n    } else if (trackingData) {\n      this.triggerEvent(displayObject, 'pointerupoutside', interactionEvent);\n      if (isTouch) this.triggerEvent(displayObject, 'touchendoutside', interactionEvent);\n    }\n    // Only remove the tracking data if there is no over/down state still associated with it\n    if (trackingData && trackingData.none) {\n      delete displayObject.trackedPointers[id];\n    }\n  }\n\n  /**\n   * Is called when the pointer moves across the renderer element\n   *\n   * @private\n   * @param {PointerEvent} originalEvent - The DOM event of a pointer moving\n   */\n  onPointerMove(originalEvent) {\n    // if we support touch events, then only use those for touch events, not pointer events\n    if (this.supportsTouchEvents && originalEvent.pointerType === 'touch') return;\n\n    const events = this.normalizeToPointerData(originalEvent);\n\n    if (events[0].pointerType === 'mouse') {\n      this.didMove = true;\n\n      this.cursor = null;\n    }\n\n    const eventLen = events.length;\n\n    for (let i = 0; i < eventLen; i++) {\n      const event = events[i];\n\n      const interactionData = this.getInteractionDataForPointerId(event);\n\n      const interactionEvent = this.configureInteractionEventForDOMEvent(this.eventData, event, interactionData);\n\n      interactionEvent.data.originalEvent = originalEvent;\n\n      const interactive = event.pointerType === 'touch' ? this.moveWhenInside : true;\n\n      this.processInteractive(\n        interactionEvent,\n        this.scene,\n        this.processPointerMove,\n        interactive\n      );\n      this.emit('pointermove', interactionEvent);\n      if (event.pointerType === 'touch') this.emit('touchmove', interactionEvent);\n      if (event.pointerType === 'mouse' || event.pointerType === 'pen') this.emit('mousemove', interactionEvent);\n    }\n\n    if (events[0].pointerType === 'mouse') {\n      this.setCursorMode(this.cursor);\n\n      // TODO BUG for parents interactive object (border order issue)\n    }\n  }\n\n  /**\n   * Processes the result of the pointer move check and dispatches the event if need be\n   *\n   * @private\n   * @param {InteractionEvent} interactionEvent - The interaction event wrapping the DOM event\n   * @param {Object3D} displayObject - The display object that was tested\n   * @param {boolean} hit - the result of the hit test on the display object\n   */\n  processPointerMove(interactionEvent, displayObject, hit) {\n    const data = interactionEvent.data;\n\n    const isTouch = data.pointerType === 'touch';\n\n    const isMouse = (data.pointerType === 'mouse' || data.pointerType === 'pen');\n\n    if (isMouse) {\n      this.processPointerOverOut(interactionEvent, displayObject, hit);\n    }\n\n    if (isTouch && displayObject.started) this.triggerEvent(displayObject, 'touchmove', interactionEvent);\n    if (!this.moveWhenInside || hit) {\n      this.triggerEvent(displayObject, 'pointermove', interactionEvent);\n      if (isMouse) this.triggerEvent(displayObject, 'mousemove', interactionEvent);\n    }\n  }\n\n  /**\n   * Is called when the pointer is moved out of the renderer element\n   *\n   * @private\n   * @param {PointerEvent} originalEvent - The DOM event of a pointer being moved out\n   */\n  onPointerOut(originalEvent) {\n    // if we support touch events, then only use those for touch events, not pointer events\n    if (this.supportsTouchEvents && originalEvent.pointerType === 'touch') return;\n\n    const events = this.normalizeToPointerData(originalEvent);\n\n    // Only mouse and pointer can call onPointerOut, so events will always be length 1\n    const event = events[0];\n\n    if (event.pointerType === 'mouse') {\n      this.mouseOverRenderer = false;\n      this.setCursorMode(null);\n    }\n\n    const interactionData = this.getInteractionDataForPointerId(event);\n\n    const interactionEvent = this.configureInteractionEventForDOMEvent(this.eventData, event, interactionData);\n\n    interactionEvent.data.originalEvent = event;\n\n    this.processInteractive(interactionEvent, this.scene, this.processPointerOverOut, false);\n\n    this.emit('pointerout', interactionEvent);\n    if (event.pointerType === 'mouse' || event.pointerType === 'pen') {\n      this.emit('mouseout', interactionEvent);\n    } else {\n      // we can get touchleave events after touchend, so we want to make sure we don't\n      // introduce memory leaks\n      this.releaseInteractionDataForPointerId(interactionData.identifier);\n    }\n  }\n\n  /**\n   * Processes the result of the pointer over/out check and dispatches the event if need be\n   *\n   * @private\n   * @param {InteractionEvent} interactionEvent - The interaction event wrapping the DOM event\n   * @param {Object3D} displayObject - The display object that was tested\n   * @param {boolean} hit - the result of the hit test on the display object\n   */\n  processPointerOverOut(interactionEvent, displayObject, hit) {\n    const data = interactionEvent.data;\n\n    const id = interactionEvent.data.identifier;\n\n    const isMouse = (data.pointerType === 'mouse' || data.pointerType === 'pen');\n\n    let trackingData = displayObject.trackedPointers[id];\n\n    // if we just moused over the display object, then we need to track that state\n    if (hit && !trackingData) {\n      trackingData = displayObject.trackedPointers[id] = new InteractionTrackingData(id);\n    }\n\n    if (trackingData === undefined) return;\n\n    if (hit && this.mouseOverRenderer) {\n      if (!trackingData.over) {\n        trackingData.over = true;\n        this.triggerEvent(displayObject, 'pointerover', interactionEvent);\n        if (isMouse) {\n          this.triggerEvent(displayObject, 'mouseover', interactionEvent);\n        }\n      }\n\n      // only change the cursor if it has not already been changed (by something deeper in the\n      // display tree)\n      if (isMouse && this.cursor === null) {\n        this.cursor = displayObject.cursor;\n      }\n    } else if (trackingData.over) {\n      trackingData.over = false;\n      this.triggerEvent(displayObject, 'pointerout', this.eventData);\n      if (isMouse) {\n        this.triggerEvent(displayObject, 'mouseout', interactionEvent);\n      }\n      // if there is no mouse down information for the pointer, then it is safe to delete\n      if (trackingData.none) {\n        delete displayObject.trackedPointers[id];\n      }\n    }\n  }\n\n  /**\n   * Is called when the pointer is moved into the renderer element\n   *\n   * @private\n   * @param {PointerEvent} originalEvent - The DOM event of a pointer button being moved into the renderer view\n   */\n  onPointerOver(originalEvent) {\n    const events = this.normalizeToPointerData(originalEvent);\n\n    // Only mouse and pointer can call onPointerOver, so events will always be length 1\n    const event = events[0];\n\n    const interactionData = this.getInteractionDataForPointerId(event);\n\n    const interactionEvent = this.configureInteractionEventForDOMEvent(this.eventData, event, interactionData);\n\n    interactionEvent.data.originalEvent = event;\n\n    if (event.pointerType === 'mouse') {\n      this.mouseOverRenderer = true;\n    }\n\n    this.emit('pointerover', interactionEvent);\n    if (event.pointerType === 'mouse' || event.pointerType === 'pen') {\n      this.emit('mouseover', interactionEvent);\n    }\n  }\n\n  /**\n   * Get InteractionData for a given pointerId. Store that data as well\n   *\n   * @private\n   * @param {PointerEvent} event - Normalized pointer event, output from normalizeToPointerData\n   * @return {InteractionData} - Interaction data for the given pointer identifier\n   */\n  getInteractionDataForPointerId(event) {\n    const pointerId = event.pointerId;\n\n    let interactionData;\n\n    if (pointerId === MOUSE_POINTER_ID || event.pointerType === 'mouse') {\n      interactionData = this.mouse;\n    } else if (this.activeInteractionData[pointerId]) {\n      interactionData = this.activeInteractionData[pointerId];\n    } else {\n      interactionData = this.interactionDataPool.pop() || new InteractionData();\n      interactionData.identifier = pointerId;\n      this.activeInteractionData[pointerId] = interactionData;\n    }\n    // copy properties from the event, so that we can make sure that touch/pointer specific\n    // data is available\n    interactionData._copyEvent(event);\n\n    return interactionData;\n  }\n\n  /**\n   * Return unused InteractionData to the pool, for a given pointerId\n   *\n   * @private\n   * @param {number} pointerId - Identifier from a pointer event\n   */\n  releaseInteractionDataForPointerId(pointerId) {\n    const interactionData = this.activeInteractionData[pointerId];\n\n    if (interactionData) {\n      delete this.activeInteractionData[pointerId];\n      interactionData._reset();\n      this.interactionDataPool.push(interactionData);\n    }\n  }\n\n  /**\n   * Configure an InteractionEvent to wrap a DOM PointerEvent and InteractionData\n   *\n   * @private\n   * @param {InteractionEvent} interactionEvent - The event to be configured\n   * @param {PointerEvent} pointerEvent - The DOM event that will be paired with the InteractionEvent\n   * @param {InteractionData} interactionData - The InteractionData that will be paired\n   *        with the InteractionEvent\n   * @return {InteractionEvent} the interaction event that was passed in\n   */\n  configureInteractionEventForDOMEvent(interactionEvent, pointerEvent, interactionData) {\n    interactionEvent.data = interactionData;\n\n    this.mapPositionToPoint(interactionData.global, pointerEvent.clientX, pointerEvent.clientY);\n\n    this.raycaster.setFromCamera(interactionData.global, this.camera);\n\n    // Not really sure why this is happening, but it's how a previous version handled things TODO: there should be remove\n    if (pointerEvent.pointerType === 'touch') {\n      pointerEvent.globalX = interactionData.global.x;\n      pointerEvent.globalY = interactionData.global.y;\n    }\n\n    interactionData.originalEvent = pointerEvent;\n    interactionEvent._reset();\n\n    return interactionEvent;\n  }\n\n  /**\n   * Ensures that the original event object contains all data that a regular pointer event would have\n   *\n   * @private\n   * @param {TouchEvent|MouseEvent|PointerEvent} event - The original event data from a touch or mouse event\n   * @return {PointerEvent[]} An array containing a single normalized pointer event, in the case of a pointer\n   *  or mouse event, or a multiple normalized pointer events if there are multiple changed touches\n   */\n  normalizeToPointerData(event) {\n    const normalizedEvents = [];\n\n    if (this.supportsTouchEvents && event instanceof TouchEvent) {\n      for (let i = 0, li = event.changedTouches.length; i < li; i++) {\n        const touch = event.changedTouches[i];\n\n        if (typeof touch.button === 'undefined') touch.button = event.touches.length ? 1 : 0;\n        if (typeof touch.buttons === 'undefined') touch.buttons = event.touches.length ? 1 : 0;\n        if (typeof touch.isPrimary === 'undefined') {\n          touch.isPrimary = event.touches.length === 1 && event.type === 'touchstart';\n        }\n        if (typeof touch.width === 'undefined') touch.width = touch.radiusX || 1;\n        if (typeof touch.height === 'undefined') touch.height = touch.radiusY || 1;\n        if (typeof touch.tiltX === 'undefined') touch.tiltX = 0;\n        if (typeof touch.tiltY === 'undefined') touch.tiltY = 0;\n        if (typeof touch.pointerType === 'undefined') touch.pointerType = 'touch';\n        if (typeof touch.pointerId === 'undefined') touch.pointerId = touch.identifier || 0;\n        if (typeof touch.pressure === 'undefined') touch.pressure = touch.force || 0.5;\n        touch.twist = 0;\n        touch.tangentialPressure = 0;\n        // TODO: Remove these, as layerX/Y is not a standard, is deprecated, has uneven\n        // support, and the fill ins are not quite the same\n        // offsetX/Y might be okay, but is not the same as clientX/Y when the canvas's top\n        // left is not 0,0 on the page\n        if (typeof touch.layerX === 'undefined') touch.layerX = touch.offsetX = touch.clientX;\n        if (typeof touch.layerY === 'undefined') touch.layerY = touch.offsetY = touch.clientY;\n\n        // mark the touch as normalized, just so that we know we did it\n        touch.isNormalized = true;\n\n        normalizedEvents.push(touch);\n      }\n    } else if (event instanceof MouseEvent && (!this.supportsPointerEvents || !(event instanceof window.PointerEvent))) {\n      if (typeof event.isPrimary === 'undefined') event.isPrimary = true;\n      if (typeof event.width === 'undefined') event.width = 1;\n      if (typeof event.height === 'undefined') event.height = 1;\n      if (typeof event.tiltX === 'undefined') event.tiltX = 0;\n      if (typeof event.tiltY === 'undefined') event.tiltY = 0;\n      if (typeof event.pointerType === 'undefined') event.pointerType = 'mouse';\n      if (typeof event.pointerId === 'undefined') event.pointerId = MOUSE_POINTER_ID;\n      if (typeof event.pressure === 'undefined') event.pressure = 0.5;\n      event.twist = 0;\n      event.tangentialPressure = 0;\n\n      // mark the mouse event as normalized, just so that we know we did it\n      event.isNormalized = true;\n\n      normalizedEvents.push(event);\n    } else {\n      normalizedEvents.push(event);\n    }\n\n    return normalizedEvents;\n  }\n\n  /**\n   * Destroys the interaction manager\n   *\n   */\n  destroy() {\n    this.removeEvents();\n\n    this.removeAllListeners();\n\n    this.renderer = null;\n\n    this.mouse = null;\n\n    this.eventData = null;\n\n    this.interactionDOMElement = null;\n\n    this.onPointerDown = null;\n    this.processPointerDown = null;\n\n    this.onPointerUp = null;\n    this.processPointerUp = null;\n\n    this.onPointerCancel = null;\n    this.processPointerCancel = null;\n\n    this.onPointerMove = null;\n    this.processPointerMove = null;\n\n    this.onPointerOut = null;\n    this.processPointerOverOut = null;\n\n    this.onPointerOver = null;\n\n    this._tempPoint = null;\n  }\n}\n\nexport default InteractionManager;\n","import { Camera, Object3D, Group, TextureLoader, Mesh, SphereBufferGeometry, MeshBasicMaterial, DoubleSide, Vector2, Vector3 } from 'three';\nimport Utils from '../../utils/Utils';\n\nconst RATIO = 0.15;\nconst RANGE = 60;\nconst PI2 = Math.PI * 2;\nconst START = new Vector2();\nconst END = new Vector2();\nconst UP = new Vector3(0, 1, 0);\n\n/**\n * 球面全景图组件，快速实现可交互的全景图\n */\nclass SphereWorld extends Object3D {\n  /**\n   * 构造函数\n   * @param {Object} options 配置\n   * @param {String} options.url 球面全景图的链接地址\n   * @param {Boolean} [options.flipX=true] 球面全景图纹理是否做水平翻转\n   * @param {Boolean} [options.flipY=false] 球面全景图纹理是否做垂直翻转\n   * @param {Boolean} [options.draggable=true] 球面全景图是否可拖拽\n   * @param {Number} [options.rangeMin=-60] Y轴拖拽的范围限制下限\n   * @param {Number} [options.rangeMax=60] Y轴拖拽的范围限制上限\n   * @param {Number} [options.driftX=0] 相对于摄像机的X轴旋转的修正角度\n   * @param {Number} [options.driftY=0] 相对于摄像机的Y轴旋转的修正角度\n   * @param {Number} [options.rotateSpeed=1] 球面全景图的旋转灵敏度\n   * @param {Number} [options.radius=1000] 球面全景图的球体半径\n   * @param {Number} [options.segmentationX=32] 球面全景图的球面横轴细分\n   * @param {Number} [options.segmentationY=32] 球面全景图的球面纵轴细分\n   */\n  constructor({ url, radius, segmentationX, segmentationY, flipX, flipY, draggable, rotateSpeed, rangeMin, rangeMax, driftX, driftY }) {\n    super();\n\n    this.needCamera = true;\n\n    this.needMount = true;\n\n    this.inner = new Group();\n    this.camera = null;\n\n    radius = radius || 1000;\n    segmentationX = segmentationX || 32;\n    segmentationY = segmentationY || 32;\n    driftX = Utils.isNumber(driftX) ? driftX : 0;\n    driftY = Utils.isNumber(driftY) ? driftY : 0;\n\n    this.background = new Mesh(\n      new SphereBufferGeometry(radius, segmentationX, segmentationY),\n      new MeshBasicMaterial({ map: new TextureLoader().load(url), side: DoubleSide })\n    );\n\n    flipX = Utils.isBoolean(flipX) ? flipX : true;\n    flipY = Utils.isBoolean(flipY) ? flipY : false;\n    if (flipX) {\n      this.background.scale.x = -1;\n    }\n    if (flipY) {\n      this.background.scale.y = -1;\n    }\n\n    this.inner.add(this.background);\n    super.add.call(this, this.inner);\n\n    this._onStart = this._onStart.bind(this);\n    this._onMove = this._onMove.bind(this);\n    this._onEnd = this._onEnd.bind(this);\n    this._draggable = false;\n    this._dragX = 0;\n    this.updateTracking = this.updateTracking.bind(this);\n    this.rotateSpeed = rotateSpeed || 1;\n    this.cx = 0;\n    this.cy = 0;\n    this.rangeMin = rangeMin || Utils.DTR(-RANGE);\n    this.rangeMax = rangeMax || Utils.DTR(RANGE);\n    this.eared = false;\n    this.draggable = Utils.isBoolean(draggable) ? draggable : true;\n    this.updateDrag({\n      dragY: driftX,\n      dragX: driftY,\n    });\n  }\n\n  /**\n   * set camera\n   * @param {PerspectiveCamera} camera scene camera, panorama need get camera pose state\n   */\n  setCamera(camera) {\n    if (camera instanceof Camera) {\n      this.camera = camera;\n    }\n  }\n\n  onDragChange() {\n    if (this.draggable) {\n      this.on('pretimeline', this.updateTracking);\n      this.addEvents();\n    } else {\n      this.off('pretimeline', this.updateTracking);\n      this.removeEvents();\n    }\n  }\n\n  addEvents() {\n    if (this.eared) return;\n    this.on('touchstart', this._onStart);\n    this.on('touchmove', this._onMove);\n    this.on('touchend', this._onEnd);\n    this.on('mousedown', this._onStart);\n    this.on('mousemove', this._onMove);\n    this.on('mouseup', this._onEnd);\n    this.eared = true;\n  }\n\n  removeEvents() {\n    this.off('touchstart', this._onStart);\n    this.off('touchmove', this._onMove);\n    this.off('touchend', this._onEnd);\n    this.off('mousedown', this._onStart);\n    this.off('mousemove', this._onMove);\n    this.off('mouseup', this._onEnd);\n    this.eared = false;\n  }\n\n  _onStart(ev) {\n    const originalEvent = ev.data.originalEvent;\n    if (originalEvent.touches && originalEvent.touches.length > 1) return;\n    this.hadStart = true;\n    if (originalEvent.touches) {\n      START.x = originalEvent.touches[0].pageX;\n      START.y = originalEvent.touches[0].pageY;\n    } else {\n      START.x = originalEvent.pageX;\n      START.y = originalEvent.pageY;\n    }\n    this.cx = this.dragX;\n    this.cy = this.inner.rotation.y;\n  }\n  _onMove(ev) {\n    const originalEvent = ev.data.originalEvent;\n    if (!this.hadStart || (originalEvent.touches && originalEvent.touches.length > 1)) return;\n    originalEvent.preventDefault();\n    if (originalEvent.touches) {\n      END.x = originalEvent.touches[0].pageX;\n      END.y = originalEvent.touches[0].pageY;\n    } else {\n      END.x = originalEvent.pageX;\n      END.y = originalEvent.pageY;\n    }\n    END.sub(START);\n\n    const x = END.y * RATIO * this.rotateSpeed;\n    const y = END.x * RATIO * this.rotateSpeed;\n\n    const dragX = this.cx + Utils.DTR(x);\n    const dragY = this.cy - Utils.DTR(y);\n    this.updateDrag({\n      dragX,\n      dragY,\n    });\n  }\n  _onEnd() {\n    this.hadStart = false;\n    this.cx = this.dragX;\n    this.cy = this.dragY;\n  }\n\n  updateDrag({ dragX, dragY }) {\n    this.dragX = Utils.isNumber(dragX) ? dragX : this.dragX;\n    this.dragY = Utils.isNumber(dragY) ? dragY : this.dragY;\n  }\n\n  updateTracking() {\n    if (!this.camera) return;\n    const vector = new Vector3(0, 0, -1);\n    vector.applyQuaternion(this.camera.quaternion);\n    this.quaternion.setFromAxisAngle(new Vector3().crossVectors(UP, vector), this.dragX);\n  }\n\n  /**\n   * 添加绘制对象\n   *\n   * @param {THREE.Object3D} child 添加的绘制对象\n   */\n  add() {\n    this.inner.add.apply(this.inner, arguments);\n  }\n\n  /**\n   * 移除绘制对象\n   *\n   * @param {THREE.Object3D} child 之前添加的绘制对象\n   */\n  remove() {\n    this.inner.remove.apply(this.inner, arguments);\n  }\n\n  /**\n   * getter whether draggable or not\n   */\n  get draggable() {\n    return this._draggable;\n  }\n\n  /**\n   * setter whether draggable or not\n   * @param {Boolean} value whether or not\n   */\n  set draggable(value) {\n    if (value !== this._draggable) {\n      this._draggable = value;\n      this.onDragChange();\n    }\n  }\n\n  /**\n   * getter dragX of this panorama\n   */\n  get dragX() {\n    return this._dragX;\n  }\n\n  /**\n   * setter dragX of this panorama\n   * @param {Number} radian rotation radian\n   */\n  set dragX(radian) {\n    radian = Utils.clamp(radian, this.rangeMin, this.rangeMax);\n    if (radian !== this._dragX) {\n      this._dragX = radian;\n    }\n  }\n\n  /**\n   * getter dragY of this panorama\n   */\n  get dragY() {\n    return this.inner.rotation.y;\n  }\n\n  /**\n   * setter dragY of this panorama\n   * @param {Number} radian rotation radian\n   */\n  set dragY(radian) {\n    radian = Utils.euclideanModulo(radian, PI2);\n    if (radian !== this.inner.rotation.y) {\n      this.inner.rotation.y = radian;\n    }\n  }\n}\n\nexport default SphereWorld;\n","import { Object3D, TextureLoader, Mesh, CylinderBufferGeometry, MeshBasicMaterial, DoubleSide, Vector2, Vector3 } from 'three';\nimport Utils from '../../utils/Utils';\nimport Orienter from '../../utils/Orienter';\n\nconst RATIO = 0.15;\nconst RANGE = 50;\nconst START = new Vector2();\nconst END = new Vector2();\n\n/**\n * 柱面全景图组件，快速实现可交互的全景图\n */\nclass CylinderWorld extends Object3D {\n  /**\n   * 构造函数\n   * @param {Object} options 配置\n   * @param {String} options.url 柱面全景图的链接地址\n   * @param {Number} [options.radius=512] 柱面全景图的球体半径\n   * @param {Number} [options.height=1000] 柱面全景图的球体半径\n   * @param {Number} [options.radiusSegments=64] 柱面全景图的柱面横轴细分\n   * @param {Number} [options.heightSegments=1] 柱面全景图的柱面纵轴细分\n   * @param {Boolean} [options.draggable=true] 柱面全景图是否可拖拽\n   * @param {Number} [options.zoomIn=true] 是否开启景深变化的效果\n   * @param {Number} [options.rangeMin=-50] 相对于摄像机的X轴旋转的范围限制下限\n   * @param {Number} [options.rangeMax=50] 相对于摄像机的X轴旋转的范围限制上限\n   * @param {Number} [options.driftX=0] 相对于摄像机的X轴旋转的修正角度\n   * @param {Number} [options.driftY=0] 相对于摄像机的Y轴旋转的修正角度\n   * @param {Number} [options.rotateSpeed=1] 柱面全景图的拖拽灵敏度\n   * @param {Number} [options.strength=0.3] 柱面全景图的陀螺仪灵敏度\n   * @param {Number} [options.viscosity=0.1] 平滑过渡的粘性\n   * @param {Number} [options.openEnded=true] 柱面全景图的两端是否开放\n   * @param {Boolean} [options.flipX=true] 柱面全景图纹理是否做水平翻转\n   * @param {Boolean} [options.flipY=false] 柱面全景图纹理是否做垂直翻转\n   */\n  constructor({ url, radius, height, radiusSegments, heightSegments, openEnded, flipX, flipY, draggable, zoomIn, rotateSpeed, strength, viscosity, rangeMin, rangeMax, driftX, driftY }) {\n    super();\n\n    this.needMount = true;\n\n    radius = radius || 512;\n    height = height || 1000;\n    radiusSegments = radiusSegments || 64;\n    heightSegments = heightSegments || 1;\n    openEnded = Utils.isBoolean(openEnded) ? openEnded : true;\n\n    this.background = new Mesh(\n      new CylinderBufferGeometry(radius, radius, height, radiusSegments, heightSegments, openEnded),\n      new MeshBasicMaterial({ map: new TextureLoader().load(url), side: DoubleSide })\n    );\n\n    flipX = Utils.isBoolean(flipX) ? flipX : true;\n    flipY = Utils.isBoolean(flipY) ? flipY : false;\n    if (flipX) {\n      this.background.scale.x = -1;\n    }\n    if (flipY) {\n      this.background.scale.y = -1;\n    }\n\n    this.add(this.background);\n\n    this._onStart = this._onStart.bind(this);\n    this._onMove = this._onMove.bind(this);\n    this._onEnd = this._onEnd.bind(this);\n\n    this._draggable = false;\n\n    this.rotateSpeed = rotateSpeed || 1;\n    this.strength = strength || 0.3;\n    this.viscosity = viscosity || 0.1;\n    this.rangeMin = rangeMin || -RANGE;\n    this.rangeMax = rangeMax || RANGE;\n    this.eared = false;\n    this.draggable = Utils.isBoolean(draggable) ? draggable : true;\n    this.zoomIn = Utils.isBoolean(zoomIn) ? zoomIn : true;\n\n    this.gyro = new Orienter();\n    this.drag = new Vector3();\n    this.updateDrag = this.updateDrag.bind(this);\n    this.on('pretimeline', this.updateDrag);\n\n    this.driftX = Utils.isNumber(driftX) ? driftX : 0;\n    this.driftY = Utils.isNumber(driftY) ? driftY : 0;\n  }\n\n  onDragChange() {\n    if (this.draggable) {\n      this.addEvents();\n    } else {\n      this.removeEvents();\n    }\n  }\n\n  addEvents() {\n    if (this.eared) return;\n    this.on('touchstart', this._onStart);\n    this.on('touchmove', this._onMove);\n    this.on('touchend', this._onEnd);\n    this.on('mousedown', this._onStart);\n    this.on('mousemove', this._onMove);\n    this.on('mouseup', this._onEnd);\n    this.eared = true;\n  }\n\n  removeEvents() {\n    this.off('touchstart', this._onStart);\n    this.off('touchmove', this._onMove);\n    this.off('touchend', this._onEnd);\n    this.off('mousedown', this._onStart);\n    this.off('mousemove', this._onMove);\n    this.off('mouseup', this._onEnd);\n    this.eared = false;\n  }\n\n  _onStart(ev) {\n    const originalEvent = ev.data.originalEvent;\n    if (originalEvent.touches && originalEvent.touches.length > 1) return;\n    this.hadStart = true;\n    if (originalEvent.touches) {\n      START.x = originalEvent.touches[0].pageX;\n      START.y = originalEvent.touches[0].pageY;\n    } else {\n      START.x = originalEvent.pageX;\n      START.y = originalEvent.pageY;\n    }\n  }\n  _onMove(ev) {\n    const originalEvent = ev.data.originalEvent;\n    if (!this.hadStart || (originalEvent.touches && originalEvent.touches.length > 1)) return;\n    originalEvent.preventDefault();\n    if (originalEvent.touches) {\n      END.x = originalEvent.touches[0].pageX;\n      END.y = originalEvent.touches[0].pageY;\n    } else {\n      END.x = originalEvent.pageX;\n      END.y = originalEvent.pageY;\n    }\n    const DIFF = new Vector2()\n      .copy(END)\n      .sub(START)\n      .multiplyScalar(RATIO * this.rotateSpeed);\n    this.drag.x = Utils.clamp(this.drag.x - DIFF.y, this.rangeMin, this.rangeMax);\n    this.drag.y = Utils.euclideanModulo(this.drag.y - DIFF.x, 360);\n    START.copy(END);\n  }\n  _onEnd() {\n    this.hadStart = false;\n  }\n\n  updateDrag() {\n    const target = Utils.euclideanModulo(this.drag.y - this.gyro.lon, 360);\n    const breaking = target - this.dragY;\n    let compensate = 0;\n    if (breaking > 180) compensate = 360;\n    if (breaking < -180) compensate = -360;\n    const speed = new Vector2(\n      (this.drag.x - this.gyro.lat * this.strength) - this.dragX,\n      target - (this.dragY + compensate)\n    );\n\n    if (this.zoomIn) {\n      const zoomIn = -Utils.clamp(Math.abs(5 * speed.length()), 0, 200) - this.position.z;\n      this.position.z += zoomIn * this.viscosity * 2;\n    } else {\n      this.position.z = 0;\n    }\n\n    if (Math.abs(speed.y) > 1) {\n      this.dragY += speed.y * this.viscosity;\n    }\n    if (Math.abs(speed.x) > 1) {\n      this.dragX += speed.x * this.viscosity;\n    }\n  }\n\n  /**\n   * getter whether draggable or not\n   */\n  get draggable() {\n    return this._draggable;\n  }\n\n  /**\n   * setter whether draggable or not\n   * @param {Boolean} value whether or not\n   */\n  set draggable(value) {\n    if (value !== this._draggable) {\n      this._draggable = value;\n      this.onDragChange();\n    }\n  }\n\n  /**\n   * getter dragX of this panorama\n   */\n  get dragX() {\n    return Utils.RTD(this.rotation.x);\n  }\n\n  /**\n   * setter dragX of this panorama\n   * @param {Number} degree rotation degree\n   */\n  set dragX(degree) {\n    degree = Utils.clamp(degree, -90, 90);\n    if (degree !== this.dragX) {\n      this.rotation.x = Utils.DTR(degree);\n    }\n  }\n\n  /**\n   * getter dragY of this panorama\n   */\n  get dragY() {\n    return Utils.RTD(this.rotation.y);\n  }\n\n  /**\n   * setter dragY of this panorama\n   * @param {Number} degree rotation degree\n   */\n  set dragY(degree) {\n    degree = Utils.euclideanModulo(degree, 360);\n    if (degree !== this.dragY) {\n      this.rotation.y = Utils.DTR(degree);\n    }\n  }\n\n  /**\n   * getter driftY of this panorama\n   */\n  get driftY() {\n    return Utils.RTD(this.background.rotation.y);\n  }\n\n  /**\n   * setter driftY of this panorama\n   * @param {Number} degree rotation degree\n   */\n  set driftY(degree) {\n    degree = Utils.euclideanModulo(degree, 360);\n    if (degree !== this.driftY) {\n      this.background.rotation.y = Utils.DTR(degree);\n    }\n  }\n\n  /**\n   * getter driftX of this panorama\n   */\n  get driftX() {\n    return this.drag.x;\n  }\n\n  /**\n   * setter driftX of this panorama\n   * @param {Number} degree rotation degree\n   */\n  set driftX(degree) {\n    degree = Utils.clamp(degree, this.rangeMin, this.rangeMax);\n    if (degree !== this.driftX) {\n      this.drag.x = degree;\n    }\n  }\n}\n\nexport default CylinderWorld;\n","import { PerspectiveCamera, StereoCamera } from 'three';\nimport Viewer from './Viewer';\nimport InteractionManager from 'three.interaction/src/interaction/InteractionManager';\nimport SphereWorld from '../extras/panorama/SphereWorld';\nimport CylinderWorld from '../extras/panorama/CylinderWorld';\nimport Utils from '../utils/Utils';\nimport Orienter from '../utils/Orienter';\n\n/**\n * `XR-Viewer` a `UC-VR` or `UC-3D` renderer framework\n * @extends Viewer\n * @param {Object} options config for `XR-Viewer` render view-port\n * @param {canvas} options.canvas `canvas-dom` or canvas `css-selector`\n * @param {Number} [options.width=300] init renderer width.\n * @param {Number} [options.height=150] init renderer height.\n * @param {Number} [options.updateStyle=false] auto update css style when setSize.\n * @param {Number} [options.fov=60] Camera frustum vertical field of view.\n * @param {Number} [options.aspect=width/height] Camera frustum aspect ratio.\n * @param {Number} [options.near=0.1] Camera frustum near plane.\n * @param {Number} [options.far=1000] Camera frustum far plane.\n * @param {Number} [options.vrmode=false] whether init with vrmode.\n * @param {Number} [options.stereoAspect=0.5] stereo camera aspect for vrmode.\n * @param {Number} [options.vrsensor=false] whether init with vrsensor.\n * @param {Boolean} [options.interactive=true] whether interactive with scene.\n * @param {Number} [options.fps=60] render frame rate.\n * @param {Boolean} [options.autoClear=true] whether the renderer should automatically clear its output before rendering a frame.\n * @param {Boolean} [options.alpha=false] whether the canvas contains an alpha (transparency) buffer or not.\n * @param {Boolean} [options.antialias=false] whether to perform antialiasing.\n * @param {String} [options.precision='highp'] Shader precision, Can be `highp`, `mediump` or `lowp`.\n * @param {Boolean} [options.premultipliedAlpha=true] whether the renderer will assume that colors have premultiplied alpha.\n * @param {Boolean} [options.stencil=true] whether the drawing buffer has a stencil buffer of at least 8 bits.\n * @param {Boolean} [options.preserveDrawingBuffer=false] whether to preserve the buffers until manually cleared or overwritten.\n * @param {Boolean} [options.depth=true] whether the drawing buffer has a depth buffer of at least 16 bits.\n * @param {Boolean} [options.logarithmicDepthBuffer] whether to use a logarithmic depth buffer.\n */\nclass XRViewer extends Viewer {\n  constructor(options) {\n    super(options);\n\n    const { width, height } = this.renderer.getSize();\n\n    const { vrmode, vrsensor, fov = 60, aspect = width / height, near = 0.1, far = 1000 } = options;\n\n    /**\n     * view-port camera object, a perspective camera\n     *\n     * @member {Camera}\n     */\n    this.camera = new PerspectiveCamera(fov, aspect, near, far);\n\n    /**\n     * stereo camera object\n     *\n     * @member {StereoCamera}\n     */\n    this.stereo = new StereoCamera();\n    this.stereo.aspect = options.stereoAspect || 0.5;\n\n    /**\n     * enable vr-mode or not\n     *\n     * @member {Boolean}\n     */\n    this.vrmode = vrmode || false;\n\n    /**\n     * use orientation sensor or not\n     *\n     * @member {Boolean}\n     */\n    this.vrsensor = vrsensor || false;\n\n    /**\n     * device orientation sensor, control camera look around\n     *\n     * @member {Orienter}\n     */\n    this.sensorCTL = new Orienter();\n\n    // update sensor state before update timeline\n    this.sensorCTL.on('deviceorientation', ({ quaternion }) => {\n      if (this.vrsensor) {\n        this.camera.quaternion.copy(quaternion);\n      }\n    });\n\n    /**\n     * 3d-view interaction manager\n     * TODO: should fix interaction bug when vrmode\n     */\n    this.interactionManager = new InteractionManager(this.renderer, this.graphicsLayer.graphics, this.camera);\n\n    // update interaction in every tick\n    const interactionUpdate = ({ snippet }) => {\n      this.interactionManager.update(snippet);\n    };\n\n    /**\n     * whether all 3d-view is interactively or not\n     *\n     * @member {boolean}\n     * @private\n     */\n    this._interactive = null;\n\n    this.interactiveOnChange = function() {\n      if (this.interactive) {\n        this.on('pretimeline', interactionUpdate);\n        this.interactionManager.addEvents();\n      } else {\n        this.off('pretimeline', interactionUpdate);\n        this.interactionManager.removeEvents();\n      }\n    };\n\n    /**\n     * whether all 3d-view is interactively or not\n     *\n     * @member {boolean}\n     */\n    this.interactive = Utils.isBoolean(options.interactive) ?\n      options.interactive :\n      true;\n  }\n\n  /**\n   * scene background\n   */\n  get background() {\n    return this._background;\n  }\n\n  /**\n   * set scene background\n   * @param {SphereWorld|CylinderWorld} bg scene background\n   */\n  set background(bg) {\n    if (bg instanceof SphereWorld || bg instanceof CylinderWorld) {\n      this._background = bg;\n\n      if (bg.needCamera) {\n        bg.setCamera(this.camera);\n      }\n      if (bg.needMount) {\n        this.add(bg);\n      }\n    } else {\n      console.log('unexpected background instance, only support SphereWorld、CylinderWorld');\n    }\n  }\n\n  /**\n   * getter whether scene interactively or not\n   */\n  get interactive() {\n    return this._interactive;\n  }\n\n  /**\n   * setter whether scene interactively or not\n   * @param {Boolean} value is interactively ?\n   */\n  set interactive(value) {\n    if (value !== this.interactive) {\n      this._interactive = value;\n      this.interactiveOnChange();\n    }\n  }\n\n  /**\n   * render all scene\n   */\n  render() {\n    if (this.autoClear) {\n      this.renderer.setRenderTarget(null);\n      this.renderer.clear(this.renderer.autoClearColor, this.renderer.autoClearDepth, this.renderer.autoClearStencil);\n    }\n\n    this.xrrender();\n  }\n\n  /**\n   * auto switch render-mode, use vrmode or not\n   */\n  xrrender() {\n    const size = this.renderer.getDrawingBufferSize();\n    if (this.vrmode) {\n      const hw = size.width / 2;\n      this.updateStereo();\n\n      this.renderer.setScissorTest(true);\n\n      this.setSV(0, 0, hw, size.height);\n      this.renderLayer(this.stereo.cameraL);\n\n      this.setSV(hw, 0, hw, size.height);\n      this.renderLayer(this.stereo.cameraR);\n\n      this.renderer.setScissorTest(false);\n    } else {\n      this.setSV(0, 0, size.width, size.height);\n\n      this.renderLayer(this.camera);\n    }\n  }\n\n  /**\n   * update stereo camera\n   */\n  updateStereo() {\n    if (this.camera.parent === null) this.camera.updateMatrixWorld();\n    this.stereo.update(this.camera);\n  }\n\n  /**\n   * set render rectangle area\n   * @param {*} x rectangle left-top point x-position\n   * @param {*} y rectangle left-top point y-position\n   * @param {*} width rectangle width\n   * @param {*} height rectangle height\n   */\n  setSV(x, y, width, height) {\n    this.renderer.setScissor(x, y, width, height);\n    this.renderer.setViewport(x, y, width, height);\n  }\n\n  /**\n   * push a display object into graphicsLayer scene\n   *\n   * @param {THREE.Object3D} child display object, which will be rendering\n   * @return {this} this\n   */\n  add() {\n    this.graphicsLayer.add.apply(this.graphicsLayer, arguments);\n    return this;\n  }\n\n  /**\n   * remove a display object from graphicsLayer scene\n   *\n   * @param {THREE.Object3D} child display object, which you had push it at before\n   * @return {this} this\n   */\n  remove() {\n    this.graphicsLayer.remove.apply(this.graphicsLayer, arguments);\n    return this;\n  }\n}\n\nexport default XRViewer;\n","import { OrthographicCamera, Scene, PlaneBufferGeometry, Matrix3, Vector3 } from 'three';\nimport Utils from '../../utils/Utils';\n\nconst LANDSCAPE_MAP = {\n  NONE: 0,\n  CW: Utils.DTR(-90),\n  CCW: Utils.DTR(90),\n};\n\n/**\n * base primer class, provide primering paint\n */\nclass Primer {\n  /**\n   * post some config to primer\n   * @param {*} _ have not be used\n   * @param {*} options config primer status\n   */\n  constructor(_, options) {\n    options = options || {};\n\n    /**\n     * frame landscape orientation\n     * @member {Number}\n     * @private\n     */\n    this.landscape = Utils.isString(options.landscape) && LANDSCAPE_MAP[options.landscape] ?\n      LANDSCAPE_MAP[options.landscape] : LANDSCAPE_MAP.CW;\n\n    /**\n     * this frame need to flip with y-axis\n     * @member {Boolean}\n     * @private\n     */\n    this.flip = Utils.isBoolean(options.flip) ? options.flip : true;\n\n    /**\n     * uv matrix\n     * @member {Matrix3}\n     * @private\n     */\n    this.uvMatrix = new Matrix3();\n\n    /**\n     * primer tag\n     * @member {Boolean}\n     */\n    this.isPrimer = true;\n\n    /**\n     * this primer is enable\n     * @member {Boolean}\n     */\n    this.enabled = true;\n\n    /**\n     * the parent of this parent\n     * @member {Layer}\n     * @private\n     */\n    this.parent = null;\n\n    /**\n     * scene for this 2D context\n     * @member {Scene}\n     * @private\n     */\n    this.scene = new Scene();\n\n    /**\n     * camera for this 2D context\n     * @member {OrthographicCamera}\n     * @private\n     */\n    this.camera = new OrthographicCamera(-1, 1, 1, -1, 0, 1);\n\n    /**\n     * geometry for this 2D context\n     * @member {PlaneBufferGeometry}\n     * @private\n     */\n    this.pigmentGeo = new PlaneBufferGeometry(2, 2);\n\n    /**\n     * whether auto-cover to target viewport\n     * @member {Boolean}\n     */\n    this.autoCover = options.autoCover || false;\n\n    if (this.autoCover && options.targetAspect) {\n      this.setTargetAspect(options.targetAspect);\n    }\n  }\n\n  /**\n   * update timeline\n   */\n  updateTimeline() {\n\n  }\n\n  /**\n   * render function, need overwrite by sub-class\n   */\n  render() {\n    console.warn('should be overwrite by sub-class');\n  }\n\n  /**\n   * set the target viewport aspect\n   * @param {Number} aspect target viewport aspect\n   */\n  setTargetAspect(aspect) {\n    this.targetAspect = aspect;\n    if (this.autoCover) this.needsUpdateAttributes = true;\n  }\n\n  /**\n   * update attribute\n   * @private\n   */\n  _updateAttributes() {\n    if (!this.needsUpdateAttributes) return;\n    const { width, height } = this._cs();\n    this._setPositions(this.pigmentGeo.attributes.position, width, height);\n    this.needsUpdateAttributes = false;\n  }\n\n  /**\n   * update aspect itself\n   * @param {Number} aspect target viewport aspect\n   * @private\n   */\n  _setAspect(aspect) {\n    this.aspect = aspect;\n    if (this.autoCover) this.needsUpdateAttributes = true;\n  }\n\n  /**\n   * calculation the size for geometry in this targetAspect\n   * @return {Object} size\n   * @private\n   */\n  _cs() {\n    const scale = this.aspect / this.targetAspect;\n    const size = {\n      width: 1,\n      height: 1,\n    };\n    if (this.targetAspect > this.aspect) {\n      size.height = 1 / scale;\n    } else if (this.targetAspect < this.aspect) {\n      size.width = scale;\n    }\n    return size;\n  }\n\n  /**\n   * resize geometry size\n   * @param {BufferAttribute} positions positions buffer\n   * @param {Number} width target width\n   * @param {Number} height target height\n   * @return {BufferAttribute} updated BufferAttribute\n   */\n  _setPositions(positions, width, height) {\n    const coefficient = [ -1, 1, 0, 1, 1, 0, -1, -1, 0, 1, -1, 0 ];\n    for (let i = 0; i < positions.count; i++) {\n      const item = positions.itemSize * i;\n      positions.array[item] = coefficient[item] * width;\n      positions.array[item + 1] = coefficient[item + 1] * height;\n    }\n    positions.needsUpdate = true;\n    return positions;\n  }\n\n  /**\n   * correct uv buffer\n   * @param {BufferAttribute} uv uv bufferAttribute\n   * @return {BufferAttribute} corrected BufferAttribute\n   */\n  _correctUv(uv) {\n    const v1 = new Vector3();\n    this.uvMatrix.identity();\n    this.uvMatrix.translate(-0.5, -0.5);\n    this.uvMatrix.rotate(this.landscape);\n    if (this.flip) this.uvMatrix.scale(1, -1);\n    this.uvMatrix.translate(0.5, 0.5);\n    for (let i = 0, l = uv.count; i < l; i++) {\n      v1.x = uv.getX(i);\n      v1.y = uv.getY(i);\n      v1.z = 1;\n\n      v1.applyMatrix3(this.uvMatrix);\n      uv.setXY(i, v1.x, v1.y);\n    }\n    uv.needsUpdate = true;\n    return uv;\n  }\n\n  /**\n   * get autoCover status\n   */\n  get autoCover() {\n    return this._autoCover;\n  }\n\n  /**\n   * set autoCover status\n   * @param {Boolean} autoCover whether autoCover or not\n   */\n  set autoCover(autoCover) {\n    if (autoCover !== this.autoCover) {\n      this._autoCover = autoCover;\n      if (autoCover) this.needsUpdateAttributes = true;\n    }\n  }\n}\n\nexport default Primer;\n","import {\n  LuminanceFormat,\n  Color,\n} from 'three';\n\n/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Focus shader\n * based on PaintEffect postprocess from ro.me\n * http://code.google.com/p/3-dreams-of-black/source/browse/deploy/js/effects/PaintEffect.js\n * @private\n */\nconst YUVShader = {\n\n  texOrder: [ 'uYTex', 'uUTex', 'uVTex' ],\n\n  uniforms: {\n\n    uYTex: { value: null, ss: 1, format: LuminanceFormat },\n    uUTex: { value: null, ss: 0.5, format: LuminanceFormat },\n    uVTex: { value: null, ss: 0.5, format: LuminanceFormat },\n\n    diffuse: { value: new Color(0xffffff) },\n\n  },\n\n  vertexShader: `\n  varying vec2 vUv;\n  void main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  }`,\n\n  fragmentShader: `\n  uniform sampler2D uYTex;\n  uniform sampler2D uUTex;\n  uniform sampler2D uVTex;\n\n  uniform vec3 diffuse;\n\n  varying vec2 vUv;\n\n  const mat3 mYUV2RGB = mat3(\n    1.0,   1.0,     1.0,\n    0.0,  -0.395,  2.032,\n    1.40, -0.581,   0.0\n  );\n\n  void main(){\n    vec3 YUV;\n    YUV.x = 1.1643 * (texture2D(uYTex, vUv).r - 0.0625);\n    YUV.y = texture2D(uUTex, vUv).r - 0.5;\n    YUV.z = texture2D(uVTex, vUv).r - 0.5;\n\n    gl_FragColor = vec4(diffuse * diffuse * (mYUV2RGB * YUV), 1.0);\n  }`,\n};\n\nexport default YUVShader;\n","import {\n  LuminanceFormat,\n  LuminanceAlphaFormat,\n  Color,\n} from 'three';\n\n/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Focus shader\n * based on PaintEffect postprocess from ro.me\n * http://code.google.com/p/3-dreams-of-black/source/browse/deploy/js/effects/PaintEffect.js\n * @private\n */\nconst YCbCrShader = {\n\n  texOrder: [ 'uYTex', 'uCTex' ],\n\n  uniforms: {\n\n    uYTex: { value: null, ss: 1, format: LuminanceFormat },\n    uCTex: { value: null, ss: 0.5, format: LuminanceAlphaFormat },\n\n    diffuse: { value: new Color(0xffffff) },\n\n  },\n\n  vertexShader: `\n  varying vec2 vUv;\n  void main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  }`,\n\n  fragmentShader: `\n  uniform sampler2D uYTex;\n  uniform sampler2D uCTex;\n  uniform vec3 diffuse;\n\n  varying vec2 vUv;\n\n  const mat3 mYCbCrToRGB = mat3(\n    1.0,      1.0,     1.0,\n    0.0,     -0.18732, 1.8556,\n    1.57481, -.46813,  0.0\n  );\n\n  void main(){\n    vec3 YCbCr;\n    YCbCr.x  = texture2D(uYTex, vUv).r;\n    YCbCr.yz = texture2D(uCTex, vUv).ra - 0.5;\n    gl_FragColor = vec4(diffuse * diffuse * (mYCbCrToRGB * YCbCr), 1.0);\n  }`,\n};\n\nexport default YCbCrShader;\n","import {\n  Mesh,\n  UniformsUtils,\n  ShaderMaterial,\n  DataTexture,\n  Color,\n} from 'three';\nimport Primer from './Primer';\nimport YUVShader from '../../shader/YUVShader';\nimport YCbCrShader from '../../shader/YCbCrShader';\n\nconst FORMAT_MAP = {\n  3: YUVShader,\n  4: YCbCrShader,\n  5: YCbCrShader,\n};\n\n/**\n * camera-primer, for ali webar framework\n */\nclass CameraPrimer extends Primer {\n  /**\n   * required displayTarget to get frame\n   * @param {DisplayTarget} displayTarget webar DisplayTarget class\n   * @param {Object} options primer config\n   * @param {Color} [options.color=0xffffff] tint color\n   * @param {Boolean} [options.depthTest=false] enbale depth test\n   * @param {Boolean} [options.depthWrite=false] enbale depth write\n   */\n  constructor(displayTarget, options) {\n    super(displayTarget, options);\n\n    const { color = 0xffffff, depthTest = false, depthWrite = false } = options || {};\n\n    /**\n     * cache the displayTarget\n     * @member {DisplayTarget}\n     */\n    this.displayTarget = displayTarget;\n\n    /**\n     * set primer tint color\n     * @member {Color}\n     */\n    this.color = color;\n\n    /**\n     * whether enbale depth test or not\n     * @member {Boolean}\n     * @private\n     */\n    this._depthTest = depthTest || false;\n\n    /**\n     * whether enbale depth write or not\n     * @member {Boolean}\n     * @private\n     */\n    this._depthWrite = depthWrite || false;\n\n    this.init(this.getFrames());\n  }\n\n  /**\n   * get frame data from displayTarget\n   * @return {frameData} camera frame data\n   */\n  getFrames() {\n    return this.displayTarget.getFrames();\n  }\n\n  /**\n   * init set something\n   * @param {frameData} frameData camera frame data\n   * @private\n   */\n  init({ format, dataArray, width, height }) {\n    this.shader = FORMAT_MAP[format];\n\n    this.uniforms = UniformsUtils.clone(this.shader.uniforms);\n\n    this.shader.texOrder.forEach((tex, idx) => {\n      const { ss, format } = this.uniforms[tex];\n      this.uniforms[tex].value = new DataTexture(dataArray[idx], width * ss, height * ss, format);\n    });\n\n    this.uniforms.diffuse.value = new Color(this.color);\n\n    this.pigmentMat = new ShaderMaterial({\n      uniforms: this.uniforms,\n      vertexShader: this.shader.vertexShader,\n      fragmentShader: this.shader.fragmentShader,\n      depthTest: this._depthTest,\n      depthWrite: this._depthWrite,\n    });\n\n    this.pigment = new Mesh(this.pigmentGeo, this.pigmentMat);\n    this.pigment.frustumCulled = false;\n\n    this._correctUv(this.pigmentGeo.attributes.uv);\n\n    this.scene.add(this.pigment);\n\n    this._setAspect(height / width);\n  }\n\n  /**\n   * update shader uniforms and aspect itself\n   * @param {frameData} frameData camera frame data\n   * @private\n   */\n  updateFrame({ dataArray, width, height }) {\n    this.shader.texOrder.forEach((tex, idx) => {\n      if (this.uniforms[tex].value.needsUpdate) return;\n      const { ss } = this.uniforms[tex];\n      this.uniforms[tex].value.image.data = dataArray[idx];\n      this.uniforms[tex].value.image.width = width * ss;\n      this.uniforms[tex].value.image.height = height * ss;\n      this.uniforms[tex].value.needsUpdate = true;\n    });\n    this._setAspect(height / width);\n  }\n\n  /**\n   * update attribute and frame\n   */\n  update() {\n    if (this.autoCover) this._updateAttributes();\n    if (!this.displayTarget.isDirty) return;\n    this.updateFrame(this.getFrames());\n  }\n\n  /**\n   * render this primer\n   * @param {WebGLRenderer} renderer put webgl renderer\n   * @param {WebGLRenderTarget} rednerTarget render to which buffer\n   */\n  render(renderer, rednerTarget) {\n    this.update();\n    renderer.render(this.scene, this.camera, rednerTarget);\n  }\n}\n\nexport default CameraPrimer;\n","import {\n  Mesh,\n  MeshBasicMaterial,\n  VideoTexture,\n  CanvasTexture,\n  Texture,\n  TextureLoader,\n  Color,\n} from 'three';\nimport Primer from './Primer';\nimport Utils from '../../utils/Utils';\n\n/**\n * texture-primer, for Texture CanvasTexture VideoTexture\n */\nclass TexturePrimer extends Primer {\n  /**\n   * create a texture frame\n   * @param {image|canvas|video} frame texture frame\n   * @param {Object} options config\n   * @param {Color} [options.color=0xffffff] tint color\n   * @param {Boolean} [options.depthTest=false] enable depth test\n   * @param {Boolean} [options.depthWrite=false] enable depth write\n   * @param {THREE.Filter} [options.minFilter] use which min filter\n   * @param {THREE.Filter} [options.magFilter] use which mag filter\n   * @param {THREE.Format} [options.format] use which color format\n   */\n  constructor(frame, options) {\n    super(frame, options);\n\n    const { color = 0xffffff, depthTest = false, depthWrite = false, minFilter, magFilter, format } = options || {};\n\n    this.texture = Utils.isString(frame) ? new TextureLoader().load(frame) :\n      frame.tagName === 'VIDEO' ? new VideoTexture(frame) :\n        frame.tagName === 'CANVAS' ? new CanvasTexture(frame) :\n          frame.tagName === 'IMG' ? new Texture(frame) : null;\n\n    if (minFilter) this.texture.minFilter = minFilter;\n    if (magFilter) this.texture.magFilter = magFilter;\n    if (format) this.texture.format = format;\n\n\n    this.pigmentMat = new MeshBasicMaterial({\n      color: new Color(color),\n      map: this.texture,\n      depthTest,\n      depthWrite,\n    });\n\n    this.pigment = new Mesh(this.pigmentGeo, this.pigmentMat);\n    this.pigment.frustumCulled = false;\n\n    this.scene.add(this.pigment);\n\n    this._gainFrameSize();\n  }\n\n  /**\n   * gain frame size, and to adjust aspect\n   */\n  _gainFrameSize() {\n    const image = this.texture.image;\n    if (!image) return;\n    if (image.width > 0 && image.height > 0) {\n      this._setAspect(image.width / image.height);\n    } else {\n      image.addEventListener('load', () => {\n        this._setAspect(image.width / image.height);\n      });\n    }\n  }\n\n  /**\n   * update positions attribute\n   */\n  update() {\n    if (this.autoCover) this._updateAttributes();\n  }\n\n  /**\n   * render this primer\n   * @param {WebGLRenderer} renderer put webgl renderer\n   * @param {WebGLRenderTarget} rednerTarget render to which buffer\n   */\n  render(renderer, rednerTarget) {\n    this.update();\n    renderer.render(this.scene, this.camera, rednerTarget);\n  }\n}\n\nexport default TexturePrimer;\n","import { Group, Matrix4 } from 'three';\n\n/**\n * anchor class, help your to bind interaction event\n */\nclass AnchorBase extends Group {\n  /**\n   * help you caculate anchor position, relative which parent\n   *\n   * @param {Vector3} point global position relative camera\n   * @param {Object3D} parent relative which parent\n   * @return {Vector3} position relative parent coordinate system\n   */\n  putWhere(point, parent) {\n    point.multiplyScalar(0.9);\n    point.applyMatrix4(new Matrix4().getInverse(parent.matrixWorld));\n    this.position.set(point.x, point.y, point.z);\n    this.lookAt(0, 0, 0);\n    return point;\n  }\n\n  /**\n   * put anchor to which posotion, position was relative it's parent\n   *\n   * @param {Vector3} position position was relative it's parent\n   */\n  putHere(position) {\n    this.position.set(position.x, position.y, position.z);\n    this.lookAt(0, 0, 0);\n  }\n}\n\nexport default AnchorBase;\n","import { Group, Mesh, CircleBufferGeometry, PlaneBufferGeometry, MeshBasicMaterial, Color, TextureLoader } from 'three';\nimport Utils from '../../utils/Utils';\nimport AnchorBase from './AnchorBase';\nimport Tween from '../../utils/Tween';\n\n/**\n * anchor class, help your to bind interaction event\n */\nclass AnchorRippling extends AnchorBase {\n  /**\n   * 构造函数\n   * @param {Object} options 配置\n   * @param {String} [options.image] 点击区域的半径\n   * @param {Number} [options.width=8] 点击区域的半径\n   * @param {Number} [options.height=8] 点击区域的半径\n   * @param {Number} [options.segmentation=4] 点击区域的圆细分\n   * @param {Boolean} [options.rippling=false] 点击区域的圆细分\n   * @param {Number} [options.radius=8] 点击区域的半径\n   * @param {Number} [options.segmentationRip=8] 点击区域的半径\n   * @param {Color} [options.color=0xffffff] 点击区域的圆细分\n   * @param {Number} [options.count=2] 点击区域的圆细分\n   * @param {Number} [options.duration=1000] 点击区域的圆细分\n   */\n  constructor(options) {\n    super();\n    const { image, width, height, segmentation = 4, rippling, radius = 8, segmentationRip = 16, color, count = 2, duration = 1800 } = options || {};\n    /**\n     * global texture for stars\n     * @member {Texture}\n     */\n    this.map = Utils.isString(image) ? new TextureLoader().load(image) : null;\n\n    this.waves = new Group();\n    this.waves.position.z = -0.1;\n    this.uiFace = new Mesh(\n      new PlaneBufferGeometry(width, height, segmentation, segmentation),\n      new MeshBasicMaterial({ map: this.map, transparent: true })\n    );\n\n    if (rippling) this.initRippling(radius, segmentationRip, color, count, duration);\n\n    this.add(this.uiFace);\n  }\n\n  initRippling(radius, segmentation, color, count, duration) {\n    const waitTime = duration / count;\n    for (let i = 0; i <= count; i++) {\n      const last = i === count;\n      const circle = new Mesh(\n        new CircleBufferGeometry(radius, segmentation),\n        new MeshBasicMaterial({ color: new Color(color), transparent: true, depthTest: false })\n      );\n      if (!last) {\n        const wait = waitTime * i;\n        circle.runners({\n          runners: [\n            { from: { 'material.opacity': 0.1 }, to: { scaleXYZ: 1.25, 'material.opacity': 0.5 }, duration: duration * 0.4, ease: Tween.Linear.None },\n            { to: { scaleXYZ: 1.5, 'material.opacity': 0 }, duration: duration * 0.6, ease: Tween.Linear.None },\n          ],\n          wait,\n          infinite: true,\n        });\n      }\n\n      this.waves.add(circle);\n    }\n    this.add(this.waves);\n  }\n}\n\nexport default AnchorRippling;\n","import {\n  FileLoader,\n  DefaultLoadingManager,\n  Loader,\n  Color,\n  DirectionalLight,\n  PointLight,\n  SpotLight,\n  AmbientLight,\n  MeshPhongMaterial,\n  MeshLambertMaterial,\n  MeshBasicMaterial,\n  ShaderMaterial,\n  ShaderLib,\n  UniformsUtils,\n  Vector2,\n  NearestFilter,\n  LinearFilter,\n  NearestMipMapNearestFilter,\n  LinearMipMapNearestFilter,\n  NearestMipMapLinearFilter,\n  LinearMipMapLinearFilter,\n  ClampToEdgeWrapping,\n  MirroredRepeatWrapping,\n  RepeatWrapping,\n  AlphaFormat,\n  RGBFormat,\n  RGBAFormat,\n  LuminanceFormat,\n  LuminanceAlphaFormat,\n  UnsignedByteType,\n  UnsignedShort4444Type,\n  UnsignedShort5551Type,\n  UnsignedShort565Type,\n  // BackSide,\n  FrontSide,\n  // NeverDepth,\n  // LessDepth,\n  // EqualDepth,\n  // LessEqualDepth,\n  // GreaterEqualDepth,\n  // NotEqualDepth,\n  // AlwaysDepth,\n  // AddEquation,\n  // SubtractEquation,\n  // ReverseSubtractEquation,\n  // ZeroFactor,\n  // OneFactor,\n  // SrcColorFactor,\n  // OneMinusSrcColorFactor,\n  // SrcAlphaFactor,\n  // OneMinusSrcAlphaFactor,\n  // DstAlphaFactor,\n  // OneMinusDstAlphaFactor,\n  // DstColorFactor,\n  // OneMinusDstColorFactor,\n  // SrcAlphaSaturateFactor,\n  InterpolateSmooth,\n  InterpolateLinear,\n  InterpolateDiscrete,\n  MeshStandardMaterial,\n  InterleavedBuffer,\n  InterleavedBufferAttribute,\n  BufferAttribute,\n  TextureLoader,\n  DoubleSide,\n  BufferGeometry,\n  Group,\n  VertexColors,\n  FlatShading,\n  Mesh,\n  TriangleStripDrawMode,\n  TriangleFanDrawMode,\n  LineSegments,\n  Line,\n  LineLoop,\n  Points,\n  PerspectiveCamera,\n  OrthographicCamera,\n  NumberKeyframeTrack,\n  QuaternionKeyframeTrack,\n  VectorKeyframeTrack,\n  AnimationUtils,\n  AnimationClip,\n  Matrix4,\n  Bone,\n  Object3D,\n  PropertyBinding,\n  SkinnedMesh,\n  Skeleton,\n  Scene,\n} from 'three';\n\n\n// const BINARY_EXTENSION_BUFFER_NAME = 'binary_glTF';\nconst BINARY_EXTENSION_HEADER_MAGIC = 'glTF';\nconst BINARY_EXTENSION_HEADER_LENGTH = 12;\nconst BINARY_EXTENSION_CHUNK_TYPES = {\n  JSON: 0x4E4F534A,\n  BIN: 0x004E4942,\n};\n\nconst EXTENSIONS = {\n  KHR_BINARY_GLTF: 'KHR_binary_glTF',\n  KHR_LIGHTS: 'KHR_lights',\n  KHR_MATERIALS_COMMON: 'KHR_materials_common',\n  KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS: 'KHR_materials_pbrSpecularGlossiness',\n};\n\nfunction GLTFLoader(manager) {\n\n  this.manager = (manager !== undefined) ? manager : DefaultLoadingManager;\n\n}\n\nGLTFLoader.prototype = {\n\n  constructor: GLTFLoader,\n\n  crossOrigin: 'Anonymous',\n\n  load(url, onLoad, onProgress, onError) {\n\n    const scope = this;\n\n    const path = this.path && (typeof this.path === 'string') ? this.path : Loader.prototype.extractUrlBase(url);\n\n    const loader = new FileLoader(scope.manager);\n\n    loader.setResponseType('arraybuffer');\n\n    loader.load(url, function(data) {\n\n      try {\n\n        scope.parse(data, path, onLoad, onError);\n\n      } catch (e) {\n\n        // For SyntaxError or TypeError, return a generic failure message.\n        onError(e.constructor === Error ? e : new Error('GLTFLoader: Unable to parse model.'));\n\n      }\n\n    }, onProgress, onError);\n\n  },\n\n  setCrossOrigin(value) {\n\n    this.crossOrigin = value;\n\n  },\n\n  setPath(value) {\n\n    this.path = value;\n\n  },\n\n  parse(data, path, onLoad, onError) {\n\n    let content;\n    const extensions = {};\n\n    const magic = convertUint8ArrayToString(new Uint8Array(data, 0, 4));\n\n    if (magic === BINARY_EXTENSION_HEADER_MAGIC) {\n\n      extensions[EXTENSIONS.KHR_BINARY_GLTF] = new GLTFBinaryExtension(data);\n      content = extensions[EXTENSIONS.KHR_BINARY_GLTF].content;\n\n    } else {\n\n      content = convertUint8ArrayToString(new Uint8Array(data));\n\n    }\n\n    const json = JSON.parse(content);\n\n    if (json.asset === undefined || json.asset.version[0] < 2) {\n\n      onError(new Error('GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.'));\n      return;\n\n    }\n\n    if (json.extensionsUsed) {\n\n      if (json.extensionsUsed.indexOf(EXTENSIONS.KHR_LIGHTS) >= 0) {\n\n        extensions[EXTENSIONS.KHR_LIGHTS] = new GLTFLightsExtension(json);\n\n      }\n\n      if (json.extensionsUsed.indexOf(EXTENSIONS.KHR_MATERIALS_COMMON) >= 0) {\n\n        extensions[EXTENSIONS.KHR_MATERIALS_COMMON] = new GLTFMaterialsCommonExtension(json);\n\n      }\n\n      if (json.extensionsUsed.indexOf(EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS) >= 0) {\n\n        extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS] = new GLTFMaterialsPbrSpecularGlossinessExtension();\n\n      }\n\n    }\n\n    console.time('GLTFLoader');\n\n    const parser = new GLTFParser(json, extensions, {\n\n      path: path || this.path,\n      crossOrigin: this.crossOrigin,\n\n    });\n\n    parser.parse(function(scene, scenes, cameras, animations) {\n\n      console.timeEnd('GLTFLoader');\n\n      const glTF = {\n        scene,\n        scenes,\n        cameras,\n        animations,\n      };\n\n      onLoad(glTF);\n\n    }, onError);\n\n  },\n\n};\n\n/* GLTFREGISTRY */\n\nfunction GLTFRegistry() {\n\n  let objects = {};\n\n  return {\n\n    get(key) {\n\n      return objects[key];\n\n    },\n\n    add(key, object) {\n\n      objects[key] = object;\n\n    },\n\n    remove(key) {\n\n      delete objects[key];\n\n    },\n\n    removeAll() {\n\n      objects = {};\n\n    },\n\n    update(scene, camera) {\n\n      for (const name in objects) {\n\n        const object = objects[name];\n\n        if (object.update) {\n\n          object.update(scene, camera);\n\n        }\n\n      }\n\n    },\n\n  };\n\n}\n\n/**\n * Lights Extension\n *\n * Specification: PENDING\n * @param {Object} json config\n */\nfunction GLTFLightsExtension(json) {\n\n  this.name = EXTENSIONS.KHR_LIGHTS;\n\n  this.lights = {};\n\n  const extension = (json.extensions && json.extensions[EXTENSIONS.KHR_LIGHTS]) || {};\n  const lights = extension.lights || {};\n\n  for (const lightId in lights) {\n\n    const light = lights[lightId];\n    let lightNode;\n\n    const color = new Color().fromArray(light.color);\n\n    switch (light.type) {\n\n      case 'directional':\n        lightNode = new DirectionalLight(color);\n        lightNode.position.set(0, 0, 1);\n        break;\n\n      case 'point':\n        lightNode = new PointLight(color);\n        break;\n\n      case 'spot':\n        lightNode = new SpotLight(color);\n        lightNode.position.set(0, 0, 1);\n        break;\n\n      case 'ambient':\n        lightNode = new AmbientLight(color);\n        break;\n\n      default :\n        break;\n\n    }\n\n    if (lightNode) {\n\n      if (light.constantAttenuation !== undefined) {\n\n        lightNode.intensity = light.constantAttenuation;\n\n      }\n\n      if (light.linearAttenuation !== undefined) {\n\n        lightNode.distance = 1 / light.linearAttenuation;\n\n      }\n\n      if (light.quadraticAttenuation !== undefined) {\n\n        lightNode.decay = light.quadraticAttenuation;\n\n      }\n\n      if (light.fallOffAngle !== undefined) {\n\n        lightNode.angle = light.fallOffAngle;\n\n      }\n\n      if (light.fallOffExponent !== undefined) {\n\n        console.warn('GLTFLoader:: light.fallOffExponent not currently supported.');\n\n      }\n\n      lightNode.name = light.name || ('light_' + lightId);\n      this.lights[lightId] = lightNode;\n\n    }\n\n  }\n\n}\n\n/**\n * Common Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/Khronos/KHR_materials_common\n */\nfunction GLTFMaterialsCommonExtension() {\n\n  this.name = EXTENSIONS.KHR_MATERIALS_COMMON;\n\n}\n\nGLTFMaterialsCommonExtension.prototype.getMaterialType = function(material) {\n\n  const khrMaterial = material.extensions[this.name];\n\n  switch (khrMaterial.type) {\n\n    case 'commonBlinn':\n    case 'commonPhong':\n      return MeshPhongMaterial;\n\n    case 'commonLambert':\n      return MeshLambertMaterial;\n\n    case 'commonConstant':\n    default:\n      return MeshBasicMaterial;\n\n  }\n\n};\n\nGLTFMaterialsCommonExtension.prototype.extendParams = function(materialParams, material, parser) {\n\n  const khrMaterial = material.extensions[this.name];\n\n  const pending = [];\n\n  const keys = [];\n\n  // TODO: Currently ignored: 'ambientFactor', 'ambientTexture'\n  switch (khrMaterial.type) {\n\n    case 'commonBlinn':\n    case 'commonPhong':\n      keys.push('diffuseFactor', 'diffuseTexture', 'specularFactor', 'specularTexture', 'shininessFactor');\n      break;\n\n    case 'commonLambert':\n      keys.push('diffuseFactor', 'diffuseTexture');\n      break;\n\n    case 'commonConstant':\n    default:\n      break;\n\n  }\n\n  const materialValues = {};\n\n  keys.forEach(function(v) {\n\n    if (khrMaterial[v] !== undefined) materialValues[v] = khrMaterial[v];\n\n  });\n\n  if (materialValues.diffuseFactor !== undefined) {\n\n    materialParams.color = new Color().fromArray(materialValues.diffuseFactor);\n    materialParams.opacity = materialValues.diffuseFactor[3];\n\n  }\n\n  if (materialValues.diffuseTexture !== undefined) {\n\n    pending.push(parser.assignTexture(materialParams, 'map', materialValues.diffuseTexture.index));\n\n  }\n\n  if (materialValues.specularFactor !== undefined) {\n\n    materialParams.specular = new Color().fromArray(materialValues.specularFactor);\n\n  }\n\n  if (materialValues.specularTexture !== undefined) {\n\n    pending.push(parser.assignTexture(materialParams, 'specularMap', materialValues.specularTexture.index));\n\n  }\n\n  if (materialValues.shininessFactor !== undefined) {\n\n    materialParams.shininess = materialValues.shininessFactor;\n\n  }\n\n  return Promise.all(pending);\n\n};\n\n/* BINARY EXTENSION */\n\nfunction GLTFBinaryExtension(data) {\n\n  this.name = EXTENSIONS.KHR_BINARY_GLTF;\n  this.content = null;\n  this.body = null;\n\n  const headerView = new DataView(data, 0, BINARY_EXTENSION_HEADER_LENGTH);\n\n  this.header = {\n    magic: convertUint8ArrayToString(new Uint8Array(data.slice(0, 4))),\n    version: headerView.getUint32(4, true),\n    length: headerView.getUint32(8, true),\n  };\n\n  if (this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC) {\n\n    throw new Error('GLTFLoader: Unsupported glTF-Binary header.');\n\n  } else if (this.header.version < 2.0) {\n\n    throw new Error('GLTFLoader: Legacy binary file detected. Use GLTFLoader instead.');\n\n  }\n\n  const chunkView = new DataView(data, BINARY_EXTENSION_HEADER_LENGTH);\n  let chunkIndex = 0;\n\n  while (chunkIndex < chunkView.byteLength) {\n\n    const chunkLength = chunkView.getUint32(chunkIndex, true);\n    chunkIndex += 4;\n\n    const chunkType = chunkView.getUint32(chunkIndex, true);\n    chunkIndex += 4;\n\n    if (chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON) {\n\n      const contentArray = new Uint8Array(data, BINARY_EXTENSION_HEADER_LENGTH + chunkIndex, chunkLength);\n      this.content = convertUint8ArrayToString(contentArray);\n\n    } else if (chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN) {\n\n      const byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;\n      this.body = data.slice(byteOffset, byteOffset + chunkLength);\n\n    }\n\n    // Clients must ignore chunks with unknown types.\n\n    chunkIndex += chunkLength;\n\n  }\n\n  if (this.content === null) {\n\n    throw new Error('GLTFLoader: JSON content not found.');\n\n  }\n\n}\n\n/**\n * Specular-Glossiness Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/Khronos/KHR_materials_pbrSpecularGlossiness\n * @return {Object} extension\n */\nfunction GLTFMaterialsPbrSpecularGlossinessExtension() {\n\n  return {\n\n    name: EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,\n\n    getMaterialType() {\n\n      return ShaderMaterial;\n\n    },\n\n    extendParams(params, material, parser) {\n\n      const pbrSpecularGlossiness = material.extensions[this.name];\n\n      const shader = ShaderLib.standard;\n\n      const uniforms = UniformsUtils.clone(shader.uniforms);\n\n      const specularMapParsFragmentChunk = [\n        '#ifdef USE_SPECULARMAP',\n        '\tuniform sampler2D specularMap;',\n        '#endif',\n      ].join('\\n');\n\n      const glossinessMapParsFragmentChunk = [\n        '#ifdef USE_GLOSSINESSMAP',\n        '\tuniform sampler2D glossinessMap;',\n        '#endif',\n      ].join('\\n');\n\n      const specularMapFragmentChunk = [\n        'vec3 specularFactor = specular;',\n        '#ifdef USE_SPECULARMAP',\n        '\tvec4 texelSpecular = texture2D( specularMap, vUv );',\n        '\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture',\n        '\tspecularFactor *= texelSpecular.rgb;',\n        '#endif',\n      ].join('\\n');\n\n      const glossinessMapFragmentChunk = [\n        'float glossinessFactor = glossiness;',\n        '#ifdef USE_GLOSSINESSMAP',\n        '\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );',\n        '\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture',\n        '\tglossinessFactor *= texelGlossiness.a;',\n        '#endif',\n      ].join('\\n');\n\n      const lightPhysicalFragmentChunk = [\n        'PhysicalMaterial material;',\n        'material.diffuseColor = diffuseColor.rgb;',\n        'material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );',\n        'material.specularColor = specularFactor.rgb;',\n      ].join('\\n');\n\n      const fragmentShader = shader.fragmentShader\n        .replace('#include <specularmap_fragment>', '')\n        .replace('uniform float roughness;', 'uniform vec3 specular;')\n        .replace('uniform float metalness;', 'uniform float glossiness;')\n        .replace('#include <roughnessmap_pars_fragment>', specularMapParsFragmentChunk)\n        .replace('#include <metalnessmap_pars_fragment>', glossinessMapParsFragmentChunk)\n        .replace('#include <roughnessmap_fragment>', specularMapFragmentChunk)\n        .replace('#include <metalnessmap_fragment>', glossinessMapFragmentChunk)\n        .replace('#include <lights_physical_fragment>', lightPhysicalFragmentChunk);\n\n      delete uniforms.roughness;\n      delete uniforms.metalness;\n      delete uniforms.roughnessMap;\n      delete uniforms.metalnessMap;\n\n      uniforms.specular = {\n        value: new Color().setHex(0x111111),\n      };\n      uniforms.glossiness = {\n        value: 0.5,\n      };\n      uniforms.specularMap = {\n        value: null,\n      };\n      uniforms.glossinessMap = {\n        value: null,\n      };\n\n      params.vertexShader = shader.vertexShader;\n      params.fragmentShader = fragmentShader;\n      params.uniforms = uniforms;\n      params.defines = {\n        STANDARD: '',\n      };\n\n      params.color = new Color(1.0, 1.0, 1.0);\n      params.opacity = 1.0;\n\n      const pending = [];\n\n      if (Array.isArray(pbrSpecularGlossiness.diffuseFactor)) {\n\n        const array = pbrSpecularGlossiness.diffuseFactor;\n\n        params.color.fromArray(array);\n        params.opacity = array[3];\n\n      }\n\n      if (pbrSpecularGlossiness.diffuseTexture !== undefined) {\n\n        pending.push(parser.assignTexture(params, 'map', pbrSpecularGlossiness.diffuseTexture.index));\n\n      }\n\n      params.emissive = new Color(0.0, 0.0, 0.0);\n      params.glossiness = pbrSpecularGlossiness.glossinessFactor !== undefined ? pbrSpecularGlossiness.glossinessFactor : 1.0;\n      params.specular = new Color(1.0, 1.0, 1.0);\n\n      if (Array.isArray(pbrSpecularGlossiness.specularFactor)) {\n\n        params.specular.fromArray(pbrSpecularGlossiness.specularFactor);\n\n      }\n\n      if (pbrSpecularGlossiness.specularGlossinessTexture !== undefined) {\n\n        const specGlossIndex = pbrSpecularGlossiness.specularGlossinessTexture.index;\n        pending.push(parser.assignTexture(params, 'glossinessMap', specGlossIndex));\n        pending.push(parser.assignTexture(params, 'specularMap', specGlossIndex));\n\n      }\n\n      return Promise.all(pending);\n\n    },\n\n    createMaterial(params) {\n\n      // setup material properties based on MeshStandardMaterial for Specular-Glossiness\n\n      const material = new ShaderMaterial({\n        defines: params.defines,\n        vertexShader: params.vertexShader,\n        fragmentShader: params.fragmentShader,\n        uniforms: params.uniforms,\n        fog: true,\n        lights: true,\n        opacity: params.opacity,\n        transparent: params.transparent,\n      });\n\n      material.isGLTFSpecularGlossinessMaterial = true;\n\n      material.color = params.color;\n\n      material.map = params.map === undefined ? null : params.map;\n\n      material.lightMap = null;\n      material.lightMapIntensity = 1.0;\n\n      material.aoMap = params.aoMap === undefined ? null : params.aoMap;\n      material.aoMapIntensity = 1.0;\n\n      material.emissive = params.emissive;\n      material.emissiveIntensity = 1.0;\n      material.emissiveMap = params.emissiveMap === undefined ? null : params.emissiveMap;\n\n      material.bumpMap = params.bumpMap === undefined ? null : params.bumpMap;\n      material.bumpScale = 1;\n\n      material.normalMap = params.normalMap === undefined ? null : params.normalMap;\n      material.normalScale = new Vector2(1, 1);\n\n      material.displacementMap = null;\n      material.displacementScale = 1;\n      material.displacementBias = 0;\n\n      material.specularMap = params.specularMap === undefined ? null : params.specularMap;\n      material.specular = params.specular;\n\n      material.glossinessMap = params.glossinessMap === undefined ? null : params.glossinessMap;\n      material.glossiness = params.glossiness;\n\n      material.alphaMap = null;\n\n      material.envMap = params.envMap === undefined ? null : params.envMap;\n      material.envMapIntensity = 1.0;\n\n      material.refractionRatio = 0.98;\n\n      material.extensions.derivatives = true;\n\n      return material;\n\n    },\n\n    // Here's based on refreshUniformsCommon() and refreshUniformsStandard() in WebGLRenderer.\n    refreshUniforms(renderer, scene, camera, geometry, material) {\n\n      const uniforms = material.uniforms;\n      const defines = material.defines;\n\n      uniforms.opacity.value = material.opacity;\n\n      uniforms.diffuse.value.copy(material.color);\n      uniforms.emissive.value.copy(material.emissive).multiplyScalar(material.emissiveIntensity);\n\n      uniforms.map.value = material.map;\n      uniforms.specularMap.value = material.specularMap;\n      uniforms.alphaMap.value = material.alphaMap;\n\n      uniforms.lightMap.value = material.lightMap;\n      uniforms.lightMapIntensity.value = material.lightMapIntensity;\n\n      uniforms.aoMap.value = material.aoMap;\n      uniforms.aoMapIntensity.value = material.aoMapIntensity;\n\n      // uv repeat and offset setting priorities\n      // 1. color map\n      // 2. specular map\n      // 3. normal map\n      // 4. bump map\n      // 5. alpha map\n      // 6. emissive map\n\n      let uvScaleMap;\n\n      if (material.map) {\n\n        uvScaleMap = material.map;\n\n      } else if (material.specularMap) {\n\n        uvScaleMap = material.specularMap;\n\n      } else if (material.displacementMap) {\n\n        uvScaleMap = material.displacementMap;\n\n      } else if (material.normalMap) {\n\n        uvScaleMap = material.normalMap;\n\n      } else if (material.bumpMap) {\n\n        uvScaleMap = material.bumpMap;\n\n      } else if (material.glossinessMap) {\n\n        uvScaleMap = material.glossinessMap;\n\n      } else if (material.alphaMap) {\n\n        uvScaleMap = material.alphaMap;\n\n      } else if (material.emissiveMap) {\n\n        uvScaleMap = material.emissiveMap;\n\n      }\n\n      if (uvScaleMap !== undefined) {\n\n        // backwards compatibility\n        if (uvScaleMap.isWebGLRenderTarget) {\n\n          uvScaleMap = uvScaleMap.texture;\n\n        }\n\n        const offset = uvScaleMap.offset;\n        const repeat = uvScaleMap.repeat;\n\n        uniforms.offsetRepeat.value.set(offset.x, offset.y, repeat.x, repeat.y);\n\n      }\n\n      uniforms.envMap.value = material.envMap;\n      uniforms.envMapIntensity.value = material.envMapIntensity;\n      uniforms.flipEnvMap.value = (material.envMap && material.envMap.isCubeTexture) ? -1 : 1;\n\n      uniforms.refractionRatio.value = material.refractionRatio;\n\n      uniforms.specular.value.copy(material.specular);\n      uniforms.glossiness.value = material.glossiness;\n\n      uniforms.glossinessMap.value = material.glossinessMap;\n\n      uniforms.emissiveMap.value = material.emissiveMap;\n      uniforms.bumpMap.value = material.bumpMap;\n      uniforms.normalMap.value = material.normalMap;\n\n      uniforms.displacementMap.value = material.displacementMap;\n      uniforms.displacementScale.value = material.displacementScale;\n      uniforms.displacementBias.value = material.displacementBias;\n\n      if (uniforms.glossinessMap.value !== null && defines.USE_GLOSSINESSMAP === undefined) {\n\n        defines.USE_GLOSSINESSMAP = '';\n        // set USE_ROUGHNESSMAP to enable vUv\n        defines.USE_ROUGHNESSMAP = '';\n\n      }\n\n      if (uniforms.glossinessMap.value === null && defines.USE_GLOSSINESSMAP !== undefined) {\n\n        delete defines.USE_GLOSSINESSMAP;\n        delete defines.USE_ROUGHNESSMAP;\n\n      }\n\n    },\n\n  };\n\n}\n\n/** *******************************/\n/** ******** INTERNALS ************/\n/** *******************************/\n\n/* CONSTANTS */\n\nconst WEBGL_CONSTANTS = {\n  FLOAT: 5126,\n  // FLOAT_MAT2: 35674,\n  FLOAT_MAT3: 35675,\n  FLOAT_MAT4: 35676,\n  FLOAT_VEC2: 35664,\n  FLOAT_VEC3: 35665,\n  FLOAT_VEC4: 35666,\n  LINEAR: 9729,\n  REPEAT: 10497,\n  SAMPLER_2D: 35678,\n  POINTS: 0,\n  LINES: 1,\n  LINE_LOOP: 2,\n  LINE_STRIP: 3,\n  TRIANGLES: 4,\n  TRIANGLE_STRIP: 5,\n  TRIANGLE_FAN: 6,\n  UNSIGNED_BYTE: 5121,\n  UNSIGNED_SHORT: 5123,\n};\n\n// const WEBGL_TYPE = {\n//   5126: Number,\n//   // 35674: Matrix2,\n//   35675: Matrix3,\n//   35676: Matrix4,\n//   35664: Vector2,\n//   35665: Vector3,\n//   35666: Vector4,\n//   35678: Texture,\n// };\n\nconst WEBGL_COMPONENT_TYPES = {\n  5120: Int8Array,\n  5121: Uint8Array,\n  5122: Int16Array,\n  5123: Uint16Array,\n  5125: Uint32Array,\n  5126: Float32Array,\n};\n\nconst WEBGL_FILTERS = {\n  9728: NearestFilter,\n  9729: LinearFilter,\n  9984: NearestMipMapNearestFilter,\n  9985: LinearMipMapNearestFilter,\n  9986: NearestMipMapLinearFilter,\n  9987: LinearMipMapLinearFilter,\n};\n\nconst WEBGL_WRAPPINGS = {\n  33071: ClampToEdgeWrapping,\n  33648: MirroredRepeatWrapping,\n  10497: RepeatWrapping,\n};\n\nconst WEBGL_TEXTURE_FORMATS = {\n  6406: AlphaFormat,\n  6407: RGBFormat,\n  6408: RGBAFormat,\n  6409: LuminanceFormat,\n  6410: LuminanceAlphaFormat,\n};\n\nconst WEBGL_TEXTURE_DATATYPES = {\n  5121: UnsignedByteType,\n  32819: UnsignedShort4444Type,\n  32820: UnsignedShort5551Type,\n  33635: UnsignedShort565Type,\n};\n\n// const WEBGL_SIDES = {\n//   1028: BackSide, // Culling front\n//   1029: FrontSide, // Culling back\n//   // 1032: NoSide   // Culling front and back, what to do?\n// };\n\n// const WEBGL_DEPTH_FUNCS = {\n//   512: NeverDepth,\n//   513: LessDepth,\n//   514: EqualDepth,\n//   515: LessEqualDepth,\n//   516: GreaterEqualDepth,\n//   517: NotEqualDepth,\n//   518: GreaterEqualDepth,\n//   519: AlwaysDepth,\n// };\n\n// const WEBGL_BLEND_EQUATIONS = {\n//   32774: AddEquation,\n//   32778: SubtractEquation,\n//   32779: ReverseSubtractEquation,\n// };\n\n// const WEBGL_BLEND_FUNCS = {\n//   0: ZeroFactor,\n//   1: OneFactor,\n//   768: SrcColorFactor,\n//   769: OneMinusSrcColorFactor,\n//   770: SrcAlphaFactor,\n//   771: OneMinusSrcAlphaFactor,\n//   772: DstAlphaFactor,\n//   773: OneMinusDstAlphaFactor,\n//   774: DstColorFactor,\n//   775: OneMinusDstColorFactor,\n//   776: SrcAlphaSaturateFactor,\n//   // The followings are not supported by js yet\n//   // 32769: CONSTANT_COLOR,\n//   // 32770: ONE_MINUS_CONSTANT_COLOR,\n//   // 32771: CONSTANT_ALPHA,\n//   // 32772: ONE_MINUS_CONSTANT_COLOR\n// };\n\nconst WEBGL_TYPE_SIZES = {\n  SCALAR: 1,\n  VEC2: 2,\n  VEC3: 3,\n  VEC4: 4,\n  MAT2: 4,\n  MAT3: 9,\n  MAT4: 16,\n};\n\nconst PATH_PROPERTIES = {\n  scale: 'scale',\n  translation: 'position',\n  rotation: 'quaternion',\n  weights: 'morphTargetInfluences',\n};\n\nconst INTERPOLATION = {\n  CATMULLROMSPLINE: InterpolateSmooth,\n  CUBICSPLINE: InterpolateSmooth,\n  LINEAR: InterpolateLinear,\n  STEP: InterpolateDiscrete,\n};\n\n// const STATES_ENABLES = {\n//   2884: 'CULL_FACE',\n//   2929: 'DEPTH_TEST',\n//   3042: 'BLEND',\n//   3089: 'SCISSOR_TEST',\n//   32823: 'POLYGON_OFFSET_FILL',\n//   32926: 'SAMPLE_ALPHA_TO_COVERAGE',\n// };\n\nconst ALPHA_MODES = {\n  OPAQUE: 'OPAQUE',\n  MASK: 'MASK',\n  BLEND: 'BLEND',\n};\n\n/* UTILITY FUNCTIONS */\n\nfunction _each(object, callback, thisObj) {\n\n  if (!object) {\n    return Promise.resolve();\n  }\n\n  let results;\n  const fns = [];\n\n  if (Object.prototype.toString.call(object) === '[object Array]') {\n\n    results = [];\n\n    const length = object.length;\n\n    for (let idx = 0; idx < length; idx++) {\n\n      const value = callback.call(thisObj || this, object[idx], idx);\n\n      if (value) {\n\n        fns.push(value);\n\n        if (value instanceof Promise) {\n          /* eslint no-loop-func: 0 */\n          value.then(function(key, value) {\n\n            results[key] = value;\n\n          }.bind(this, idx));\n\n        } else {\n\n          results[idx] = value;\n\n        }\n\n      }\n\n    }\n\n  } else {\n\n    results = {};\n\n    for (const key in object) {\n\n      if (object.hasOwnProperty(key)) {\n\n        const value = callback.call(thisObj || this, object[key], key);\n\n        if (value) {\n\n          fns.push(value);\n\n          if (value instanceof Promise) {\n\n            value.then(function(key, value) {\n\n              results[key] = value;\n\n            }.bind(this, key));\n\n          } else {\n\n            results[key] = value;\n\n          }\n\n        }\n\n      }\n\n    }\n\n  }\n\n  return Promise.all(fns).then(function() {\n\n    return results;\n\n  });\n\n}\n\nfunction resolveURL(url, path) {\n\n  // Invalid URL\n  if (typeof url !== 'string' || url === '') { return ''; }\n\n  // Absolute URL http://,https://,//\n  if (/^(https?:)?\\/\\//i.test(url)) {\n\n    return url;\n\n  }\n\n  // Data URI\n  if (/^data:.*,.*$/i.test(url)) {\n\n    return url;\n\n  }\n\n  // Blob URL\n  if (/^blob:.*$/i.test(url)) {\n\n    return url;\n\n  }\n\n  // Relative URL\n  return (path || '') + url;\n\n}\n\nfunction convertUint8ArrayToString(array) {\n\n  if (window.TextDecoder !== undefined) {\n\n    return new TextDecoder().decode(array);\n\n  }\n\n  // Avoid the String.fromCharCode.apply(null, array) shortcut, which\n  // throws a \"maximum call stack size exceeded\" error for large arrays.\n\n  let s = '';\n\n  for (let i = 0, il = array.length; i < il; i++) {\n\n    s += String.fromCharCode(array[i]);\n\n  }\n\n  return s;\n\n}\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\n * @return {MeshStandardMaterial} material\n */\nfunction createDefaultMaterial() {\n\n  return new MeshStandardMaterial({\n    color: 0xFFFFFF,\n    emissive: 0x000000,\n    metalness: 1,\n    roughness: 1,\n    transparent: false,\n    depthTest: true,\n    side: FrontSide,\n  });\n\n}\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\n * @param {Mesh} mesh mesh\n * @param {GLTF.Mesh} meshDef meshDef\n * @param {GLTF.Primitive} primitiveDef primitiveDef\n * @param {Object} dependencies dependencies\n */\nfunction addMorphTargets(mesh, meshDef, primitiveDef, dependencies) {\n\n  const geometry = mesh.geometry;\n  const material = mesh.material;\n\n  const targets = primitiveDef.targets;\n  const morphAttributes = geometry.morphAttributes;\n\n  morphAttributes.position = [];\n  morphAttributes.normal = [];\n\n  material.morphTargets = true;\n\n  for (let i = 0, il = targets.length; i < il; i++) {\n\n    const target = targets[i];\n    const attributeName = 'morphTarget' + i;\n\n    let positionAttribute,\n      normalAttribute;\n\n    if (target.POSITION !== undefined) {\n\n      // js morph formula is\n      //   position\n      //     + weight0 * ( morphTarget0 - position )\n      //     + weight1 * ( morphTarget1 - position )\n      //     ...\n      // while the glTF one is\n      //   position\n      //     + weight0 * morphTarget0\n      //     + weight1 * morphTarget1\n      //     ...\n      // then adding position to morphTarget.\n      // So morphTarget value will depend on mesh's position, then cloning attribute\n      // for the case if attribute is shared among two or more meshes.\n\n      positionAttribute = dependencies.accessors[target.POSITION].clone();\n      const position = geometry.attributes.position;\n\n      for (let j = 0, jl = positionAttribute.count; j < jl; j++) {\n\n        positionAttribute.setXYZ(\n          j,\n          positionAttribute.getX(j) + position.getX(j),\n          positionAttribute.getY(j) + position.getY(j),\n          positionAttribute.getZ(j) + position.getZ(j)\n        );\n\n      }\n\n    } else {\n\n      // Copying the original position not to affect the final position.\n      // See the formula above.\n      positionAttribute = geometry.attributes.position.clone();\n\n    }\n\n    if (target.NORMAL !== undefined) {\n\n      material.morphNormals = true;\n\n      // see target.POSITION's comment\n\n      normalAttribute = dependencies.accessors[target.NORMAL].clone();\n      const normal = geometry.attributes.normal;\n\n      for (let j = 0, jl = normalAttribute.count; j < jl; j++) {\n\n        normalAttribute.setXYZ(\n          j,\n          normalAttribute.getX(j) + normal.getX(j),\n          normalAttribute.getY(j) + normal.getY(j),\n          normalAttribute.getZ(j) + normal.getZ(j)\n        );\n\n      }\n\n    } else {\n\n      normalAttribute = geometry.attributes.normal.clone();\n\n    }\n\n    if (target.TANGENT !== undefined) {\n\n      // TODO: implement\n\n    }\n\n    positionAttribute.name = attributeName;\n    normalAttribute.name = attributeName;\n\n    morphAttributes.position.push(positionAttribute);\n    morphAttributes.normal.push(normalAttribute);\n\n  }\n\n  mesh.updateMorphTargets();\n\n  if (meshDef.weights !== undefined) {\n\n    for (let i = 0, il = meshDef.weights.length; i < il; i++) {\n\n      mesh.morphTargetInfluences[i] = meshDef.weights[i];\n\n    }\n\n  }\n\n}\n\n/* GLTF PARSER */\n\nfunction GLTFParser(json, extensions, options) {\n\n  this.json = json || {};\n  this.extensions = extensions || {};\n  this.options = options || {};\n\n  // loader object cache\n  this.cache = new GLTFRegistry();\n\n}\n\nGLTFParser.prototype._withDependencies = function(dependencies) {\n\n  const _dependencies = {};\n\n  for (let i = 0; i < dependencies.length; i++) {\n\n    const dependency = dependencies[i];\n    const fnName = 'load' + dependency.charAt(0).toUpperCase() + dependency.slice(1);\n\n    const cached = this.cache.get(dependency);\n\n    if (cached !== undefined) {\n\n      _dependencies[dependency] = cached;\n\n    } else if (this[fnName]) {\n\n      const fn = this[fnName]();\n      this.cache.add(dependency, fn);\n\n      _dependencies[dependency] = fn;\n\n    }\n\n  }\n\n  return _each(_dependencies, function(dependency) {\n\n    return dependency;\n\n  });\n\n};\n\nGLTFParser.prototype.parse = function(onLoad, onError) {\n\n  const json = this.json;\n\n  // Clear the loader cache\n  this.cache.removeAll();\n\n  // Fire the callback on complete\n  this._withDependencies([\n\n    'scenes',\n    'cameras',\n    'animations',\n\n  ]).then(function(dependencies) {\n\n    const scenes = [];\n\n    for (const name in dependencies.scenes) {\n\n      scenes.push(dependencies.scenes[name]);\n\n    }\n\n    const scene = json.scene !== undefined ? dependencies.scenes[json.scene] : scenes[0];\n\n    const cameras = [];\n\n    for (const name in dependencies.cameras) {\n\n      const camera = dependencies.cameras[name];\n      cameras.push(camera);\n\n    }\n\n    const animations = [];\n\n    for (const name in dependencies.animations) {\n\n      animations.push(dependencies.animations[name]);\n\n    }\n\n    onLoad(scene, scenes, cameras, animations);\n\n  }).catch(onError);\n\n};\n\n/**\n * Requests the specified dependency asynchronously, with caching.\n * @param {string} type type\n * @param {number} index index\n * @return {Promise<Object>} deps\n */\nGLTFParser.prototype.getDependency = function(type, index) {\n\n  const cacheKey = type + ':' + index;\n  let dependency = this.cache.get(cacheKey);\n\n  if (!dependency) {\n\n    const fnName = 'load' + type.charAt(0).toUpperCase() + type.slice(1);\n    dependency = this[fnName](index);\n    this.cache.add(cacheKey, dependency);\n\n  }\n\n  return dependency;\n\n};\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n * @param {number} bufferIndex bufferIndex\n * @return {Promise<ArrayBuffer>} buffer\n */\nGLTFParser.prototype.loadBuffer = function(bufferIndex) {\n\n  const bufferDef = this.json.buffers[bufferIndex];\n\n  if (bufferDef.type && bufferDef.type !== 'arraybuffer') {\n\n    throw new Error('GLTFLoader: %s buffer type is not supported.', bufferDef.type);\n\n  }\n\n  // If present, GLB container is required to be the first buffer.\n  if (bufferDef.uri === undefined && bufferIndex === 0) {\n\n    return Promise.resolve(this.extensions[EXTENSIONS.KHR_BINARY_GLTF].body);\n\n  }\n\n  const options = this.options;\n\n  return new Promise(function(resolve) {\n\n    const loader = new FileLoader();\n    loader.setResponseType('arraybuffer');\n    loader.load(resolveURL(bufferDef.uri, options.path), resolve);\n\n  });\n\n};\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n * @param {number} bufferViewIndex bufferViewIndex\n * @return {Promise<ArrayBuffer>} buffer\n */\nGLTFParser.prototype.loadBufferView = function(bufferViewIndex) {\n\n  const bufferViewDef = this.json.bufferViews[bufferViewIndex];\n\n  return this.getDependency('buffer', bufferViewDef.buffer).then(function(buffer) {\n\n    const byteLength = bufferViewDef.byteLength || 0;\n    const byteOffset = bufferViewDef.byteOffset || 0;\n    return buffer.slice(byteOffset, byteOffset + byteLength);\n\n  });\n\n};\n\nGLTFParser.prototype.loadAccessors = function() {\n\n  const parser = this;\n  const json = this.json;\n\n  return _each(json.accessors, function(accessor) {\n\n    return parser.getDependency('bufferView', accessor.bufferView).then(function(bufferView) {\n\n      const itemSize = WEBGL_TYPE_SIZES[accessor.type];\n      const TypedArray = WEBGL_COMPONENT_TYPES[accessor.componentType];\n\n      // For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\n      const elementBytes = TypedArray.BYTES_PER_ELEMENT;\n      const itemBytes = elementBytes * itemSize;\n      const byteStride = json.bufferViews[accessor.bufferView].byteStride;\n      let array;\n\n      // The buffer is not interleaved if the stride is the item size in bytes.\n      if (byteStride && byteStride !== itemBytes) {\n\n        // Use the full buffer if it's interleaved.\n        array = new TypedArray(bufferView);\n\n        // Integer parameters to IB/IBA are in array elements, not bytes.\n        const ib = new InterleavedBuffer(array, byteStride / elementBytes);\n\n        return new InterleavedBufferAttribute(ib, itemSize, accessor.byteOffset / elementBytes);\n\n      }\n\n      array = new TypedArray(bufferView, accessor.byteOffset, accessor.count * itemSize);\n\n      return new BufferAttribute(array, itemSize);\n\n\n    });\n\n  });\n\n};\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\n * @param {number} textureIndex textureIndex\n * @return {Promise<Texture>} Texture\n */\nGLTFParser.prototype.loadTexture = function(textureIndex) {\n\n  const parser = this;\n  const json = this.json;\n  const options = this.options;\n\n  const URL = window.URL || window.webkitURL;\n\n  const textureDef = json.textures[textureIndex];\n  const source = json.images[textureDef.source];\n  let sourceURI = source.uri;\n  let isObjectURL = false;\n\n  if (source.bufferView !== undefined) {\n\n    // Load binary image data from bufferView, if provided.\n\n    sourceURI = parser.getDependency('bufferView', source.bufferView)\n      .then(function(bufferView) {\n\n        isObjectURL = true;\n        const blob = new Blob([ bufferView ], {\n          type: source.mimeType,\n        });\n        sourceURI = URL.createObjectURL(blob);\n        return sourceURI;\n\n      });\n\n  }\n\n  return Promise.resolve(sourceURI).then(function(sourceURI) {\n\n    // Load Texture resource.\n\n    const textureLoader = Loader.Handlers.get(sourceURI) || new TextureLoader();\n    textureLoader.setCrossOrigin(options.crossOrigin);\n\n    return new Promise(function(resolve, reject) {\n\n      textureLoader.load(resolveURL(sourceURI, options.path), resolve, undefined, reject);\n\n    });\n\n  }).then(function(texture) {\n\n    // Clean up resources and configure Texture.\n\n    if (isObjectURL !== undefined) {\n\n      URL.revokeObjectURL(sourceURI);\n\n    }\n\n    texture.flipY = false;\n\n    if (textureDef.name !== undefined) texture.name = textureDef.name;\n\n    texture.format = textureDef.format !== undefined ? WEBGL_TEXTURE_FORMATS[textureDef.format] : RGBAFormat;\n\n    if (textureDef.internalFormat !== undefined && texture.format !== WEBGL_TEXTURE_FORMATS[textureDef.internalFormat]) {\n\n      console.warn('GLTFLoader: js does not support texture internalFormat which is different from texture format. ' +\n        'internalFormat will be forced to be the same value as format.');\n\n    }\n\n    texture.type = textureDef.type !== undefined ? WEBGL_TEXTURE_DATATYPES[textureDef.type] : UnsignedByteType;\n\n    const samplers = json.samplers || {};\n    const sampler = samplers[textureDef.sampler] || {};\n\n    texture.magFilter = WEBGL_FILTERS[sampler.magFilter] || LinearFilter;\n    texture.minFilter = WEBGL_FILTERS[sampler.minFilter] || LinearMipMapLinearFilter;\n    texture.wrapS = WEBGL_WRAPPINGS[sampler.wrapS] || RepeatWrapping;\n    texture.wrapT = WEBGL_WRAPPINGS[sampler.wrapT] || RepeatWrapping;\n\n    return texture;\n\n  });\n\n};\n\n/**\n * Asynchronously assigns a texture to the given material parameters.\n * @param {Object} materialParams materialParams\n * @param {string} textureName textureName\n * @param {number} textureIndex textureIndex\n * @return {Promise} Promise\n */\nGLTFParser.prototype.assignTexture = function(materialParams, textureName, textureIndex) {\n\n  return this.getDependency('texture', textureIndex).then(function(texture) {\n\n    materialParams[textureName] = texture;\n\n  });\n\n};\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\n * @return {Promise<Array<Material>>} Material\n */\nGLTFParser.prototype.loadMaterials = function() {\n\n  const parser = this;\n  const json = this.json;\n  const extensions = this.extensions;\n\n  return _each(json.materials, function(material) {\n\n    let materialType;\n    const materialParams = {};\n    const materialExtensions = material.extensions || {};\n\n    const pending = [];\n\n    if (materialExtensions[EXTENSIONS.KHR_MATERIALS_COMMON]) {\n\n      const khcExtension = extensions[EXTENSIONS.KHR_MATERIALS_COMMON];\n      materialType = khcExtension.getMaterialType(material);\n      pending.push(khcExtension.extendParams(materialParams, material, parser));\n\n    } else if (materialExtensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]) {\n\n      const sgExtension = extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];\n      materialType = sgExtension.getMaterialType(material);\n      pending.push(sgExtension.extendParams(materialParams, material, parser));\n\n    } else if (material.pbrMetallicRoughness !== undefined) {\n\n      // Specification:\n      // https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\n\n      materialType = MeshStandardMaterial;\n\n      const metallicRoughness = material.pbrMetallicRoughness;\n\n      materialParams.color = new Color(1.0, 1.0, 1.0);\n      materialParams.opacity = 1.0;\n\n      if (Array.isArray(metallicRoughness.baseColorFactor)) {\n\n        const array = metallicRoughness.baseColorFactor;\n\n        materialParams.color.fromArray(array);\n        materialParams.opacity = array[3];\n\n      }\n\n      if (metallicRoughness.baseColorTexture !== undefined) {\n\n        pending.push(parser.assignTexture(materialParams, 'map', metallicRoughness.baseColorTexture.index));\n\n      }\n\n      materialParams.metalness = metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0;\n      materialParams.roughness = metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0;\n\n      if (metallicRoughness.metallicRoughnessTexture !== undefined) {\n\n        const textureIndex = metallicRoughness.metallicRoughnessTexture.index;\n        pending.push(parser.assignTexture(materialParams, 'metalnessMap', textureIndex));\n        pending.push(parser.assignTexture(materialParams, 'roughnessMap', textureIndex));\n\n      }\n\n    } else {\n\n      materialType = MeshPhongMaterial;\n\n    }\n\n    if (material.doubleSided === true) {\n\n      materialParams.side = DoubleSide;\n\n    }\n\n    const alphaMode = material.alphaMode || ALPHA_MODES.OPAQUE;\n\n    if (alphaMode !== ALPHA_MODES.OPAQUE) {\n\n      materialParams.transparent = true;\n\n    } else {\n\n      materialParams.transparent = false;\n\n    }\n\n    if (material.normalTexture !== undefined) {\n\n      pending.push(parser.assignTexture(materialParams, 'normalMap', material.normalTexture.index));\n\n    }\n\n    if (material.occlusionTexture !== undefined) {\n\n      pending.push(parser.assignTexture(materialParams, 'aoMap', material.occlusionTexture.index));\n\n    }\n\n    if (material.emissiveFactor !== undefined) {\n\n      if (materialType === MeshBasicMaterial) {\n\n        materialParams.color = new Color().fromArray(material.emissiveFactor);\n\n      } else {\n\n        materialParams.emissive = new Color().fromArray(material.emissiveFactor);\n\n      }\n\n    }\n\n    if (material.emissiveTexture !== undefined) {\n\n      if (materialType === MeshBasicMaterial) {\n\n        pending.push(parser.assignTexture(materialParams, 'map', material.emissiveTexture.index));\n\n      } else {\n\n        pending.push(parser.assignTexture(materialParams, 'emissiveMap', material.emissiveTexture.index));\n\n      }\n\n    }\n\n    return Promise.all(pending).then(function() {\n\n      let _material;\n\n      if (materialType === ShaderMaterial) {\n\n        _material = extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(materialParams);\n\n      } else {\n\n        _material = new materialType(materialParams);\n\n      }\n\n      if (material.name !== undefined) _material.name = material.name;\n\n      // Normal map textures use OpenGL conventions:\n      // https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#materialnormaltexture\n      _material.normalScale.x = -1;\n\n      _material.userData = material.extras;\n\n      return _material;\n\n    });\n\n  });\n\n};\n\nGLTFParser.prototype.loadGeometries = function(primitives) {\n\n  return this._withDependencies([\n\n    'accessors',\n\n  ]).then(function(dependencies) {\n\n    return _each(primitives, function(primitive) {\n\n      const geometry = new BufferGeometry();\n\n      const attributes = primitive.attributes;\n\n      for (const attributeId in attributes) {\n\n        const attributeEntry = attributes[attributeId];\n\n        if (attributeEntry === undefined) return;\n\n        const bufferAttribute = dependencies.accessors[attributeEntry];\n\n        switch (attributeId) {\n\n          case 'POSITION':\n\n            geometry.addAttribute('position', bufferAttribute);\n            break;\n\n          case 'NORMAL':\n\n            geometry.addAttribute('normal', bufferAttribute);\n            break;\n\n          case 'TEXCOORD_0':\n          case 'TEXCOORD0':\n          case 'TEXCOORD':\n\n            geometry.addAttribute('uv', bufferAttribute);\n            break;\n\n          case 'TEXCOORD_1':\n\n            geometry.addAttribute('uv2', bufferAttribute);\n            break;\n\n          case 'COLOR_0':\n          case 'COLOR0':\n          case 'COLOR':\n\n            geometry.addAttribute('color', bufferAttribute);\n            break;\n\n          case 'WEIGHTS_0':\n          case 'WEIGHT': // WEIGHT semantic deprecated.\n\n            geometry.addAttribute('skinWeight', bufferAttribute);\n            break;\n\n          case 'JOINTS_0':\n          case 'JOINT': // JOINT semantic deprecated.\n\n            geometry.addAttribute('skinIndex', bufferAttribute);\n            break;\n\n          default:\n            break;\n\n        }\n\n      }\n\n      if (primitive.indices !== undefined) {\n\n        geometry.setIndex(dependencies.accessors[primitive.indices]);\n\n      }\n\n      return geometry;\n\n    });\n\n  });\n\n};\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\n * @return {Promise} promise\n */\nGLTFParser.prototype.loadMeshes = function() {\n\n  const scope = this;\n  const json = this.json;\n\n  return this._withDependencies([\n\n    'accessors',\n    'materials',\n\n  ]).then(function(dependencies) {\n\n    return _each(json.meshes, function(meshDef) {\n\n      const group = new Group();\n\n      if (meshDef.name !== undefined) group.name = meshDef.name;\n      if (meshDef.extras) group.userData = meshDef.extras;\n\n      const primitives = meshDef.primitives || [];\n\n      return scope.loadGeometries(primitives).then(function(geometries) {\n\n        for (const name in primitives) {\n\n          const primitive = primitives[name];\n          const geometry = geometries[name];\n\n          const material = primitive.material === undefined ?\n            createDefaultMaterial() :\n            dependencies.materials[primitive.material];\n\n          if (material.aoMap &&\n            geometry.attributes.uv2 === undefined &&\n            geometry.attributes.uv !== undefined) {\n\n            console.log('GLTFLoader: Duplicating UVs to support aoMap.');\n            geometry.addAttribute('uv2', new BufferAttribute(geometry.attributes.uv.array, 2));\n\n          }\n\n          if (geometry.attributes.color !== undefined) {\n\n            material.vertexColors = VertexColors;\n            material.needsUpdate = true;\n\n          }\n\n          if (geometry.attributes.normal === undefined) {\n\n            if (material.flatShading !== undefined) {\n\n              material.flatShading = true;\n\n            } else {\n\n              // TODO: Remove this backwards-compatibility fix after r87 release.\n              material.shading = FlatShading;\n\n            }\n\n          }\n\n          let mesh;\n\n          if (primitive.mode === WEBGL_CONSTANTS.TRIANGLES || primitive.mode === undefined) {\n\n            mesh = new Mesh(geometry, material);\n\n          } else if (primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP) {\n\n            mesh = new Mesh(geometry, material);\n            mesh.drawMode = TriangleStripDrawMode;\n          } else if (primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN) {\n\n            mesh = new Mesh(geometry, material);\n            mesh.drawMode = TriangleFanDrawMode;\n\n          } else if (primitive.mode === WEBGL_CONSTANTS.LINES) {\n\n            mesh = new LineSegments(geometry, material);\n\n          } else if (primitive.mode === WEBGL_CONSTANTS.LINE_STRIP) {\n\n            mesh = new Line(geometry, material);\n\n          } else if (primitive.mode === WEBGL_CONSTANTS.LINE_LOOP) {\n\n            mesh = new LineLoop(geometry, material);\n\n          } else if (primitive.mode === WEBGL_CONSTANTS.POINTS) {\n\n            mesh = new Points(geometry, material);\n\n          } else {\n\n            throw new Error('GLTFLoader: Primitive mode unsupported: ', primitive.mode);\n\n          }\n\n          mesh.name = group.name + '_' + name;\n\n          if (primitive.targets !== undefined) {\n\n            addMorphTargets(mesh, meshDef, primitive, dependencies);\n\n          }\n\n          if (primitive.extras) mesh.userData = primitive.extras;\n\n          group.add(mesh);\n\n        }\n\n        return group;\n\n      });\n\n    });\n\n  });\n\n};\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\n * @return {Array} array\n */\nGLTFParser.prototype.loadCameras = function() {\n\n  const json = this.json;\n\n  return _each(json.cameras, function(camera) {\n\n    let _camera;\n\n    const params = camera[camera.type];\n\n    if (!params) {\n\n      console.warn('GLTFLoader: Missing camera parameters.');\n      return;\n\n    }\n\n    if (camera.type === 'perspective') {\n\n      const aspectRatio = params.aspectRatio || 1;\n      const xfov = params.yfov * aspectRatio;\n\n      _camera = new PerspectiveCamera(Math.radToDeg(xfov), aspectRatio, params.znear || 1, params.zfar || 2e6);\n\n    } else if (camera.type === 'orthographic') {\n\n      _camera = new OrthographicCamera(params.xmag / -2, params.xmag / 2, params.ymag / 2, params.ymag / -2, params.znear, params.zfar);\n\n    }\n\n    if (camera.name !== undefined) _camera.name = camera.name;\n    if (camera.extras) _camera.userData = camera.extras;\n\n    return _camera;\n\n  });\n\n};\n\nGLTFParser.prototype.loadSkins = function() {\n\n  const json = this.json;\n\n  return this._withDependencies([\n\n    'accessors',\n\n  ]).then(function(dependencies) {\n\n    return _each(json.skins, function(skin) {\n\n      const _skin = {\n        joints: skin.joints,\n        inverseBindMatrices: dependencies.accessors[skin.inverseBindMatrices],\n      };\n\n      return _skin;\n\n    });\n\n  });\n\n};\n\nGLTFParser.prototype.loadAnimations = function() {\n\n  const json = this.json;\n\n  return this._withDependencies([\n\n    'accessors',\n    'nodes',\n\n  ]).then(function(dependencies) {\n\n    return _each(json.animations, function(animation, animationId) {\n\n      const tracks = [];\n\n      for (const channelId in animation.channels) {\n\n        const channel = animation.channels[channelId];\n        const sampler = animation.samplers[channel.sampler];\n\n        if (sampler) {\n\n          const target = channel.target;\n          const name = target.node !== undefined ? target.node : target.id; // NOTE: target.id is deprecated.\n          const input = animation.parameters !== undefined ? animation.parameters[sampler.input] : sampler.input;\n          const output = animation.parameters !== undefined ? animation.parameters[sampler.output] : sampler.output;\n\n          const inputAccessor = dependencies.accessors[input];\n          const outputAccessor = dependencies.accessors[output];\n\n          const node = dependencies.nodes[name];\n\n          if (node) {\n\n            node.updateMatrix();\n            node.matrixAutoUpdate = true;\n\n            let TypedKeyframeTrack;\n\n            switch (PATH_PROPERTIES[target.path]) {\n\n              case PATH_PROPERTIES.weights:\n\n                TypedKeyframeTrack = NumberKeyframeTrack;\n                break;\n\n              case PATH_PROPERTIES.rotation:\n\n                TypedKeyframeTrack = QuaternionKeyframeTrack;\n                break;\n\n              case PATH_PROPERTIES.position:\n              case PATH_PROPERTIES.scale:\n              default:\n\n                TypedKeyframeTrack = VectorKeyframeTrack;\n                break;\n\n            }\n\n            const targetName = node.name ? node.name : node.uuid;\n\n            if (sampler.interpolation === 'CATMULLROMSPLINE') {\n\n              console.warn('GLTFLoader: CATMULLROMSPLINE interpolation is not supported. Using CUBICSPLINE instead.');\n\n            }\n\n            const interpolation = sampler.interpolation !== undefined ? INTERPOLATION[sampler.interpolation] : InterpolateLinear;\n\n            const targetNames = [];\n\n            if (PATH_PROPERTIES[target.path] === PATH_PROPERTIES.weights) {\n\n              // node should be Group here but\n              // PATH_PROPERTIES.weights(morphTargetInfluences) should be\n              // the property of a mesh object under node.\n              // So finding targets here.\n\n              node.traverse(function(object) {\n\n                if (object.isMesh === true && object.material.morphTargets === true) {\n\n                  targetNames.push(object.name ? object.name : object.uuid);\n\n                }\n\n              });\n\n            } else {\n\n              targetNames.push(targetName);\n\n            }\n\n            // KeyframeTrack.optimize() will modify given 'times' and 'values'\n            // buffers before creating a truncated copy to keep. Because buffers may\n            // be reused by other tracks, make copies here.\n            for (let i = 0, il = targetNames.length; i < il; i++) {\n\n              tracks.push(new TypedKeyframeTrack(\n                targetNames[i] + '.' + PATH_PROPERTIES[target.path],\n                AnimationUtils.arraySlice(inputAccessor.array, 0),\n                AnimationUtils.arraySlice(outputAccessor.array, 0),\n                interpolation\n              ));\n\n            }\n\n          }\n\n        }\n\n      }\n\n      const name = animation.name !== undefined ? animation.name : 'animation_' + animationId;\n\n      return new AnimationClip(name, undefined, tracks);\n\n    });\n\n  });\n\n};\n\nGLTFParser.prototype.loadNodes = function() {\n\n  const json = this.json;\n  const extensions = this.extensions;\n  const scope = this;\n\n  const nodes = json.nodes || [];\n  const skins = json.skins || [];\n\n  // Nothing in the node definition indicates whether it is a Bone or an\n  // Object3D. Use the skins' joint references to mark bones.\n  skins.forEach(function(skin) {\n\n    skin.joints.forEach(function(id) {\n\n      nodes[id].isBone = true;\n\n    });\n\n  });\n\n  return _each(json.nodes, function(node) {\n\n    const matrix = new Matrix4();\n\n    const _node = node.isBone === true ? new Bone() : new Object3D();\n\n    if (node.name !== undefined) {\n\n      _node.name = PropertyBinding.sanitizeNodeName(node.name);\n\n    }\n\n    if (node.extras) _node.userData = node.extras;\n\n    if (node.matrix !== undefined) {\n\n      matrix.fromArray(node.matrix);\n      _node.applyMatrix(matrix);\n\n    } else {\n\n      if (node.translation !== undefined) {\n\n        _node.position.fromArray(node.translation);\n\n      }\n\n      if (node.rotation !== undefined) {\n\n        _node.quaternion.fromArray(node.rotation);\n\n      }\n\n      if (node.scale !== undefined) {\n\n        _node.scale.fromArray(node.scale);\n\n      }\n\n    }\n\n    return _node;\n\n  }).then(function(__nodes) {\n\n    return scope._withDependencies([\n\n      'meshes',\n      'skins',\n      'cameras',\n\n    ]).then(function(dependencies) {\n\n      return _each(__nodes, function(_node, nodeId) {\n\n        const node = json.nodes[nodeId];\n\n        let meshes;\n\n        if (node.mesh !== undefined) {\n\n          meshes = [ node.mesh ];\n\n        } else if (node.meshes !== undefined) {\n\n          console.warn('GLTFLoader: Legacy glTF file detected. Nodes may have no more than one mesh.');\n\n          meshes = node.meshes;\n\n        }\n\n        if (meshes !== undefined) {\n\n          for (const meshId in meshes) {\n\n            const mesh = meshes[meshId];\n            const group = dependencies.meshes[mesh];\n\n            if (group === undefined) {\n\n              console.warn('GLTFLoader: Could not find node \"' + mesh + '\".');\n              continue;\n\n            }\n\n            // do not clone children as they will be replaced anyway\n            const clonedgroup = group.clone(false);\n\n            for (const childrenId in group.children) {\n\n              let child = group.children[childrenId];\n              const originalChild = child;\n\n              // clone Mesh to add to _node\n\n              const originalMaterial = child.material;\n              const originalGeometry = child.geometry;\n              const originalInfluences = child.morphTargetInfluences;\n              const originalUserData = child.userData;\n              const originalName = child.name;\n\n              let material = originalMaterial;\n\n              switch (child.type) {\n\n                case 'LineSegments':\n                  child = new LineSegments(originalGeometry, material);\n                  break;\n\n                case 'LineLoop':\n                  child = new LineLoop(originalGeometry, material);\n                  break;\n\n                case 'Line':\n                  child = new Line(originalGeometry, material);\n                  break;\n\n                case 'Points':\n                  child = new Points(originalGeometry, material);\n                  break;\n\n                default:\n                  child = new Mesh(originalGeometry, material);\n                  child.drawMode = originalChild.drawMode;\n\n              }\n\n              child.castShadow = true;\n              child.morphTargetInfluences = originalInfluences;\n              child.userData = originalUserData;\n              child.name = originalName;\n\n              let skinEntry;\n\n              if (node.skin !== undefined) {\n\n                skinEntry = dependencies.skins[node.skin];\n\n              }\n\n              // Replace Mesh with SkinnedMesh in library\n              if (skinEntry) {\n\n                const geometry = originalGeometry;\n                material = originalMaterial;\n                material.skinning = true;\n\n                child = new SkinnedMesh(geometry, material);\n                child.castShadow = true;\n                child.userData = originalUserData;\n                child.name = originalName;\n\n                const bones = [];\n                const boneInverses = [];\n\n                for (let i = 0, l = skinEntry.joints.length; i < l; i++) {\n\n                  const jointId = skinEntry.joints[i];\n                  const jointNode = __nodes[jointId];\n\n                  if (jointNode) {\n\n                    bones.push(jointNode);\n\n                    const m = skinEntry.inverseBindMatrices.array;\n                    const mat = new Matrix4().fromArray(m, i * 16);\n                    boneInverses.push(mat);\n\n                  } else {\n\n                    console.warn('GLTFLoader: Joint \"%s\" could not be found.', jointId);\n\n                  }\n\n                }\n\n                child.bind(new Skeleton(bones, boneInverses), child.matrixWorld);\n\n              }\n\n              clonedgroup.add(child);\n\n            }\n\n            _node.add(clonedgroup);\n\n          }\n\n        }\n\n        if (node.camera !== undefined) {\n\n          const camera = dependencies.cameras[node.camera];\n\n          _node.add(camera);\n\n        }\n\n        if (node.extensions &&\n          node.extensions[EXTENSIONS.KHR_LIGHTS] &&\n          node.extensions[EXTENSIONS.KHR_LIGHTS].light !== undefined) {\n\n          const lights = extensions[EXTENSIONS.KHR_LIGHTS].lights;\n          _node.add(lights[node.extensions[EXTENSIONS.KHR_LIGHTS].light]);\n\n        }\n\n        return _node;\n\n      });\n\n    });\n\n  });\n\n};\n\nGLTFParser.prototype.loadScenes = function() {\n\n  const json = this.json;\n  const extensions = this.extensions;\n\n  // scene node hierachy builder\n\n  function buildNodeHierachy(nodeId, parentObject, allNodes) {\n\n    const _node = allNodes[nodeId];\n    parentObject.add(_node);\n\n    const node = json.nodes[nodeId];\n\n    if (node.children) {\n\n      const children = node.children;\n\n      for (let i = 0, l = children.length; i < l; i++) {\n\n        const child = children[i];\n        buildNodeHierachy(child, _node, allNodes);\n\n      }\n\n    }\n\n  }\n\n  return this._withDependencies([\n\n    'nodes',\n\n  ]).then(function(dependencies) {\n\n    return _each(json.scenes, function(scene) {\n\n      const _scene = new Scene();\n      if (scene.name !== undefined) _scene.name = scene.name;\n\n      if (scene.extras) _scene.userData = scene.extras;\n\n      const nodes = scene.nodes || [];\n\n      for (let i = 0, l = nodes.length; i < l; i++) {\n\n        const nodeId = nodes[i];\n        buildNodeHierachy(nodeId, _scene, dependencies.nodes);\n\n      }\n\n      _scene.traverse(function(child) {\n\n        // for Specular-Glossiness.\n        if (child.material && child.material.isGLTFSpecularGlossinessMaterial) {\n\n          child.onBeforeRender = extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms;\n\n        }\n\n      });\n\n      // Ambient lighting, if present, is always attached to the scene root.\n      if (scene.extensions &&\n        scene.extensions[EXTENSIONS.KHR_LIGHTS] &&\n        scene.extensions[EXTENSIONS.KHR_LIGHTS].light !== undefined) {\n\n        const lights = extensions[EXTENSIONS.KHR_LIGHTS].lights;\n        _scene.add(lights[scene.extensions[EXTENSIONS.KHR_LIGHTS].light]);\n\n      }\n\n      return _scene;\n\n    });\n\n  });\n};\n\nexport { GLTFLoader };\n","import { AnimationMixer, EventDispatcher } from 'three';\nimport { GLTFLoader } from '../utils/GLTFLoader';\nimport Utils from '../utils/Utils';\n\n/**\n * refactor from THREE.DeviceOrientationControls\n */\nclass GltfMagic extends EventDispatcher {\n  constructor({ url, index }) {\n    super();\n    this.url = url;\n    this.index = index || 0;\n    this.scene = null;\n    this.glft = null;\n    this.mixer = null;\n    this.animations = [];\n    this.loader = new GLTFLoader();\n    this.loader.load(this.url, gltf => {\n      this.setup(gltf);\n      this.emit('loaded', {});\n    });\n  }\n\n  switchScene(index) {\n    this.index = Utils.isNumber(index) ? index : this.index;\n    this.scene = this.glft.scenes[this.index] || this.scene;\n    this.setupMixer();\n  }\n\n  setup(gltf) {\n    this.glft = gltf;\n    this.animations = gltf.animations;\n    this.switchScene();\n    this.setupMixer();\n  }\n\n  setupMixer() {\n    this.mixer = new AnimationMixer(this.scene);\n    for (let i = 0; i < this.animations.length; i++) {\n      const clip = this.animations[i];\n      this.mixer.clipAction(clip).play();\n    }\n  }\n\n  update(snippet) {\n    this.mixer && this.mixer.update(snippet / 1000);\n  }\n}\n\nexport { GltfMagic };\n"],"names":["lastTime","vendors","x","length","window","requestAnimationFrame","cancelAnimationFrame","callback","currTime","Date","getTime","timeToCall","Math","max","id","setTimeout","RAF","CAF","_rt","val","Object","prototype","toString","call","Utils","json","JSON","parse","stringify","degree","PI","radius","ks","variable","min","isArray","random","isNumber","n","m","a","b","Animate","options","object","duration","living","resident","infinite","alternate","repeats","delay","wait","timeScale","onComplete","on","bind","onUpdate","init","paused","direction","progress","repeatsCut","delayCut","waitCut","snippet","snippetCache","abs","isEnd","progressCache","spill","codomainBounce","euclideanModulo","pose","nextPose","emit","clamp","bSpill","tSpill","warn","p0","p1","t","speed","EventDispatcher","NEWTON_ITERATIONS","NEWTON_MIN_SLOPE","SUBDIVISION_PRECISION","SUBDIVISION_MAX_ITERATIONS","kSplineTableSize","kSampleStepSize","float32ArraySupported","Float32Array","A","aA1","aA2","B","C","calcBezier","aT","getSlope","binarySubdivide","aX","aA","aB","mX1","mX2","currentX","currentT","i","newtonRaphsonIterate","aGuessT","currentSlope","BezierEasing","mY1","mY2","Error","sampleValues","Array","_preCompute","_getTForX","intervalStart","currentSample","lastSample","dist","guessForT","initialSlope","get","Tween","k","bezier","x1","y1","x2","y2","pow","sin","s","Bounce","Out","In","Transition","from","to","isUndefined","props","ease","Ease","InOut","linear","PathMotion","path","Curve","lengthMode","isBoolean","needClamp","attachTangent","position","getPointAt","getPoint","copy","getTangentAt","getTangent","lookAt","add","AnimateRunner","runners","cursor","queues","runner","animate","nextRunner","push","_","time","timeSnippet","initRunner","update","cc","topSpill","TimelineAnimations","animates","cache","slice","splice","clear","_addMove","Object3D","defineProperty","scale","y","z","timelineAnimations","initTimeline","motion","updateAnimations","updateTimeline","children","key","value","rawKeys","split","prop","pop","head","join","keysMaps","linkProp","Smooth","Vector3","now","clone","noise","set","space","sub","multiplyScalar","zee","euler","Euler","q0","Quaternion","q1","sqrt","ROTATE_ORDER","Orienter","_orient","_change","needFix","fix","timing","alpha","beta","gamma","lon","lat","quaternion","eared","nodce","connect","addEventListener","removeEventListener","event","DTR","setFromEuler","multiply","setFromAxisAngle","calculation","face","applyQuaternion","xzFace","cos","dot","nor","RTD","acos","orientation","ARGlue","name","autoHide","matrixAutoUpdate","type","error","matrix","isDetected","visible","fromArray","setDefault","check","spare","ViewPort","canvas","isString","document","getElementById","querySelector","precision","antialias","premultipliedAlpha","stencil","preserveDrawingBuffer","depth","logarithmicDepthBuffer","Pass","enabled","needsSwap","renderToScreen","width","height","renderer","writeBuffer","readBuffer","delta","maskActive","CopyShader","ConvolutionShader","Vector2","sigma","gauss","exp","sum","kMaxKernelSize","kernelSize","ceil","halfWidth","values","BloomPass","strength","resolution","undefined","pars","minFilter","LinearFilter","magFilter","format","RGBAFormat","renderTargetX","WebGLRenderTarget","texture","renderTargetY","console","copyShader","copyUniforms","UniformsUtils","uniforms","opacity","materialCopy","ShaderMaterial","vertexShader","fragmentShader","AdditiveBlending","convolutionShader","convolutionUniforms","uImageIncrement","blurX","cKernel","buildKernel","materialConvolution","toFixed","camera","OrthographicCamera","scene","Scene","quad","Mesh","PlaneBufferGeometry","frustumCulled","context","disable","STENCIL_TEST","material","tDiffuse","render","blurY","enable","ClearMaskPass","state","buffers","setTest","FilmShader","FilmPass","noiseIntensity","scanlinesIntensity","scanlinesCount","grayscale","shader","nIntensity","sIntensity","sCount","DigitalGlitch","GlitchPass","dt_size","tDisp","generateHeightmap","goWild","curF","generateTrigger","seed","byp","randX","amount","angle","seed_x","seed_y","distortion_x","distortion_y","data_arr","DataTexture","RGBFormat","FloatType","needsUpdate","MaskPass","inverse","color","setMask","setLocked","writeValue","clearValue","setOp","REPLACE","setFunc","ALWAYS","setClear","EQUAL","KEEP","MattingShader","EdgeBlurShader","MattingPass","primer","hueStart","hueEnd","lightnessStart","lightnessEnd","mattingUniforms","materialMatting","edgeBlurUniforms","EdgeBlur","frameSize","materialEdgeBlur","RenderPass","overrideMaterial","clearColor","clearAlpha","clearDepth","oldAutoClear","autoClear","oldClearColor","oldClearAlpha","getClearColor","getHex","getClearAlpha","setClearColor","ShaderPass","textureID","defines","FocusShader","parameters","EffectComposer","autoToScreen","cw","ch","size","getDrawingBufferSize","renderTarget1","renderTarget2","passes","copyPass","tmp","pass","setSize","index","il","setRTS","stencilFunc","NOTEQUAL","swapBuffers","l","first","renderTarget","dispose","hasPass","invalid","Layer","parent","_zIndex","isLayer","afterEffects","aeDelta","MeshBasicMaterial","setRenderTarget","autoClearColor","autoClearDepth","autoClearStencil","addPass","insertPass","needSort","isActive","GraphicsLayer","graphics","isAeOpen","apply","arguments","remove","PrimerLayer","primers","forEach","isPrimer","indexOf","none","Compositor","layers","_sortList","renderLayers","composition","layer","draw","j","temp","zIndex","Viewer","updateStyle","WebGLRenderer","ticking","pt","fps","primerLayer","graphicsLayer","compositor","timeline","This","loop","setInterval","tick","tickFixedFPS","ARViewer","frameWidth","frameHeight","updateViewport","PerspectiveCamera","ar_map","renderLayer","poses","glue","updatePose","projectionMatrix","getSize","rw","rh","ratio","rtw","rth","setViewport","fn","isFunction","interactive","off","once","cb","ev","_listeners","cbs","argument","interactiveChildren","started","_trackedPointers","raycastTest","raycaster","result","raycast","InteractionData","global","target","originalEvent","identifier","isPrimary","button","buttons","tiltX","tiltY","pointerType","pressure","rotationAngle","twist","tangentialPressure","InteractionEvent","stopped","currentTarget","data","intersect","InteractionTrackingData","pointerId","_pointerId","_flags","FLAGS","NONE","flag","yn","flags","constructor","OVER","_doSet","RIGHT_DOWN","LEFT_DOWN","freeze","MOUSE_POINTER_ID","hitTestEvent","InteractionManager","autoPreventDefault","interactionFrequency","mouse","activeInteractionData","interactionDataPool","eventData","interactionDOMElement","moveWhenInside","eventsAdded","mouseOverRenderer","supportsTouchEvents","supportsPointerEvents","PointerEvent","onClick","processClick","onPointerUp","processPointerUp","onPointerCancel","processPointerCancel","onPointerDown","processPointerDown","onPointerMove","processPointerMove","onPointerOut","processPointerOverOut","onPointerOver","cursorStyles","currentCursorMode","Raycaster","_deltaTime","setTargetElement","domElement","globalPoint","root","processInteractive","element","removeEvents","addEvents","navigator","msPointerEnabled","style","didMove","hasOwnProperty","interactionData","interactionEvent","configureInteractionEventForDOMEvent","setCursorMode","mode","assign","displayObject","eventString","point","rect","parentElement","getBoundingClientRect","left","top","func","hitTest","hit","interactiveParent","child","childHit","events","normalizeToPointerData","isNormalized","preventDefault","getInteractionDataForPointerId","triggerEvent","eventLen","isRightButton","trackedPointers","rightDown","leftDown","cancelled","eventAppend","releaseInteractionDataForPointerId","onPointerComplete","trackingData","isTouch","isMouse","test","isDown","over","_copyEvent","_reset","pointerEvent","mapPositionToPoint","clientX","clientY","setFromCamera","globalX","globalY","normalizedEvents","TouchEvent","li","changedTouches","touch","touches","radiusX","radiusY","force","layerX","offsetX","layerY","offsetY","MouseEvent","removeAllListeners","_tempPoint","RATIO","RANGE","PI2","START","END","UP","SphereWorld","url","segmentationX","segmentationY","flipX","flipY","draggable","rotateSpeed","rangeMin","rangeMax","driftX","driftY","needCamera","needMount","inner","Group","background","SphereBufferGeometry","map","TextureLoader","load","side","DoubleSide","_onStart","_onMove","_onEnd","_draggable","_dragX","updateTracking","cx","cy","updateDrag","Camera","hadStart","pageX","pageY","dragX","rotation","dragY","vector","crossVectors","onDragChange","radian","CylinderWorld","radiusSegments","heightSegments","openEnded","zoomIn","viscosity","CylinderBufferGeometry","gyro","drag","DIFF","breaking","compensate","XRViewer","vrmode","vrsensor","fov","aspect","near","far","stereo","StereoCamera","stereoAspect","sensorCTL","interactionManager","interactionUpdate","_interactive","interactiveOnChange","xrrender","hw","updateStereo","setScissorTest","setSV","cameraL","cameraR","updateMatrixWorld","setScissor","_background","bg","setCamera","log","LANDSCAPE_MAP","Primer","landscape","CW","flip","uvMatrix","Matrix3","pigmentGeo","autoCover","targetAspect","setTargetAspect","needsUpdateAttributes","_cs","_setPositions","attributes","positions","coefficient","count","item","itemSize","array","uv","v1","identity","translate","rotate","getX","getY","applyMatrix3","setXY","_autoCover","YUVShader","ss","LuminanceFormat","Color","YCbCrShader","LuminanceAlphaFormat","FORMAT_MAP","CameraPrimer","displayTarget","depthTest","depthWrite","_depthTest","_depthWrite","getFrames","dataArray","texOrder","tex","idx","diffuse","pigmentMat","pigment","_correctUv","_setAspect","image","_updateAttributes","isDirty","updateFrame","rednerTarget","TexturePrimer","frame","tagName","VideoTexture","CanvasTexture","Texture","_gainFrameSize","AnchorBase","applyMatrix4","Matrix4","getInverse","matrixWorld","AnchorRippling","segmentation","rippling","segmentationRip","waves","uiFace","transparent","initRippling","waitTime","last","circle","CircleBufferGeometry","scaleXYZ","Linear","None","BINARY_EXTENSION_HEADER_MAGIC","BINARY_EXTENSION_HEADER_LENGTH","BINARY_EXTENSION_CHUNK_TYPES","EXTENSIONS","GLTFLoader","manager","DefaultLoadingManager","onLoad","onProgress","onError","scope","Loader","extractUrlBase","loader","FileLoader","setResponseType","e","crossOrigin","content","extensions","magic","convertUint8ArrayToString","Uint8Array","KHR_BINARY_GLTF","GLTFBinaryExtension","asset","version","extensionsUsed","KHR_LIGHTS","GLTFLightsExtension","KHR_MATERIALS_COMMON","GLTFMaterialsCommonExtension","KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS","GLTFMaterialsPbrSpecularGlossinessExtension","parser","GLTFParser","scenes","cameras","animations","timeEnd","glTF","GLTFRegistry","objects","lights","extension","lightId","light","lightNode","DirectionalLight","PointLight","SpotLight","AmbientLight","constantAttenuation","intensity","linearAttenuation","distance","quadraticAttenuation","decay","fallOffAngle","fallOffExponent","getMaterialType","khrMaterial","MeshPhongMaterial","MeshLambertMaterial","extendParams","materialParams","pending","keys","materialValues","v","diffuseFactor","diffuseTexture","assignTexture","specularFactor","specular","specularTexture","shininessFactor","shininess","Promise","all","body","headerView","DataView","header","getUint32","chunkView","chunkIndex","byteLength","chunkLength","chunkType","contentArray","BIN","byteOffset","params","pbrSpecularGlossiness","ShaderLib","standard","specularMapParsFragmentChunk","glossinessMapParsFragmentChunk","specularMapFragmentChunk","glossinessMapFragmentChunk","lightPhysicalFragmentChunk","replace","roughness","metalness","roughnessMap","metalnessMap","setHex","glossiness","specularMap","glossinessMap","emissive","glossinessFactor","specularGlossinessTexture","specGlossIndex","isGLTFSpecularGlossinessMaterial","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalScale","displacementMap","displacementScale","displacementBias","alphaMap","envMap","envMapIntensity","refractionRatio","derivatives","geometry","uvScaleMap","isWebGLRenderTarget","offset","repeat","offsetRepeat","flipEnvMap","isCubeTexture","USE_GLOSSINESSMAP","USE_ROUGHNESSMAP","WEBGL_CONSTANTS","WEBGL_COMPONENT_TYPES","Int8Array","Int16Array","Uint16Array","Uint32Array","WEBGL_FILTERS","NearestFilter","NearestMipMapNearestFilter","LinearMipMapNearestFilter","NearestMipMapLinearFilter","LinearMipMapLinearFilter","WEBGL_WRAPPINGS","ClampToEdgeWrapping","MirroredRepeatWrapping","RepeatWrapping","WEBGL_TEXTURE_FORMATS","AlphaFormat","WEBGL_TEXTURE_DATATYPES","UnsignedByteType","UnsignedShort4444Type","UnsignedShort5551Type","UnsignedShort565Type","WEBGL_TYPE_SIZES","PATH_PROPERTIES","INTERPOLATION","InterpolateSmooth","InterpolateLinear","InterpolateDiscrete","ALPHA_MODES","_each","thisObj","resolve","results","fns","then","resolveURL","TextDecoder","decode","String","fromCharCode","createDefaultMaterial","MeshStandardMaterial","FrontSide","addMorphTargets","mesh","meshDef","primitiveDef","dependencies","targets","morphAttributes","normal","morphTargets","attributeName","positionAttribute","normalAttribute","POSITION","accessors","jl","setXYZ","getZ","NORMAL","morphNormals","TANGENT","updateMorphTargets","weights","morphTargetInfluences","_withDependencies","_dependencies","dependency","fnName","charAt","toUpperCase","cached","removeAll","catch","getDependency","cacheKey","loadBuffer","bufferIndex","bufferDef","uri","loadBufferView","bufferViewIndex","bufferViewDef","bufferViews","buffer","loadAccessors","accessor","bufferView","TypedArray","componentType","elementBytes","BYTES_PER_ELEMENT","itemBytes","byteStride","ib","InterleavedBuffer","InterleavedBufferAttribute","BufferAttribute","loadTexture","textureIndex","URL","webkitURL","textureDef","textures","source","images","sourceURI","isObjectURL","blob","Blob","mimeType","createObjectURL","textureLoader","Handlers","setCrossOrigin","reject","revokeObjectURL","internalFormat","samplers","sampler","wrapS","wrapT","textureName","loadMaterials","materials","materialType","materialExtensions","khcExtension","sgExtension","pbrMetallicRoughness","metallicRoughness","baseColorFactor","baseColorTexture","metallicFactor","roughnessFactor","metallicRoughnessTexture","doubleSided","alphaMode","OPAQUE","normalTexture","occlusionTexture","emissiveFactor","emissiveTexture","_material","createMaterial","userData","extras","loadGeometries","primitives","primitive","BufferGeometry","attributeId","attributeEntry","bufferAttribute","addAttribute","indices","setIndex","loadMeshes","meshes","group","geometries","uv2","vertexColors","VertexColors","flatShading","shading","FlatShading","TRIANGLES","TRIANGLE_STRIP","drawMode","TriangleStripDrawMode","TRIANGLE_FAN","TriangleFanDrawMode","LINES","LineSegments","LINE_STRIP","Line","LINE_LOOP","LineLoop","POINTS","Points","loadCameras","_camera","aspectRatio","xfov","yfov","radToDeg","znear","zfar","xmag","ymag","loadSkins","skins","skin","_skin","joints","inverseBindMatrices","loadAnimations","animation","animationId","tracks","channelId","channels","channel","node","input","output","inputAccessor","outputAccessor","nodes","updateMatrix","TypedKeyframeTrack","NumberKeyframeTrack","QuaternionKeyframeTrack","VectorKeyframeTrack","targetName","uuid","interpolation","targetNames","traverse","isMesh","AnimationUtils","arraySlice","AnimationClip","loadNodes","isBone","_node","Bone","PropertyBinding","sanitizeNodeName","applyMatrix","translation","__nodes","nodeId","meshId","clonedgroup","childrenId","originalChild","originalMaterial","originalGeometry","originalInfluences","originalUserData","originalName","castShadow","skinEntry","skinning","SkinnedMesh","bones","boneInverses","jointId","jointNode","mat","Skeleton","loadScenes","buildNodeHierachy","parentObject","allNodes","_scene","onBeforeRender","refreshUniforms","GltfMagic","glft","mixer","setup","gltf","setupMixer","switchScene","AnimationMixer","clip","clipAction","play"],"mappings":"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"}